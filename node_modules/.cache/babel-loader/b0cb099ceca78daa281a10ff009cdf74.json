{"ast":null,"code":"var _jsxFileName = \"/home/oem/Documents/projects/educap/classebook-front-web/src/app/routes/Administration/routes/SubjectsSettings/SubjectsSettingsList.js\";\nimport React from 'react';\nimport Table from \"@material-ui/core/Table\";\nimport TableBody from \"@material-ui/core/TableBody\";\nimport TableCell from \"@material-ui/core/TableCell\";\nimport TableHead from \"@material-ui/core/TableHead\";\nimport TableRow from \"@material-ui/core/TableRow\";\nimport IntlMessages from \"../../../../../util/IntlMessages\";\nimport SubjectItem from './SubjectItem';\nimport DeleteSubjectSetting from './DeleteSubjectSetting';\nimport { deleteSubjectSetting, editSubjectSetting, assignSubjectSetting } from \"../../../../../actions/subjectAction\";\nimport { connect } from 'react-redux';\nimport EditSubjectSetting from './EditSubjectSetting';\nimport AssignmentSubjectSetting from './AssignmentSubjectSetting';\nimport { element } from 'prop-types';\nimport _ from 'lodash';\n\nclass SubjectsSettingsList extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.addNewAssignment = index => {\n      this.setState(prevState => ({\n        listOfAssignment: [...prevState.listOfAssignment, {\n          id: index,\n          levelId: null,\n          sectionId: null,\n          sectionDisabled: true,\n          isChecked: false,\n          isLevelDisabled: false\n        }]\n      }));\n    };\n\n    this.handleSubmitAssignment = e => {\n      e.preventDefault();\n      let data = [];\n      this.state.listOfAssignment.forEach(element => {\n        data.push({\n          \"fk_id_level_v3\": element.levelId,\n          \"fk_id_section_v3\": element.sectionId,\n          \"fk_id_subject_v3\": this.state.id\n        });\n      });\n      this.props.assignSubjectSetting(data);\n      this.setState({\n        listOfAssignment: [{\n          id: 0,\n          levelId: null,\n          sectionId: null,\n          sectionDisabled: true,\n          isChecked: false,\n          isLevelDisabled: false\n        }],\n        isOpenAssignment: false\n      });\n    };\n\n    this.handleAssignment = (item, event) => {\n      event.preventDefault();\n      this.setState({\n        isOpenAssignment: true,\n        id: item.id\n      });\n    };\n\n    this.handleChange = name => event => {\n      this.setState({\n        [name]: event.target.value\n      });\n    };\n\n    this.handleSubmit = e => {\n      e.preventDefault();\n      const data = {\n        name: this.state.nameSubject,\n        wording: this.state.wording,\n        fk_id_subjects_module: this.state.moduleSubjectId\n      };\n      this.props.editSubjectSetting(data, this.state.id);\n      this.handleCancel();\n    };\n\n    this.handleEdit = (item, event) => {\n      event.preventDefault();\n      this.setState({\n        isOpenEdit: true,\n        item: item,\n        nameSubject: item.name,\n        wording: item.wording,\n        moduleSubjectId: item.fk_id_subjects_module,\n        id: item.id\n      });\n    };\n\n    this.handleDeleteSubject = event => {\n      event.preventDefault();\n      this.props.deleteSubjectSetting(this.state.deleteItem);\n      this.setState({\n        deleteIsopen: false\n      });\n    };\n\n    this.handleDelete = (item, event) => {\n      event.preventDefault();\n      this.setState({\n        deleteIsopen: true,\n        deleteItem: item\n      });\n    };\n\n    this.state = {\n      isOpenEdit: false,\n      deleteIsopen: false,\n      deleteItem: {},\n      item: {},\n      nameSubject: \"\",\n      wording: \"\",\n      moduleSubjectId: null,\n      id: null,\n      isOpenAssignment: false,\n      sections: [],\n      listOfAssignment: [{\n        id: 0,\n        levelId: null,\n        sectionId: null,\n        sectionDisabled: true,\n        isChecked: false,\n        isLevelDisabled: false\n      }]\n    };\n    this.handleDelete = this.handleDelete.bind(this);\n    this.handleCancel = this.handleCancel.bind(this);\n    this.handleDeleteSubject = this.handleDeleteSubject.bind(this);\n    this.handleEdit = this.handleEdit.bind(this);\n    this.handleChange = this.handleChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.handleAssignment = this.handleAssignment.bind(this);\n    this.handleSubmitAssignment = this.handleSubmitAssignment.bind(this);\n    this.handleChangeAssignment = this.handleChangeAssignment.bind(this);\n    this.addNewAssignment = this.addNewAssignment.bind(this);\n    this.handleChangeListSubjects = this.handleChangeListSubjects.bind(this);\n    this.handleChangeListSubjectsSection = this.handleChangeListSubjectsSection.bind(this);\n  }\n\n  handleChangeAssignment(event, name, index) {\n    let levelsIds = _.map(this.props.levels, 'id');\n\n    let newListSubjects = [];\n    levelsIds.forEach(levelId => {\n      let sections = this.props.sections.filter(element => element.fk_id_level_v3 === levelId);\n      this.setState({\n        sections\n      });\n\n      if (!_.isEmpty(sections)) {\n        let sectionsIds = _.map(sections, 'id');\n\n        sectionsIds.forEach(sectionId => {\n          newListSubjects.push({\n            levelId: levelId,\n            sectionId: sectionId,\n            [name]: event.target.checked,\n            sectionDisabled: false,\n            isLevelDisabled: !event.target.checked\n          });\n        });\n      } else {\n        newListSubjects.push({\n          levelId: levelId,\n          sectionId: null,\n          [name]: event.target.checked,\n          sectionDisabled: true,\n          isLevelDisabled: !event.target.checked\n        });\n      }\n    });\n    this.setState({\n      listOfAssignment: newListSubjects\n    });\n  }\n\n  handleChangeListSubjects(event, name, index) {\n    let sections = [];\n\n    if (name === \"levelId\") {\n      sections = this.props.sections.filter(element => element.fk_id_level_v3 === event.target.value);\n      this.setState({\n        sections\n      });\n    }\n\n    let newListSubjects = this.state.listOfAssignment.map(objSubject => name === \"levelId\" && !_.isEmpty(sections) && objSubject.id === index ? { ...objSubject,\n      [name]: event.target.value,\n      sectionDisabled: false,\n      sectionId: null\n    } : objSubject.id === index ? { ...objSubject,\n      [name]: event.target.value,\n      sectionDisabled: true\n    } : objSubject);\n    this.setState({\n      listOfAssignment: newListSubjects\n    });\n  }\n\n  handleChangeListSubjectsSection(event, name, index) {\n    let newListSubjects = this.state.listOfAssignment.map(objSubject => objSubject.id === index ? { ...objSubject,\n      [name]: event.target.value,\n      sectionDisabled: false\n    } : objSubject);\n    this.setState({\n      listOfAssignment: newListSubjects\n    });\n  }\n\n  handleCancel() {\n    this.setState({\n      deleteIsopen: false,\n      isOpenEdit: false,\n      isOpenAssignment: false,\n      listOfAssignment: [{\n        id: 0,\n        levelId: null,\n        sectionId: null,\n        sectionDisabled: true,\n        isChecked: false,\n        isLevelDisabled: false\n      }]\n    });\n  }\n\n  render() {\n    let {\n      subjects,\n      subjectModules\n    } = this.props;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"table-responsive-material\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 236,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 237,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"b\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(IntlMessages, {\n      id: \"list.all.subject\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 15\n      }\n    })))), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 243,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(Table, {\n      className: \"default-table table-unbordered table table-sm table-hover\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 244,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(TableHead, {\n      className: \"th-border-b\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 245,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(TableRow, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 246,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(TableCell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 247,\n        columnNumber: 15\n      }\n    }, \" \", /*#__PURE__*/React.createElement(IntlMessages, {\n      id: \"subjects\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 247,\n        columnNumber: 27\n      }\n    })), /*#__PURE__*/React.createElement(TableCell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 248,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(IntlMessages, {\n      id: \"room.description\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 248,\n        columnNumber: 26\n      }\n    })), /*#__PURE__*/React.createElement(TableCell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 15\n      }\n    }, \" \", /*#__PURE__*/React.createElement(IntlMessages, {\n      id: \"sidebar.components.subjectModule\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 27\n      }\n    })), /*#__PURE__*/React.createElement(TableCell, {\n      align: \"center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(IntlMessages, {\n      id: \"action.type.of.education\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 41\n      }\n    })))), /*#__PURE__*/React.createElement(TableBody, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 254,\n        columnNumber: 11\n      }\n    }, subjects.map((subject, index) => {\n      return /*#__PURE__*/React.createElement(SubjectItem, {\n        key: index,\n        subject: subject,\n        subjectModules: subjectModules,\n        handleDelete: this.handleDelete,\n        handleEdit: this.handleEdit,\n        handleAssignment: this.handleAssignment,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 258,\n          columnNumber: 17\n        }\n      });\n    }))), this.state.isOpenEdit === true ? /*#__PURE__*/React.createElement(EditSubjectSetting, {\n      item: this.state.item,\n      handleCancel: this.handleCancel,\n      subjectModules: subjectModules,\n      values: this.state,\n      handleEdit: this.handleEdit,\n      handleChange: this.handleChange,\n      handleSubmit: this.handleSubmit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 273,\n        columnNumber: 11\n      }\n    }) : \"\", this.state.deleteIsopen === true ? /*#__PURE__*/React.createElement(DeleteSubjectSetting, {\n      handleDeleteSubject: this.handleDeleteSubject,\n      deleteItem: this.state.deleteItem,\n      handleCancel: this.handleCancel,\n      deleteIsopen: this.state.deleteIsopen,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 285,\n        columnNumber: 11\n      }\n    }) : \"\", this.state.isOpenAssignment && /*#__PURE__*/React.createElement(AssignmentSubjectSetting, {\n      values: this.state,\n      handleCancel: this.handleCancel,\n      handleSubmitAssignment: this.handleSubmitAssignment,\n      handleChangeAssignment: this.handleChangeAssignment,\n      addNewAssignment: this.addNewAssignment,\n      levels: this.props.levels,\n      handleChangeListSubjects: this.handleChangeListSubjects,\n      handleChangeListSubjectsSection: this.handleChangeListSubjectsSection,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 293,\n        columnNumber: 41\n      }\n    }));\n  }\n\n}\n\nfunction mapStateToProps(state) {\n  return {};\n}\n\nexport default connect(mapStateToProps, {\n  deleteSubjectSetting,\n  editSubjectSetting,\n  assignSubjectSetting\n})(SubjectsSettingsList);","map":{"version":3,"sources":["/home/oem/Documents/projects/educap/classebook-front-web/src/app/routes/Administration/routes/SubjectsSettings/SubjectsSettingsList.js"],"names":["React","Table","TableBody","TableCell","TableHead","TableRow","IntlMessages","SubjectItem","DeleteSubjectSetting","deleteSubjectSetting","editSubjectSetting","assignSubjectSetting","connect","EditSubjectSetting","AssignmentSubjectSetting","element","_","SubjectsSettingsList","Component","constructor","props","addNewAssignment","index","setState","prevState","listOfAssignment","id","levelId","sectionId","sectionDisabled","isChecked","isLevelDisabled","handleSubmitAssignment","e","preventDefault","data","state","forEach","push","isOpenAssignment","handleAssignment","item","event","handleChange","name","target","value","handleSubmit","nameSubject","wording","fk_id_subjects_module","moduleSubjectId","handleCancel","handleEdit","isOpenEdit","handleDeleteSubject","deleteItem","deleteIsopen","handleDelete","sections","bind","handleChangeAssignment","handleChangeListSubjects","handleChangeListSubjectsSection","levelsIds","map","levels","newListSubjects","filter","fk_id_level_v3","isEmpty","sectionsIds","checked","objSubject","render","subjects","subjectModules","subject","mapStateToProps"],"mappings":"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","sourcesContent":["import React from 'react'\nimport Table from \"@material-ui/core/Table\";\nimport TableBody from \"@material-ui/core/TableBody\";\nimport TableCell from \"@material-ui/core/TableCell\";\nimport TableHead from \"@material-ui/core/TableHead\";\nimport TableRow from \"@material-ui/core/TableRow\";\nimport IntlMessages from \"../../../../../util/IntlMessages\";\nimport SubjectItem from './SubjectItem'\nimport DeleteSubjectSetting from './DeleteSubjectSetting'\nimport { deleteSubjectSetting, editSubjectSetting, assignSubjectSetting } from \"../../../../../actions/subjectAction\"\nimport { connect } from 'react-redux';\nimport EditSubjectSetting from './EditSubjectSetting';\nimport AssignmentSubjectSetting from './AssignmentSubjectSetting'\nimport { element } from 'prop-types';\nimport _ from 'lodash'\n\nclass SubjectsSettingsList extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOpenEdit: false,\n      deleteIsopen: false,\n      deleteItem: {},\n      item: {},\n      nameSubject: \"\",\n      wording: \"\",\n      moduleSubjectId: null,\n      id: null,\n      isOpenAssignment: false,\n      sections: [],\n      listOfAssignment: [\n        {\n          id: 0,\n          levelId: null,\n          sectionId: null,\n          sectionDisabled: true,\n          isChecked: false,\n          isLevelDisabled: false\n\n        },\n      ]\n\n\n    };\n    this.handleDelete = this.handleDelete.bind(this)\n    this.handleCancel = this.handleCancel.bind(this);\n    this.handleDeleteSubject = this.handleDeleteSubject.bind(this)\n    this.handleEdit = this.handleEdit.bind(this);\n    this.handleChange = this.handleChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this)\n    this.handleAssignment = this.handleAssignment.bind(this)\n    this.handleSubmitAssignment = this.handleSubmitAssignment.bind(this)\n    this.handleChangeAssignment = this.handleChangeAssignment.bind(this);\n    this.addNewAssignment = this.addNewAssignment.bind(this);\n    this.handleChangeListSubjects = this.handleChangeListSubjects.bind(this);\n    this.handleChangeListSubjectsSection = this.handleChangeListSubjectsSection.bind(this);\n\n  }\n\n  handleChangeAssignment(event, name, index) {\n    let levelsIds = _.map(this.props.levels, 'id')\n    let newListSubjects = []\n    levelsIds.forEach(levelId => {\n     let sections = this.props.sections.filter(element => element.fk_id_level_v3 === levelId)\n     this.setState({sections})\n     if(!_.isEmpty(sections)){\n       let sectionsIds = _.map(sections,'id')\n       sectionsIds.forEach(sectionId => {\n        newListSubjects.push({\n          levelId: levelId,\n          sectionId: sectionId,\n          [name]: event.target.checked,\n          sectionDisabled: false,\n          isLevelDisabled: !event.target.checked\n        })\n       });\n     }else{\n      newListSubjects.push({\n        levelId: levelId,\n        sectionId: null,\n        [name]: event.target.checked,\n        sectionDisabled: true,\n        isLevelDisabled: !event.target.checked\n      })\n\n     }\n    });\n    this.setState({ listOfAssignment: newListSubjects });\n  }\n\n\n  handleChangeListSubjects(event, name, index) {\n    let sections = []\n    if (name === \"levelId\") {\n      sections = this.props.sections.filter(element => element.fk_id_level_v3 === event.target.value)\n      this.setState({ sections });\n    }\n    let newListSubjects = this.state.listOfAssignment.map((objSubject) =>\n      name === \"levelId\" && !_.isEmpty(sections) && objSubject.id === index\n        ? {\n          ...objSubject,\n          [name]: event.target.value,\n          sectionDisabled: false,\n          sectionId: null,\n        }\n        : objSubject.id === index\n          ? { ...objSubject, [name]: event.target.value, sectionDisabled: true }\n          : objSubject\n    );\n\n    this.setState({ listOfAssignment: newListSubjects });\n  };\n\n  handleChangeListSubjectsSection(event, name, index) {\n    let newListSubjects = this.state.listOfAssignment.map((objSubject) =>\n      objSubject.id === index\n        ? { ...objSubject, [name]: event.target.value, sectionDisabled: false }\n        : objSubject\n    );\n    this.setState({ listOfAssignment: newListSubjects });\n  }\n\n\n  addNewAssignment = (index) => {\n    this.setState((prevState) => ({\n      listOfAssignment: [\n        ...prevState.listOfAssignment,\n        {\n          id: index,\n          levelId: null,\n          sectionId: null,\n          sectionDisabled: true,\n          isChecked: false,\n          isLevelDisabled: false\n        },\n      ],\n    }));\n  };\n\n\n\n  handleSubmitAssignment = (e) => {\n    e.preventDefault();\n    let data = []\n    this.state.listOfAssignment.forEach(element => {\n      data.push({\n        \"fk_id_level_v3\": element.levelId,\n        \"fk_id_section_v3\": element.sectionId,\n        \"fk_id_subject_v3\": this.state.id\n      })\n    });\n    this.props.assignSubjectSetting(data);\n    this.setState({\n      listOfAssignment: [\n        {\n          id: 0,\n          levelId: null,\n          sectionId: null,\n          sectionDisabled: true,\n          isChecked: false,\n          isLevelDisabled: false\n\n        }\n      ], isOpenAssignment: false\n    })\n\n\n  }\n\n  handleAssignment = (item, event) => {\n    event.preventDefault();\n    this.setState({ isOpenAssignment: true, id: item.id })\n  }\n\n  handleChange = (name) => (event) => {\n    this.setState({ [name]: event.target.value });\n  };\n\n  handleSubmit = (e) => {\n    e.preventDefault();\n    const data = {\n      name: this.state.nameSubject,\n      wording: this.state.wording,\n      fk_id_subjects_module: this.state.moduleSubjectId,\n    };\n    this.props.editSubjectSetting(data, this.state.id);\n    this.handleCancel();\n  };\n\n  handleEdit = (item, event) => {\n    event.preventDefault();\n    this.setState({\n      isOpenEdit: true, item: item,\n      nameSubject: item.name,\n      wording: item.wording,\n      moduleSubjectId: item.fk_id_subjects_module,\n      id: item.id\n    });\n  }\n\n  handleDeleteSubject = (event) => {\n    event.preventDefault()\n    this.props.deleteSubjectSetting(this.state.deleteItem);\n    this.setState({\n      deleteIsopen: false\n    })\n  }\n\n  handleDelete = (item, event) => {\n    event.preventDefault();\n    this.setState({ deleteIsopen: true, deleteItem: item });\n  }\n\n  handleCancel() {\n    this.setState({\n      deleteIsopen: false, isOpenEdit: false, isOpenAssignment: false,\n      listOfAssignment: [\n        {\n          id: 0,\n          levelId: null,\n          sectionId: null,\n          sectionDisabled: true,\n          isChecked: false,\n          isLevelDisabled: false\n\n        }\n      ]\n    });\n\n  }\n\n  render() {\n    let { subjects, subjectModules } = this.props\n    return (\n      <div className=\"table-responsive-material\">\n        <div >\n          <h1>\n            <b>\n              <IntlMessages id=\"list.all.subject\" />\n            </b>\n          </h1>\n        </div>\n        <br />\n        <Table className=\"default-table table-unbordered table table-sm table-hover\">\n          <TableHead className=\"th-border-b\">\n            <TableRow>\n              <TableCell> <IntlMessages id=\"subjects\" /></TableCell>\n              <TableCell><IntlMessages id=\"room.description\" /></TableCell>\n              <TableCell> <IntlMessages id=\"sidebar.components.subjectModule\" /></TableCell>\n              <TableCell align=\"center\"><IntlMessages id=\"action.type.of.education\" /></TableCell>\n            </TableRow>\n          </TableHead>\n\n          <TableBody>\n            {subjects.map((subject, index) => {\n\n              return (\n                <SubjectItem\n                  key={index}\n                  subject={subject}\n                  subjectModules={subjectModules}\n                  handleDelete={this.handleDelete}\n                  handleEdit={this.handleEdit}\n                  handleAssignment={this.handleAssignment}\n                />\n              );\n            })}\n\n          </TableBody>\n        </Table>\n\n        {this.state.isOpenEdit === true ?\n          <EditSubjectSetting\n            item={this.state.item}\n            handleCancel={this.handleCancel}\n            subjectModules={subjectModules}\n            values={this.state}\n            handleEdit={this.handleEdit}\n            handleChange={this.handleChange}\n            handleSubmit={this.handleSubmit}\n          /> : \"\"\n        }\n\n        {this.state.deleteIsopen === true ?\n          <DeleteSubjectSetting\n            handleDeleteSubject={this.handleDeleteSubject}\n            deleteItem={this.state.deleteItem}\n            handleCancel={this.handleCancel}\n            deleteIsopen={this.state.deleteIsopen}\n          /> : \"\"\n        }\n\n        {this.state.isOpenAssignment && <AssignmentSubjectSetting\n          values={this.state}\n          handleCancel={this.handleCancel}\n          handleSubmitAssignment={this.handleSubmitAssignment}\n          handleChangeAssignment={this.handleChangeAssignment}\n          addNewAssignment={this.addNewAssignment}\n          levels={this.props.levels}\n          handleChangeListSubjects={this.handleChangeListSubjects}\n          handleChangeListSubjectsSection={this.handleChangeListSubjectsSection}\n\n        />\n\n        }\n\n      </div>\n    )\n  }\n}\n\nfunction mapStateToProps(state) {\n  return {\n\n  };\n}\nexport default connect(\n  mapStateToProps,\n  {\n    deleteSubjectSetting,\n    editSubjectSetting,\n    assignSubjectSetting\n  }\n)(SubjectsSettingsList);"]},"metadata":{},"sourceType":"module"}