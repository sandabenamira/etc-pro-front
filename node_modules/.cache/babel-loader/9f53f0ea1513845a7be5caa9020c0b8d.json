{"ast":null,"code":"import _ from \"lodash\";\nimport { classService } from \"../_services/class.service\";\nimport axios from 'axios';\nimport baseUrl from '../config/config';\nimport { SHOW_ERROR_MESSAGE, HIDE_ERROR_MESSAGE, HIDE_SUCCESS_MESSAGE, SHOW_SUCCESS_MESSAGE } from \"../constants/ActionTypes\";\nexport function getEstablishment() {\n  return dispatch => {\n    let apiEndpoint = `/establishments?access_token=${localStorage.token}`;\n    classService.get(apiEndpoint).then(response => {\n      const ListEstablishments = response.data;\n      const establishmentList = ListEstablishments.filter(element => element.status);\n      dispatch({\n        type: \"GET_ALL_ESTABLISHMENT\",\n        payload: establishmentList\n      });\n      dispatch(addEstablishmentContainers(establishmentList));\n    }).catch(error => {});\n  };\n}\nexport function addEstablishmentContainers(listEstablishment) {\n  return dispatch => {\n    let apiEndpoint = `/containers?access_token=${localStorage.token}`;\n    classService.get(apiEndpoint).then(response => {\n      console.log('test container');\n      listEstablishment.map(establishment => {\n        if (_.some(response.data, [\"name\", establishment.name])) {} else {\n          let container = {\n            name: establishment.name\n          };\n          let formadata = new FormData();\n          formadata.append(\"image\", container);\n          let apiEndpoint2 = `/containers?access_token=${localStorage.token}`;\n          classService.post(apiEndpoint2, container);\n        }\n      });\n    }).catch(error => {});\n  };\n}\nexport function uploadFile2(payload, file) {\n  return dispatch => {\n    let formadata = new FormData();\n    formadata.append(\"image\", file);\n    let apiEndpoint = `/containers/educap.storage/Establishments?access_token=${localStorage.token}`;\n    classService.post(apiEndpoint, formadata).then(response => {\n      console.log(response);\n      dispatch({\n        type: \"ADD_ESTABLISHMENT\",\n        payload: payload\n      });\n      dispatch(EstablishmentModules(payload));\n    }).catch(error => {});\n  };\n}\nexport function saveEstablishment(payload, file) {\n  return dispatch => {\n    let establishmentData = {\n      name: payload.name,\n      ar_name: payload.ar_name,\n      address: payload.address,\n      code: payload.code,\n      city: payload.city,\n      countries_id: payload.countries_id,\n      phone: payload.phone,\n      email_establishment: payload.email_establishment,\n      website: payload.website,\n      surname_director: payload.surname_director,\n      name_director: payload.name_director,\n      email_director: payload.email_director,\n      phone_director: payload.phone_director,\n      estab_type_id: payload.estab_type_id,\n      number_students: payload.number_students,\n      contract_start_date: payload.contract_start_date,\n      contract_end_date: payload.contract_end_date,\n      number_sms: payload.number_sms,\n      mode_payment: payload.mode_payment,\n      status: true,\n      module_id: payload.module_id,\n      logo: \"\",\n      matricule: payload.matricule,\n      tva: payload.tva,\n      capital: payload.capital,\n      siren: payload.siren,\n      siret: payload.siret\n    };\n    let apiEndpoint = `/establishments?access_token=${localStorage.token}`;\n    classService.post(apiEndpoint, establishmentData).then(response => {\n      if (file !== null) {\n        const fileExtension = file.name.replace(/^.*\\./, \"\");\n        const fileName = response.data.id + response.data.name + \".\" + fileExtension;\n        let dataWithFile = {\n          name: payload.name,\n          ar_name: payload.ar_name,\n          address: payload.address,\n          code: payload.code,\n          city: payload.city,\n          countries_id: payload.countries_id,\n          phone: payload.phone,\n          email_establishment: payload.email_establishment,\n          website: payload.website,\n          surname_director: payload.surname_director,\n          name_director: payload.name_director,\n          email_director: payload.email_director,\n          phone_director: payload.phone_director,\n          estab_type_id: payload.estab_type_id,\n          number_students: payload.number_students,\n          contract_start_date: payload.contract_start_date,\n          contract_end_date: payload.contract_end_date,\n          number_sms: payload.number_sms,\n          mode_payment: payload.mode_payment,\n          status: true,\n          module_id: payload.module_id,\n          logo: fileName,\n          matricule: payload.matricule,\n          tva: payload.tva,\n          capital: payload.capital,\n          siren: payload.siren,\n          siret: payload.siret\n        };\n        let apiEndpoint2 = `/establishments/` + response.data.id + `?access_token=${localStorage.token}`;\n        classService.put(apiEndpoint2, dataWithFile).then(response => {\n          const myNewFile = new File([file], fileName, {\n            type: file.type\n          });\n          dispatch(uploadFile2(response.data, myNewFile));\n        }).catch(error => {});\n      } else {\n        let dataWithoutFile = {\n          name: payload.name,\n          ar_name: payload.ar_name,\n          address: payload.address,\n          code: payload.code,\n          city: payload.city,\n          countries_id: payload.countries_id,\n          phone: payload.phone,\n          email_establishment: payload.email_establishment,\n          website: payload.website,\n          surname_director: payload.surname_director,\n          name_director: payload.name_director,\n          email_director: payload.email_director,\n          phone_director: payload.phone_director,\n          estab_type_id: payload.estab_type_id,\n          number_students: payload.number_students,\n          contract_start_date: payload.contract_start_date,\n          contract_end_date: payload.contract_end_date,\n          number_sms: payload.number_sms,\n          mode_payment: payload.mode_payment,\n          status: true,\n          module_id: payload.module_id,\n          logo: null,\n          matricule: payload.matricule,\n          tva: payload.tva,\n          capital: payload.capital,\n          siren: payload.siren,\n          siret: payload.siret\n        };\n        let apiEndpoint3 = `/establishments/` + response.data.id + `?access_token=${localStorage.token}`;\n        classService.put(apiEndpoint3, dataWithoutFile).then(response => {\n          dispatch({\n            type: \"ADD_ESTABLISHMENT\",\n            payload: response.data\n          });\n        }).catch(error => {});\n      }\n    }).catch(error => {});\n  };\n}\nexport function saveEstablishments(establishment, file) {\n  let container = {\n    name: establishment.name\n  };\n  let formadata = new FormData();\n  formadata.append(\"image\", container);\n  return dispatch => {\n    let apiEndpoint = `/containers?access_token=${localStorage.token}`;\n    classService.post(apiEndpoint, container).then(response => {\n      dispatch(saveEstablishment(establishment, file));\n    }).catch(error => {});\n  };\n}\nexport function deleteData(idItem) {\n  return dispatch => {\n    let apiEndpoint = `/establishments/` + idItem + `?access_token=${localStorage.token}`;\n    classService.get(apiEndpoint).then(response => {\n      const dataEstablishment = response.data;\n      let establishmentData = {\n        name: dataEstablishment.name,\n        ar_name: dataEstablishment.ar_name,\n        address: dataEstablishment.address,\n        code: dataEstablishment.code,\n        city: dataEstablishment.city,\n        countries_id: dataEstablishment.countries_id,\n        phone: dataEstablishment.phone,\n        email_establishment: dataEstablishment.email_establishment,\n        website: dataEstablishment.website,\n        surname_director: dataEstablishment.surname_director,\n        name_director: dataEstablishment.name_director,\n        email_director: dataEstablishment.email_director,\n        phone_director: dataEstablishment.phone_director,\n        estab_type_id: dataEstablishment.estab_type_id,\n        number_students: dataEstablishment.number_students,\n        contract_start_date: dataEstablishment.contract_start_date,\n        contract_end_date: dataEstablishment.contract_end_date,\n        number_sms: dataEstablishment.number_sms,\n        mode_payment: dataEstablishment.mode_payment,\n        status: false,\n        module_id: dataEstablishment.module_id,\n        id: dataEstablishment.id,\n        matricule: dataEstablishment.matricule,\n        tva: dataEstablishment.tva,\n        capital: dataEstablishment.capital,\n        siren: dataEstablishment.siren,\n        siret: dataEstablishment.siret\n      };\n      let apiEndpoint2 = `/establishments/` + dataEstablishment.id + `?access_token=${localStorage.token}`;\n      classService.put(apiEndpoint2, establishmentData).then(response => {\n        dispatch({\n          type: \"DELETE_ESTABLISHMENT\",\n          payload: response.data\n        });\n      }).catch(error => {});\n    }).catch(error => {});\n  };\n}\nexport function updateEstablishment(payload, file) {\n  if (file !== null) {\n    if (payload.logo !== null) {\n      return dispatch => {\n        let formadata = new FormData();\n        formadata.append(\"image\", file);\n        let apiEndpoint = `/containers/` + payload.name + \"/files/\" + payload.logo + `?access_token=${localStorage.token}`;\n        classService.delete(apiEndpoint, formadata).then(response => {\n          dispatch(updateEstablishData(payload, file));\n        }).catch(error => {});\n      };\n    } else {\n      return function (dispatch) {\n        dispatch(updateEstablishData(payload, file));\n      };\n    }\n  } else {\n    return dispatch => {\n      let data = {\n        name: payload.name,\n        ar_name: payload.ar_name,\n        address: payload.address,\n        code: payload.code,\n        city: payload.city,\n        countries_id: payload.countries_id,\n        phone: payload.phone,\n        email_establishment: payload.email_establishment,\n        website: payload.website,\n        surname_director: payload.surname_director,\n        name_director: payload.name_director,\n        email_director: payload.email_director,\n        phone_director: payload.phone_director,\n        estab_type_id: payload.estab_type_id,\n        number_students: payload.number_students,\n        contract_start_date: payload.contract_start_date,\n        contract_end_date: payload.contract_end_date,\n        number_sms: payload.number_sms,\n        mode_payment: payload.mode_payment,\n        status: payload.status,\n        module_id: payload.module_id,\n        id: payload.id,\n        logo: payload.logo,\n        matricule: payload.matricule,\n        tva: payload.tva,\n        capital: payload.capital,\n        siren: payload.siren,\n        siret: payload.siret\n      };\n      let apiEndpoint = `/establishments/` + payload.id + `?access_token=${localStorage.token}`;\n      classService.put(apiEndpoint, data).then(response => {\n        dispatch({\n          type: \"EDIT_ESTABLISHMENT\",\n          payload: response.data\n        });\n        dispatch(deleteEstablishmentModules(payload.id));\n        dispatch(EstablishmentModules(data, data));\n      }).catch(error => {});\n    };\n  }\n}\nexport function updateEstablishData(payload, file) {\n  return dispatch => {\n    const fileExtension = file.name.replace(/^.*\\./, \"\");\n    const fileName = payload.id + payload.name + \".\" + fileExtension;\n    const myNewFile = new File([file], fileName, {\n      type: file.type\n    });\n    let newData = {\n      name: payload.name,\n      ar_name: payload.ar_name,\n      address: payload.address,\n      code: payload.code,\n      city: payload.city,\n      countries_id: payload.countries_id,\n      phone: payload.phone,\n      email_establishment: payload.email_establishment,\n      website: payload.website,\n      surname_director: payload.surname_director,\n      name_director: payload.name_director,\n      email_director: payload.email_director,\n      phone_director: payload.phone_director,\n      estab_type_id: payload.estab_type_id,\n      number_students: payload.number_students,\n      contract_start_date: payload.contract_start_date,\n      contract_end_date: payload.contract_end_date,\n      number_sms: payload.number_sms,\n      mode_payment: payload.mode_payment,\n      status: payload.status,\n      module_id: payload.module_id,\n      id: payload.id,\n      logo: fileName,\n      matricule: payload.matricule,\n      tva: payload.tva,\n      capital: payload.capital,\n      siren: payload.siren,\n      siret: payload.siret\n    };\n    let apiEndpoint = `/establishments/` + payload.id + `?access_token=${localStorage.token}`;\n    classService.put(apiEndpoint, newData).then(response => {\n      dispatch(uploadEditFile(response.data, myNewFile));\n    }).catch(error => {});\n  };\n}\nexport function uploadEditFile(payload, file) {\n  return dispatch => {\n    let formadata = new FormData();\n    formadata.append(\"image\", file);\n    let apiEndpoint = `/containers/` + payload.name + `/upload?access_token=${localStorage.token}`;\n    classService.post(apiEndpoint, formadata).then(response => {\n      dispatch({\n        type: \"EDIT_ESTABLISHMENT\",\n        payload: payload\n      });\n      alert(\"L'ajout est effectué avec succès\");\n    }).catch(error => {});\n  };\n}\nexport function EstablishmentModules(payload, data) {\n  return dispatch => {\n    var object = {\n      \"start_date\": payload.start_date,\n      \"end_date\": payload.end_date,\n      \"status\": true,\n      \"establishment_id\": payload.id\n    };\n    var modules = payload.module_id.map(function (num) {\n      var object = {\n        \"start_date\": payload.contract_start_date,\n        \"end_date\": payload.contract_end_date,\n        \"status\": true,\n        \"establishment_id\": payload.id,\n        \"module_id\": num\n      };\n      return object;\n    });\n    axios.post(`${baseUrl.baseUrl}/establishements_modules/AddestablishmentModules?access_token=${localStorage.token}`, {\n      modules\n    }).then(response => {\n      dispatch({\n        type: SHOW_SUCCESS_MESSAGE\n      });\n      setTimeout(() => {\n        dispatch({\n          type: HIDE_SUCCESS_MESSAGE\n        });\n      }, 4000);\n    }).catch(error => {\n      dispatch({\n        type: SHOW_ERROR_MESSAGE\n      });\n      setTimeout(() => {\n        dispatch({\n          type: HIDE_ERROR_MESSAGE\n        });\n      }, 4000);\n    });\n  };\n}\nexport function deleteEstablishmentModules(id) {\n  return dispatch => {\n    axios.get(`${baseUrl.baseUrl}/establishments/getModuleEstab/` + id + `?access_token=${localStorage.token}`).then(response => {}).catch(error => {});\n  };\n}","map":{"version":3,"sources":["/home/oem/Documents/projects/educap/classebook-front-web/src/actions/establishmentAction.js"],"names":["_","classService","axios","baseUrl","SHOW_ERROR_MESSAGE","HIDE_ERROR_MESSAGE","HIDE_SUCCESS_MESSAGE","SHOW_SUCCESS_MESSAGE","getEstablishment","dispatch","apiEndpoint","localStorage","token","get","then","response","ListEstablishments","data","establishmentList","filter","element","status","type","payload","addEstablishmentContainers","catch","error","listEstablishment","console","log","map","establishment","some","name","container","formadata","FormData","append","apiEndpoint2","post","uploadFile2","file","EstablishmentModules","saveEstablishment","establishmentData","ar_name","address","code","city","countries_id","phone","email_establishment","website","surname_director","name_director","email_director","phone_director","estab_type_id","number_students","contract_start_date","contract_end_date","number_sms","mode_payment","module_id","logo","matricule","tva","capital","siren","siret","fileExtension","replace","fileName","id","dataWithFile","put","myNewFile","File","dataWithoutFile","apiEndpoint3","saveEstablishments","deleteData","idItem","dataEstablishment","updateEstablishment","delete","updateEstablishData","deleteEstablishmentModules","newData","uploadEditFile","alert","object","start_date","end_date","modules","num","setTimeout"],"mappings":"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","sourcesContent":["\nimport _ from \"lodash\";\nimport { classService } from \"../_services/class.service\";\nimport axios from 'axios';\nimport baseUrl from '../config/config';\nimport { SHOW_ERROR_MESSAGE, HIDE_ERROR_MESSAGE, HIDE_SUCCESS_MESSAGE, SHOW_SUCCESS_MESSAGE } from \"../constants/ActionTypes\";\n\nexport function getEstablishment() {\n  return dispatch => {\n    let apiEndpoint = `/establishments?access_token=${localStorage.token}`;\n    classService\n      .get(apiEndpoint)\n      .then(response => {\n        const ListEstablishments = response.data;\n        const establishmentList = ListEstablishments.filter(\n          element => element.status\n        );\n        dispatch({ type: \"GET_ALL_ESTABLISHMENT\", payload: establishmentList });\n        dispatch(addEstablishmentContainers(establishmentList));\n      })\n      .catch(error => {\n      });\n  };\n}\nexport function addEstablishmentContainers(listEstablishment) {\n  return dispatch => {\n    let apiEndpoint = `/containers?access_token=${localStorage.token}`;\n    classService\n      .get(apiEndpoint)\n      .then(response => {\n        console.log('test container')\n        listEstablishment.map(establishment => {\n          if (_.some(response.data, [\"name\", establishment.name])) {\n          } else {\n            let container = { name: establishment.name };\n            let formadata = new FormData();\n            formadata.append(\"image\", container);\n            let apiEndpoint2 = `/containers?access_token=${localStorage.token}`;\n            classService.post(apiEndpoint2, container);\n          }\n        });\n      })\n      .catch(error => {\n      });\n  };\n}\n\nexport function uploadFile2(payload, file) {\n\n  return dispatch => {\n    let formadata = new FormData();\n    formadata.append(\"image\", file);\n    let apiEndpoint = `/containers/educap.storage/Establishments?access_token=${localStorage.token}`;\n    classService.post(apiEndpoint, formadata)\n      .then(response => {\n        console.log(response)\n        dispatch({ type: \"ADD_ESTABLISHMENT\", payload: payload });\n        dispatch(EstablishmentModules(payload));\n\n      }).catch(error => {\n      });\n  };\n}\n\nexport function saveEstablishment(payload, file) {\n  return dispatch => {\n    let establishmentData = {\n      name: payload.name,\n      ar_name: payload.ar_name,\n      address: payload.address,\n      code: payload.code,\n      city: payload.city,\n      countries_id: payload.countries_id,\n      phone: payload.phone,\n      email_establishment: payload.email_establishment,\n      website: payload.website,\n      surname_director: payload.surname_director,\n      name_director: payload.name_director,\n      email_director: payload.email_director,\n      phone_director: payload.phone_director,\n      estab_type_id: payload.estab_type_id,\n      number_students: payload.number_students,\n      contract_start_date: payload.contract_start_date,\n      contract_end_date: payload.contract_end_date,\n      number_sms: payload.number_sms,\n      mode_payment: payload.mode_payment,\n      status: true,\n      module_id: payload.module_id,\n      logo: \"\",\n      matricule: payload.matricule,\n      tva: payload.tva,\n      capital: payload.capital,\n      siren: payload.siren,\n      siret: payload.siret\n    };\n    let apiEndpoint = `/establishments?access_token=${localStorage.token}`;\n    classService\n      .post(apiEndpoint, establishmentData)\n      .then(response => {\n        if (file !== null) {\n          const fileExtension = file.name.replace(/^.*\\./, \"\");\n          const fileName =\n            response.data.id + response.data.name + \".\" + fileExtension;\n          let dataWithFile = {\n            name: payload.name,\n            ar_name: payload.ar_name,\n            address: payload.address,\n            code: payload.code,\n            city: payload.city,\n            countries_id: payload.countries_id,\n            phone: payload.phone,\n            email_establishment: payload.email_establishment,\n            website: payload.website,\n            surname_director: payload.surname_director,\n            name_director: payload.name_director,\n            email_director: payload.email_director,\n            phone_director: payload.phone_director,\n            estab_type_id: payload.estab_type_id,\n            number_students: payload.number_students,\n            contract_start_date: payload.contract_start_date,\n            contract_end_date: payload.contract_end_date,\n            number_sms: payload.number_sms,\n            mode_payment: payload.mode_payment,\n            status: true,\n            module_id: payload.module_id,\n            logo: fileName,\n            matricule: payload.matricule,\n            tva: payload.tva,\n            capital: payload.capital,\n            siren: payload.siren,\n            siret: payload.siret\n          };\n\n          let apiEndpoint2 = `/establishments/` + response.data.id + `?access_token=${localStorage.token}`;\n          classService.put(apiEndpoint2, dataWithFile)\n            .then(response => {\n              const myNewFile = new File([file], fileName, { type: file.type });\n              dispatch(uploadFile2(response.data, myNewFile));\n            }).catch(error => {\n            });\n        } else {\n          let dataWithoutFile = {\n            name: payload.name,\n            ar_name: payload.ar_name,\n            address: payload.address,\n            code: payload.code,\n            city: payload.city,\n            countries_id: payload.countries_id,\n            phone: payload.phone,\n            email_establishment: payload.email_establishment,\n            website: payload.website,\n            surname_director: payload.surname_director,\n            name_director: payload.name_director,\n            email_director: payload.email_director,\n            phone_director: payload.phone_director,\n            estab_type_id: payload.estab_type_id,\n            number_students: payload.number_students,\n            contract_start_date: payload.contract_start_date,\n            contract_end_date: payload.contract_end_date,\n            number_sms: payload.number_sms,\n            mode_payment: payload.mode_payment,\n            status: true,\n            module_id: payload.module_id,\n            logo: null,\n            matricule: payload.matricule,\n            tva: payload.tva,\n            capital: payload.capital,\n            siren: payload.siren,\n            siret: payload.siret\n          };\n          let apiEndpoint3 = `/establishments/` + response.data.id + `?access_token=${localStorage.token}`;\n          classService.put(apiEndpoint3, dataWithoutFile)\n            .then(response => {\n              dispatch({ type: \"ADD_ESTABLISHMENT\", payload: response.data });\n            }).catch(error => {\n            });\n        }\n\n      }).catch(error => {\n      });\n\n  };\n}\n\nexport function saveEstablishments(establishment, file) {\n  let container = { name: establishment.name };\n  let formadata = new FormData();\n  formadata.append(\"image\", container);\n  return dispatch => {\n    let apiEndpoint = `/containers?access_token=${localStorage.token}`;\n    classService\n      .post(apiEndpoint, container)\n      .then(response => {\n        dispatch(saveEstablishment(establishment, file));\n      })\n      .catch(error => {\n      });\n  };\n}\nexport function deleteData(idItem) {\n  return dispatch => {\n    let apiEndpoint =\n      `/establishments/` + idItem + `?access_token=${localStorage.token}`;\n    classService\n      .get(apiEndpoint)\n      .then(response => {\n        const dataEstablishment = response.data;\n        let establishmentData = {\n          name: dataEstablishment.name,\n          ar_name: dataEstablishment.ar_name,\n          address: dataEstablishment.address,\n          code: dataEstablishment.code,\n          city: dataEstablishment.city,\n          countries_id: dataEstablishment.countries_id,\n          phone: dataEstablishment.phone,\n          email_establishment: dataEstablishment.email_establishment,\n          website: dataEstablishment.website,\n          surname_director: dataEstablishment.surname_director,\n          name_director: dataEstablishment.name_director,\n          email_director: dataEstablishment.email_director,\n          phone_director: dataEstablishment.phone_director,\n          estab_type_id: dataEstablishment.estab_type_id,\n          number_students: dataEstablishment.number_students,\n          contract_start_date: dataEstablishment.contract_start_date,\n          contract_end_date: dataEstablishment.contract_end_date,\n          number_sms: dataEstablishment.number_sms,\n          mode_payment: dataEstablishment.mode_payment,\n          status: false,\n          module_id: dataEstablishment.module_id,\n          id: dataEstablishment.id,\n          matricule: dataEstablishment.matricule,\n          tva: dataEstablishment.tva,\n          capital: dataEstablishment.capital,\n          siren: dataEstablishment.siren,\n          siret: dataEstablishment.siret\n        };\n        let apiEndpoint2 =\n          `/establishments/` +\n          dataEstablishment.id +\n          `?access_token=${localStorage.token}`;\n        classService\n          .put(apiEndpoint2, establishmentData)\n\n          .then(response => {\n            dispatch({ type: \"DELETE_ESTABLISHMENT\", payload: response.data });\n          })\n          .catch(error => {\n          });\n      })\n      .catch(error => {\n      });\n  };\n}\n\nexport function updateEstablishment(payload, file) {\n  if (file !== null) {\n    if (payload.logo !== null) {\n      return dispatch => {\n        let formadata = new FormData();\n        formadata.append(\"image\", file);\n        let apiEndpoint = `/containers/` + payload.name + \"/files/\" + payload.logo + `?access_token=${localStorage.token}`;\n        classService.delete(apiEndpoint, formadata)\n          .then(response => {\n            dispatch(updateEstablishData(payload, file));\n          }).catch(error => {\n          });\n      };\n    } else {\n      return function (dispatch) {\n        dispatch(updateEstablishData(payload, file));\n      };\n    }\n  } else {\n\n    return dispatch => {\n      let data = {\n        name: payload.name,\n        ar_name: payload.ar_name,\n        address: payload.address,\n        code: payload.code,\n        city: payload.city,\n        countries_id: payload.countries_id,\n        phone: payload.phone,\n        email_establishment: payload.email_establishment,\n        website: payload.website,\n        surname_director: payload.surname_director,\n        name_director: payload.name_director,\n        email_director: payload.email_director,\n        phone_director: payload.phone_director,\n        estab_type_id: payload.estab_type_id,\n        number_students: payload.number_students,\n        contract_start_date: payload.contract_start_date,\n        contract_end_date: payload.contract_end_date,\n        number_sms: payload.number_sms,\n        mode_payment: payload.mode_payment,\n        status: payload.status,\n        module_id: payload.module_id,\n        id: payload.id,\n        logo: payload.logo,\n        matricule: payload.matricule,\n        tva: payload.tva,\n        capital: payload.capital,\n        siren: payload.siren,\n        siret: payload.siret\n      }\n      let apiEndpoint = `/establishments/` + payload.id + `?access_token=${localStorage.token}`;\n      classService.put(apiEndpoint, data)\n        .then(response => {\n          dispatch({ type: \"EDIT_ESTABLISHMENT\", payload: response.data });\n          dispatch(deleteEstablishmentModules(payload.id));\n          dispatch(EstablishmentModules(data, data));\n\n\n        }).catch(error => {\n        });\n    };\n  }\n}\n\nexport function updateEstablishData(payload, file) {\n  return dispatch => {\n    const fileExtension = file.name.replace(/^.*\\./, \"\");\n    const fileName = payload.id + payload.name + \".\" + fileExtension;\n    const myNewFile = new File([file], fileName, { type: file.type });\n    let newData = {\n      name: payload.name,\n      ar_name: payload.ar_name,\n      address: payload.address,\n      code: payload.code,\n      city: payload.city,\n      countries_id: payload.countries_id,\n      phone: payload.phone,\n      email_establishment: payload.email_establishment,\n      website: payload.website,\n      surname_director: payload.surname_director,\n      name_director: payload.name_director,\n      email_director: payload.email_director,\n      phone_director: payload.phone_director,\n      estab_type_id: payload.estab_type_id,\n      number_students: payload.number_students,\n      contract_start_date: payload.contract_start_date,\n      contract_end_date: payload.contract_end_date,\n      number_sms: payload.number_sms,\n      mode_payment: payload.mode_payment,\n      status: payload.status,\n      module_id: payload.module_id,\n      id: payload.id,\n      logo: fileName,\n      matricule: payload.matricule,\n      tva: payload.tva,\n      capital: payload.capital,\n      siren: payload.siren,\n      siret: payload.siret\n    }\n    let apiEndpoint = `/establishments/` + payload.id + `?access_token=${localStorage.token}`;\n    classService.put(apiEndpoint, newData)\n      .then(response => {\n        dispatch(uploadEditFile(response.data, myNewFile));\n      }).catch(error => {\n      });\n  };\n}\n\nexport function uploadEditFile(payload, file) {\n  return dispatch => {\n    let formadata = new FormData();\n    formadata.append(\"image\", file);\n    let apiEndpoint = `/containers/` + payload.name + `/upload?access_token=${localStorage.token}`;\n    classService.post(apiEndpoint, formadata)\n      .then(response => {\n        dispatch({ type: \"EDIT_ESTABLISHMENT\", payload: payload });\n        alert(\"L'ajout est effectué avec succès\");\n      }).catch(error => {\n      });\n  };\n}\n\nexport function EstablishmentModules(payload, data) {\n  return dispatch => {\n    var object = {\n      \"start_date\": payload.start_date,\n      \"end_date\": payload.end_date,\n      \"status\": true,\n      \"establishment_id\": payload.id,\n    }\n    var modules = payload.module_id.map(function (num) {\n      var object = {\n        \"start_date\": payload.contract_start_date,\n        \"end_date\": payload.contract_end_date,\n        \"status\": true,\n        \"establishment_id\": payload.id,\n        \"module_id\": num\n      }\n\n      return object;\n    });\n    axios.post(`${baseUrl.baseUrl}/establishements_modules/AddestablishmentModules?access_token=${localStorage.token}`, { modules })\n      .then(response => {\n\n        dispatch({ type: SHOW_SUCCESS_MESSAGE })\n        setTimeout(() => {\n          dispatch({ type: HIDE_SUCCESS_MESSAGE });\n        }, 4000);\n\n      }).catch(error => {\n        dispatch({ type: SHOW_ERROR_MESSAGE });\n        setTimeout(() => {\n          dispatch({ type: HIDE_ERROR_MESSAGE });\n        }, 4000);\n      });\n  };\n}\n\nexport function deleteEstablishmentModules(id) {\n  return dispatch => {\n    axios.get(`${baseUrl.baseUrl}/establishments/getModuleEstab/` + id + `?access_token=${localStorage.token}`)\n      .then(response => {\n\n      })\n      .catch(error => {\n       });\n\n  }\n}"]},"metadata":{},"sourceType":"module"}