{"ast":null,"code":"import { classService } from \"../_services/class.service\";\nimport { FETECHED_ALL_SERVICES, ADD_SERVICE, EDIT_SERVICE, DELETE_SERVICE, HANDLE_REQUEST_CLOSE, SHOW_ERROR_MESSAGE, HIDE_ERROR_MESSAGE, HIDE_SUCCESS_MESSAGE, SHOW_SUCCESS_MESSAGE, FETECHED_ALL_SERVICES_ARCHIVES, LIST_ALLOCATION_SERVICE, FETECHED_ALL_SERVICES_V2 } from \"../constants/ActionTypes\";\nimport baseUrl from \"../config/config\";\nimport axios from \"axios\";\nimport _ from \"lodash\";\nexport const addService = itemService => {\n  //1\n  return dispatch => {\n    let apiEndpoint = `/services?access_token=${localStorage.token}`;\n    classService.post(apiEndpoint, itemService).then(response => {\n      if (response) {\n        dispatch({\n          type: ADD_SERVICE,\n          payload: response.data\n        });\n        dispatch({\n          type: SHOW_SUCCESS_MESSAGE,\n          payload: \"La création est effectuée avec succès\"\n        });\n        setTimeout(() => {\n          dispatch({\n            type: HIDE_SUCCESS_MESSAGE\n          });\n        }, 4000);\n      } else {\n        dispatch({\n          type: SHOW_ERROR_MESSAGE,\n          payload: \"Une erreur est survenue lors de la création merci d'essayer à nouveau\"\n        });\n        setTimeout(() => {\n          dispatch({\n            type: HIDE_ERROR_MESSAGE\n          });\n        }, 4000);\n      }\n    });\n  };\n};\nexport function getServiceV2(idEstablishment) {\n  return dispatch => {\n    let apiEndpoint = `/service_v2?access_token=${localStorage.token}&filter[where][fk_id_establishment]=` + idEstablishment + `&filter[include]=currencyV2&filter[include]=frequencyV2&filter[include]=schoolYearV2`;\n    classService.get(apiEndpoint).then(response => {\n      if (response) {\n        const list = response.data;\n        const serviceList = list.filter(element => element.status_service);\n        const serviceListArchive = list.filter(element => element.status_service === false);\n        dispatch({\n          type: FETECHED_ALL_SERVICES_V2,\n          payload: serviceList\n        });\n        dispatch({\n          type: FETECHED_ALL_SERVICES_ARCHIVES,\n          payload: serviceListArchive\n        });\n      }\n    });\n  };\n}\nexport function addServiceV2(itemService, idEstablishment) {\n  return dispatch => {\n    let apiEndpoint = `/service_v2?access_token=${localStorage.token}`;\n    classService.post(apiEndpoint, itemService).then(response => {\n      if (_.isEmpty(response.data)) {\n        console.log(\"no data\");\n        dispatch({\n          type: SHOW_ERROR_MESSAGE,\n          payload: \"Une erreur est survenue lors de la création merci d'essayer à nouveau\"\n        });\n        setTimeout(() => {\n          dispatch({\n            type: HIDE_ERROR_MESSAGE\n          });\n        }, 4000);\n      } else {\n        dispatch(getServiceV2(idEstablishment));\n        dispatch({\n          type: SHOW_SUCCESS_MESSAGE,\n          payload: \"La création est effectuée avec succès\"\n        });\n        setTimeout(() => {\n          dispatch({\n            type: HIDE_SUCCESS_MESSAGE\n          });\n        }, 4000);\n      }\n    }).catch(error => {});\n  };\n}\nexport const getServices = () => {\n  return dispatch => {\n    let apiEndpoint = `/services?access_token=${localStorage.token}`;\n    classService.get(apiEndpoint).then(response => {\n      const list = response.data;\n      const serviceList = list.filter(element => element.status);\n      dispatch({\n        type: FETECHED_ALL_SERVICES,\n        payload: serviceList\n      });\n    }).catch(err => {});\n  };\n};\nexport const getServicesByEstablishmentId = establishmentId => {\n  return dispatch => {\n    let apiEndpoint = `/services?access_token=${localStorage.token}&filter[where][establishment_id]=` + establishmentId;\n    classService.get(apiEndpoint).then(response => {\n      const list = response.data;\n      const serviceList = list.filter(element => element.status);\n      dispatch({\n        type: FETECHED_ALL_SERVICES,\n        payload: serviceList\n      });\n    }).catch(err => {});\n  };\n};\nexport function deleteServices(itemId) {\n  return dispatch => {\n    let apiEndpoint = `/services/` + itemId + `?access_token=${localStorage.token}`;\n    classService.get(apiEndpoint).then(response => {\n      const dataService = response.data;\n      let serviceData = {\n        name: dataService.name,\n        details: dataService.details,\n        start_date: dataService.start_date,\n        end_date: dataService.end_date,\n        price: dataService.price,\n        price_ttc: dataService.price_ttc,\n        tva: dataService.tva,\n        currency: dataService.currency,\n        payment_periodicity: dataService.payment_periodicity,\n        note: dataService.note,\n        status: false,\n        id: dataService.id,\n        establishment_id: dataService.establishment_id\n      };\n      let apiEndpoint2 = `/services/` + dataService.id + `?access_token=${localStorage.token}`;\n      classService.put(apiEndpoint2, serviceData).then(response => {\n        dispatch({\n          type: DELETE_SERVICE,\n          payload: response.data\n        });\n      }).catch(error => {});\n    }).catch(error => {});\n  };\n}\nexport function editService(dataService) {\n  return dispatch => {\n    let serviceData = {\n      name: dataService.name,\n      details: dataService.details,\n      start_date: dataService.start_date,\n      end_date: dataService.end_date,\n      price: dataService.price,\n      price_ttc: dataService.price_ttc,\n      tva: dataService.tva,\n      currency: dataService.currency,\n      payment_periodicity: dataService.payment_periodicity,\n      note: dataService.note,\n      status: true,\n      id: dataService.id,\n      establishment_id: dataService.establishment_id\n    };\n    let apiEndpoint = `/services/` + dataService.id + `?access_token=${localStorage.token}`;\n    classService.put(apiEndpoint, serviceData).then(response => {\n      if (response) {\n        dispatch({\n          type: EDIT_SERVICE,\n          payload: response.data\n        });\n        dispatch({\n          type: SHOW_SUCCESS_MESSAGE,\n          payload: \"La modification est effectuée avec succès\"\n        });\n        setTimeout(() => {\n          dispatch({\n            type: HIDE_SUCCESS_MESSAGE\n          });\n        }, 4000);\n      } else {\n        dispatch({\n          type: SHOW_ERROR_MESSAGE,\n          payload: \"Une erreur est survenue lors de la modification merci d'essayer à nouveau\"\n        });\n        setTimeout(() => {\n          dispatch({\n            type: HIDE_ERROR_MESSAGE\n          });\n        }, 4000);\n      }\n    });\n  };\n}\nexport function editServiceV2(itemService) {\n  return dispatch => {\n    let apiEndpoint = `/service_v2/` + itemService.id + `?access_token=${localStorage.token}`;\n    classService.put(apiEndpoint, itemService).then(response => {\n      if (_.isEmpty(response.data)) {\n        dispatch({\n          type: SHOW_ERROR_MESSAGE,\n          payload: \"Une erreur est survenue lors de la modification merci d'essayer à nouveau\"\n        });\n        setTimeout(() => {\n          dispatch({\n            type: HIDE_ERROR_MESSAGE\n          });\n        }, 4000);\n      } else {\n        dispatch(getServiceV2(itemService.fk_id_establishment));\n        dispatch({\n          type: SHOW_SUCCESS_MESSAGE,\n          payload: \"La modification est effectuée avec succès\"\n        });\n        setTimeout(() => {\n          dispatch({\n            type: HIDE_SUCCESS_MESSAGE\n          });\n        }, 4000);\n      }\n    }).catch(error => {});\n  };\n}\nexport function deleteServiceV2(itemId) {\n  return dispatch => {\n    axios.patch(`${baseUrl.baseUrl}/service_v2/` + itemId + `?access_token=${localStorage.token}`, {\n      status_service: false\n    }).then(response => {\n      dispatch(getServiceV2(response.data.fk_id_establishment));\n      dispatch({\n        type: SHOW_SUCCESS_MESSAGE,\n        payload: \"L'archivage  est effectuée avec succès\"\n      });\n      setTimeout(() => {\n        dispatch({\n          type: HIDE_SUCCESS_MESSAGE\n        });\n      }, 4000);\n    }).catch(function (error) {\n      dispatch({\n        type: SHOW_ERROR_MESSAGE,\n        payload: \"Une erreur est survenue lors de l'archivage merci d'essayer à nouveau\"\n      });\n      setTimeout(() => {\n        dispatch({\n          type: HIDE_ERROR_MESSAGE\n        });\n      }, 4000);\n      console.log(\"error\", error);\n    });\n  };\n}\nexport function publishServiceV2(itemId) {\n  return dispatch => {\n    axios.patch(`${baseUrl.baseUrl}/service_v2/` + itemId + `?access_token=${localStorage.token}`, {\n      status_service: true\n    }).then(response => {\n      dispatch(getServiceV2(response.data.fk_id_establishment));\n      dispatch({\n        type: SHOW_SUCCESS_MESSAGE,\n        payload: \"Prestation est publiée avec succès\"\n      });\n      setTimeout(() => {\n        dispatch({\n          type: HIDE_SUCCESS_MESSAGE\n        });\n      }, 4000);\n    }).catch(function (error) {\n      dispatch({\n        type: SHOW_ERROR_MESSAGE,\n        payload: \"Une erreur est survenue lors de cette action merci d'essayer à nouveau\"\n      });\n      setTimeout(() => {\n        dispatch({\n          type: HIDE_ERROR_MESSAGE\n        });\n      }, 4000);\n      console.log(\"error\", error);\n    });\n  };\n}\nexport const serviceAction = {\n  addService,\n  getServices,\n  deleteServices,\n  getServicesByEstablishmentId,\n  deleteServiceV2,\n  publishServiceV2\n};","map":{"version":3,"sources":["/home/oem/Documents/projects/educap/classebook-front-web/src/actions/ServiceAction.js"],"names":["classService","FETECHED_ALL_SERVICES","ADD_SERVICE","EDIT_SERVICE","DELETE_SERVICE","HANDLE_REQUEST_CLOSE","SHOW_ERROR_MESSAGE","HIDE_ERROR_MESSAGE","HIDE_SUCCESS_MESSAGE","SHOW_SUCCESS_MESSAGE","FETECHED_ALL_SERVICES_ARCHIVES","LIST_ALLOCATION_SERVICE","FETECHED_ALL_SERVICES_V2","baseUrl","axios","_","addService","itemService","dispatch","apiEndpoint","localStorage","token","post","then","response","type","payload","data","setTimeout","getServiceV2","idEstablishment","get","list","serviceList","filter","element","status_service","serviceListArchive","addServiceV2","isEmpty","console","log","catch","error","getServices","status","err","getServicesByEstablishmentId","establishmentId","deleteServices","itemId","dataService","serviceData","name","details","start_date","end_date","price","price_ttc","tva","currency","payment_periodicity","note","id","establishment_id","apiEndpoint2","put","editService","editServiceV2","fk_id_establishment","deleteServiceV2","patch","publishServiceV2","serviceAction"],"mappings":"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","sourcesContent":["import { classService } from \"../_services/class.service\";\nimport {\n  FETECHED_ALL_SERVICES,\n  ADD_SERVICE,\n  EDIT_SERVICE,\n  DELETE_SERVICE,\n  HANDLE_REQUEST_CLOSE,\n  SHOW_ERROR_MESSAGE,\n  HIDE_ERROR_MESSAGE,\n  HIDE_SUCCESS_MESSAGE,\n  SHOW_SUCCESS_MESSAGE,\n  FETECHED_ALL_SERVICES_ARCHIVES,\n  LIST_ALLOCATION_SERVICE,\n  FETECHED_ALL_SERVICES_V2,\n} from \"../constants/ActionTypes\";\nimport baseUrl from \"../config/config\";\nimport axios from \"axios\";\nimport _ from \"lodash\";\n\nexport const addService = (itemService) => {\n  //1\n  return (dispatch) => {\n    let apiEndpoint = `/services?access_token=${localStorage.token}`;\n    classService.post(apiEndpoint, itemService).then((response) => {\n      if (response) {\n        dispatch({ type: ADD_SERVICE, payload: response.data });\n        dispatch({\n          type: SHOW_SUCCESS_MESSAGE,\n          payload: \"La création est effectuée avec succès\",\n        });\n        setTimeout(() => {\n          dispatch({ type: HIDE_SUCCESS_MESSAGE });\n        }, 4000);\n      } else {\n        dispatch({\n          type: SHOW_ERROR_MESSAGE,\n          payload:\n            \"Une erreur est survenue lors de la création merci d'essayer à nouveau\",\n        });\n        setTimeout(() => {\n          dispatch({ type: HIDE_ERROR_MESSAGE });\n        }, 4000);\n      }\n    });\n  };\n};\n\nexport function getServiceV2(idEstablishment) {\n  return (dispatch) => {\n    let apiEndpoint =\n      `/service_v2?access_token=${localStorage.token}&filter[where][fk_id_establishment]=` +\n      idEstablishment +\n      `&filter[include]=currencyV2&filter[include]=frequencyV2&filter[include]=schoolYearV2`;\n    classService.get(apiEndpoint).then((response) => {\n      if (response) {\n        const list = response.data;\n        const serviceList = list.filter((element) => element.status_service);\n        const serviceListArchive = list.filter(\n          (element) => element.status_service === false\n        );\n\n        dispatch({ type: FETECHED_ALL_SERVICES_V2, payload: serviceList });\n        dispatch({\n          type: FETECHED_ALL_SERVICES_ARCHIVES,\n          payload: serviceListArchive,\n        });\n      }\n    });\n  };\n}\nexport function addServiceV2(itemService, idEstablishment) {\n  return (dispatch) => {\n    let apiEndpoint = `/service_v2?access_token=${localStorage.token}`;\n    classService\n      .post(apiEndpoint, itemService)\n      .then((response) => {\n        if (_.isEmpty(response.data)) {\n          console.log(\"no data\");\n          dispatch({\n            type: SHOW_ERROR_MESSAGE,\n            payload:\n              \"Une erreur est survenue lors de la création merci d'essayer à nouveau\",\n          });\n          setTimeout(() => {\n            dispatch({ type: HIDE_ERROR_MESSAGE });\n          }, 4000);\n        } else {\n          dispatch(getServiceV2(idEstablishment));\n          dispatch({\n            type: SHOW_SUCCESS_MESSAGE,\n            payload: \"La création est effectuée avec succès\",\n          });\n          setTimeout(() => {\n            dispatch({ type: HIDE_SUCCESS_MESSAGE });\n          }, 4000);\n        }\n      })\n      .catch((error) => {});\n  };\n}\n\nexport const getServices = () => {\n  return (dispatch) => {\n    let apiEndpoint = `/services?access_token=${localStorage.token}`;\n    classService\n      .get(apiEndpoint)\n      .then((response) => {\n        const list = response.data;\n        const serviceList = list.filter((element) => element.status);\n        dispatch({ type: FETECHED_ALL_SERVICES, payload: serviceList });\n      })\n      .catch((err) => {});\n  };\n};\n\nexport const getServicesByEstablishmentId = (establishmentId) => {\n  return (dispatch) => {\n    let apiEndpoint =\n      `/services?access_token=${localStorage.token}&filter[where][establishment_id]=` +\n      establishmentId;\n    classService\n      .get(apiEndpoint)\n      .then((response) => {\n        const list = response.data;\n        const serviceList = list.filter((element) => element.status);\n\n        dispatch({ type: FETECHED_ALL_SERVICES, payload: serviceList });\n      })\n      .catch((err) => {});\n  };\n};\n\nexport function deleteServices(itemId) {\n  return (dispatch) => {\n    let apiEndpoint =\n      `/services/` + itemId + `?access_token=${localStorage.token}`;\n    classService\n      .get(apiEndpoint)\n      .then((response) => {\n        const dataService = response.data;\n        let serviceData = {\n          name: dataService.name,\n          details: dataService.details,\n          start_date: dataService.start_date,\n          end_date: dataService.end_date,\n          price: dataService.price,\n          price_ttc: dataService.price_ttc,\n          tva: dataService.tva,\n          currency: dataService.currency,\n          payment_periodicity: dataService.payment_periodicity,\n          note: dataService.note,\n          status: false,\n          id: dataService.id,\n          establishment_id: dataService.establishment_id,\n        };\n        let apiEndpoint2 =\n          `/services/` + dataService.id + `?access_token=${localStorage.token}`;\n        classService\n          .put(apiEndpoint2, serviceData)\n\n          .then((response) => {\n            dispatch({ type: DELETE_SERVICE, payload: response.data });\n          })\n          .catch((error) => {});\n      })\n      .catch((error) => {});\n  };\n}\n\nexport function editService(dataService) {\n  return (dispatch) => {\n    let serviceData = {\n      name: dataService.name,\n      details: dataService.details,\n      start_date: dataService.start_date,\n      end_date: dataService.end_date,\n      price: dataService.price,\n      price_ttc: dataService.price_ttc,\n      tva: dataService.tva,\n      currency: dataService.currency,\n      payment_periodicity: dataService.payment_periodicity,\n      note: dataService.note,\n      status: true,\n      id: dataService.id,\n      establishment_id: dataService.establishment_id,\n    };\n    let apiEndpoint =\n      `/services/` + dataService.id + `?access_token=${localStorage.token}`;\n    classService.put(apiEndpoint, serviceData).then((response) => {\n      if (response) {\n        dispatch({ type: EDIT_SERVICE, payload: response.data });\n        dispatch({\n          type: SHOW_SUCCESS_MESSAGE,\n          payload: \"La modification est effectuée avec succès\",\n        });\n        setTimeout(() => {\n          dispatch({ type: HIDE_SUCCESS_MESSAGE });\n        }, 4000);\n      } else {\n        dispatch({\n          type: SHOW_ERROR_MESSAGE,\n          payload:\n            \"Une erreur est survenue lors de la modification merci d'essayer à nouveau\",\n        });\n        setTimeout(() => {\n          dispatch({ type: HIDE_ERROR_MESSAGE });\n        }, 4000);\n      }\n    });\n  };\n}\n\nexport function editServiceV2(itemService) {\n  return (dispatch) => {\n    let apiEndpoint =\n      `/service_v2/` + itemService.id + `?access_token=${localStorage.token}`;\n    classService\n      .put(apiEndpoint, itemService)\n      .then((response) => {\n        if (_.isEmpty(response.data)) {\n          dispatch({\n            type: SHOW_ERROR_MESSAGE,\n            payload:\n              \"Une erreur est survenue lors de la modification merci d'essayer à nouveau\",\n          });\n          setTimeout(() => {\n            dispatch({ type: HIDE_ERROR_MESSAGE });\n          }, 4000);\n        } else {\n          dispatch(getServiceV2(itemService.fk_id_establishment));\n          dispatch({\n            type: SHOW_SUCCESS_MESSAGE,\n            payload: \"La modification est effectuée avec succès\",\n          });\n          setTimeout(() => {\n            dispatch({ type: HIDE_SUCCESS_MESSAGE });\n          }, 4000);\n        }\n      })\n      .catch((error) => {});\n  };\n}\n\nexport function deleteServiceV2(itemId) {\n  return (dispatch) => {\n    axios\n      .patch(\n        `${baseUrl.baseUrl}/service_v2/` +\n          itemId +\n          `?access_token=${localStorage.token}`,\n        {\n          status_service: false,\n        }\n      )\n      .then((response) => {\n        dispatch(getServiceV2(response.data.fk_id_establishment));\n        dispatch({\n          type: SHOW_SUCCESS_MESSAGE,\n          payload: \"L'archivage  est effectuée avec succès\",\n        });\n        setTimeout(() => {\n          dispatch({ type: HIDE_SUCCESS_MESSAGE });\n        }, 4000);\n      })\n      .catch(function(error) {\n        dispatch({\n          type: SHOW_ERROR_MESSAGE,\n          payload:\n            \"Une erreur est survenue lors de l'archivage merci d'essayer à nouveau\",\n        });\n        setTimeout(() => {\n          dispatch({ type: HIDE_ERROR_MESSAGE });\n        }, 4000);\n        console.log(\"error\", error);\n      });\n  };\n}\n\nexport function publishServiceV2(itemId) {\n  return (dispatch) => {\n    axios\n      .patch(\n        `${baseUrl.baseUrl}/service_v2/` +\n          itemId +\n          `?access_token=${localStorage.token}`,\n        {\n          status_service: true,\n        }\n      )\n      .then((response) => {\n        dispatch(getServiceV2(response.data.fk_id_establishment));\n        dispatch({\n          type: SHOW_SUCCESS_MESSAGE,\n          payload: \"Prestation est publiée avec succès\",\n        });\n        setTimeout(() => {\n          dispatch({ type: HIDE_SUCCESS_MESSAGE });\n        }, 4000);\n      })\n      .catch(function(error) {\n        dispatch({\n          type: SHOW_ERROR_MESSAGE,\n          payload:\n            \"Une erreur est survenue lors de cette action merci d'essayer à nouveau\",\n        });\n        setTimeout(() => {\n          dispatch({ type: HIDE_ERROR_MESSAGE });\n        }, 4000);\n        console.log(\"error\", error);\n      });\n  };\n}\n\nexport const serviceAction = {\n  addService,\n  getServices,\n  deleteServices,\n  getServicesByEstablishmentId,\n  deleteServiceV2,\n  publishServiceV2,\n};\n"]},"metadata":{},"sourceType":"module"}