{"ast":null,"code":"import { EDIT_PAYMENT, GET_PAYMENTS, CLEAR_LIST_PAYMENTS, PAY_BILL } from \"../constants/ActionTypes\";\nimport { classService } from \"../_services/class.service\";\nexport function editPayments(dataPayment, dataLinePayment) {\n  return dispatch => {\n    let apiEndpoint = `/payments/payService?access_token=${localStorage.token}`;\n    classService.post(apiEndpoint, dataPayment).then(response => {\n      let obj = {\n        \"name\": dataLinePayment.name,\n        \"surname\": dataLinePayment.surname,\n        \"service\": {\n          \"name\": dataLinePayment.service.name,\n          \"price\": response.data.payment.price,\n          \"currency\": dataLinePayment.service.currency,\n          \"payment_periodicity\": dataLinePayment.service.payment_periodicity\n        },\n        \"linesPayments\": [response.data.payment]\n      };\n      dispatch({\n        type: EDIT_PAYMENT,\n        payload: obj\n      });\n    }).catch(error => {});\n  };\n}\nexport function editBill(data, idPaymentV2, dataInvoice) {\n  return dispatch => {\n    let apiEndpoint = '';\n    apiEndpoint = `/payments_v2/${idPaymentV2}?access_token=${localStorage.token}`;\n    classService.patch(apiEndpoint, data).then(response => {\n      if (response) {\n        const price_invoice = parseFloat(response.data.price_invoice);\n        const price_paid = parseFloat(response.data.price_paid);\n\n        if (price_invoice === price_paid) {\n          const invoicePaid = 2;\n          apiEndpoint = `/bills/${response.data.fk_id_bill}?access_token=${localStorage.token}`;\n          classService.patch(apiEndpoint, {\n            status: invoicePaid\n          }).then(response => {\n            let obj = {\n              \"bill\": response.data,\n              \"student\": dataInvoice.student,\n              \"service_v2\": dataInvoice.service_v2\n            };\n            dispatch({\n              type: PAY_BILL,\n              payload: obj\n            });\n          });\n        } else if (price_invoice > price_paid) {\n          const partialPayment = 1;\n          apiEndpoint = `/bills/${response.data.fk_id_bill}?access_token=${localStorage.token}`;\n          classService.patch(apiEndpoint, {\n            status: partialPayment\n          }).then(response => {\n            let obj = {\n              \"bill\": response.data,\n              \"student\": dataInvoice.student,\n              \"service_v2\": dataInvoice.service_v2\n            };\n            dispatch({\n              type: PAY_BILL,\n              payload: obj\n            });\n          });\n        }\n      }\n    });\n  };\n}\nexport function payBill(data, dataInvoice) {\n  return dispatch => {\n    let apiEndpoint = '';\n    apiEndpoint = `/payments_v2?access_token=${localStorage.token}`;\n    classService.post(apiEndpoint, data).then(response => {\n      if (response) {\n        const price_invoice = parseFloat(response.data.price_invoice);\n        const price_paid = parseFloat(response.data.price_paid);\n\n        if (price_invoice === price_paid) {\n          const invoicePaid = 2;\n          apiEndpoint = `/bills/${response.data.fk_id_bill}?access_token=${localStorage.token}`;\n          classService.patch(apiEndpoint, {\n            status: invoicePaid\n          }).then(response => {\n            let obj = {\n              \"bill\": response.data,\n              \"student\": dataInvoice.student,\n              \"service_v2\": dataInvoice.service_v2\n            };\n            dispatch({\n              type: PAY_BILL,\n              payload: obj\n            });\n          });\n        } else if (price_invoice > price_paid) {\n          const partialPayment = 1;\n          apiEndpoint = `/bills/${response.data.fk_id_bill}?access_token=${localStorage.token}`;\n          classService.patch(apiEndpoint, {\n            status: partialPayment\n          }).then(response => {\n            let obj = {\n              \"bill\": response.data,\n              \"student\": dataInvoice.student,\n              \"service_v2\": dataInvoice.service_v2\n            };\n            dispatch({\n              type: PAY_BILL,\n              payload: obj\n            });\n          });\n        }\n      }\n    });\n  };\n}\nexport function getPaymentsForParent(profileId) {\n  return dispatch => {\n    let apiEndpoint = `/lines_payments/getPaymentsForParent/${profileId}?access_token=${localStorage.token}`;\n    classService.get(apiEndpoint).then(response => {\n      dispatch({\n        type: GET_PAYMENTS,\n        payload: response.data.payments\n      });\n    }).catch(error => {});\n  };\n}\n;\nexport function getPaymentsForStudent(profileId) {\n  return dispatch => {\n    let apiEndpoint = `/lines_payments/getPaymentsForStudent/${profileId}?access_token=${localStorage.token}`;\n    classService.get(apiEndpoint).then(response => {\n      dispatch({\n        type: GET_PAYMENTS,\n        payload: response.data.payments\n      });\n    }).catch(error => {});\n  };\n}\n;\nexport function getPayments(classId, status, month) {\n  return dispatch => {\n    let apiEndpoint = `/lines_payments/getLinesPayments?classId=${classId}&status=${status}&month=${month}&access_token=${localStorage.token}`;\n    classService.get(apiEndpoint).then(response => {\n      dispatch({\n        type: GET_PAYMENTS,\n        payload: response.data.payments\n      });\n    }).catch(error => {});\n  };\n}\n;\nexport function clearListPayments() {\n  return dispatch => {\n    dispatch({\n      type: CLEAR_LIST_PAYMENTS\n    });\n  };\n}\n;","map":{"version":3,"sources":["/home/oem/Documents/projects/educap/classebook-front-web/src/actions/PaymentAction.js"],"names":["EDIT_PAYMENT","GET_PAYMENTS","CLEAR_LIST_PAYMENTS","PAY_BILL","classService","editPayments","dataPayment","dataLinePayment","dispatch","apiEndpoint","localStorage","token","post","then","response","obj","name","surname","service","data","payment","price","currency","payment_periodicity","type","payload","catch","error","editBill","idPaymentV2","dataInvoice","patch","price_invoice","parseFloat","price_paid","invoicePaid","fk_id_bill","status","student","service_v2","partialPayment","payBill","getPaymentsForParent","profileId","get","payments","getPaymentsForStudent","getPayments","classId","month","clearListPayments"],"mappings":"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","sourcesContent":["\nimport { EDIT_PAYMENT, GET_PAYMENTS, CLEAR_LIST_PAYMENTS, PAY_BILL } from \"../constants/ActionTypes\";\nimport { classService } from \"../_services/class.service\";\n\nexport function editPayments(dataPayment, dataLinePayment) {\n\n    return dispatch => {\n        let apiEndpoint = `/payments/payService?access_token=${localStorage.token}`;\n        classService\n            .post(apiEndpoint, dataPayment)\n            .then(response => {\n\n                let obj = {\n                    \"name\": dataLinePayment.name,\n                    \"surname\": dataLinePayment.surname,\n                    \"service\": {\n                        \"name\": dataLinePayment.service.name,\n                        \"price\": response.data.payment.price,\n                        \"currency\": dataLinePayment.service.currency,\n                        \"payment_periodicity\": dataLinePayment.service.payment_periodicity\n                    },\n                    \"linesPayments\": [response.data.payment]\n                }\n                dispatch({ type: EDIT_PAYMENT, payload: obj });\n            })\n            .catch(error => {\n            });\n    };\n}\nexport function editBill(data,idPaymentV2, dataInvoice) {\n    return dispatch => {\n        let apiEndpoint = '';\n        apiEndpoint = `/payments_v2/${idPaymentV2}?access_token=${localStorage.token}`;\n        classService\n            .patch(apiEndpoint, data).then(response => {\n                if (response) {\n                    const price_invoice = parseFloat(response.data.price_invoice)\n                    const price_paid = parseFloat(response.data.price_paid)\n                    if (price_invoice === price_paid) {\n                        const invoicePaid = 2;\n                        apiEndpoint = `/bills/${response.data.fk_id_bill}?access_token=${localStorage.token}`;\n                        classService.patch(apiEndpoint, {\n                            status: invoicePaid\n                        })\n                            .then(response => {\n                                let obj={\n                                    \"bill\":response.data,\n                                    \"student\": dataInvoice.student,\n                                    \"service_v2\":dataInvoice.service_v2\n                                }\n                                dispatch({ type: PAY_BILL, payload: obj });\n                            })\n\n                    } else if (price_invoice > price_paid) {\n                        const partialPayment = 1;\n                        apiEndpoint = `/bills/${response.data.fk_id_bill}?access_token=${localStorage.token}`;\n                        classService.patch(apiEndpoint, {\n                            status: partialPayment\n                        })\n                            .then(response => {\n                                let obj={\n                                    \"bill\":response.data,\n                                    \"student\": dataInvoice.student,\n                                    \"service_v2\":dataInvoice.service_v2\n                                }\n                                dispatch({ type: PAY_BILL, payload: obj });\n                            })\n                    }\n                }\n                \n\n            })\n    }\n}\n\nexport function payBill(data, dataInvoice) {\n\n    return dispatch => {\n        let apiEndpoint = '';\n        apiEndpoint = `/payments_v2?access_token=${localStorage.token}`;\n        classService\n            .post(apiEndpoint, data)\n            .then(response => {\n                if (response) {\n                    const price_invoice = parseFloat(response.data.price_invoice)\n                    const price_paid = parseFloat(response.data.price_paid)\n                    if (price_invoice === price_paid) {\n                        const invoicePaid = 2;\n                        apiEndpoint = `/bills/${response.data.fk_id_bill}?access_token=${localStorage.token}`;\n                        classService.patch(apiEndpoint, {\n                            status: invoicePaid\n                        })\n                            .then(response => {\n                                let obj={\n                                    \"bill\":response.data,\n                                    \"student\": dataInvoice.student,\n                                    \"service_v2\":dataInvoice.service_v2\n                                }\n                                dispatch({ type: PAY_BILL, payload: obj });\n                            })\n\n                    } else if (price_invoice > price_paid) {\n                        const partialPayment = 1;\n                        apiEndpoint = `/bills/${response.data.fk_id_bill}?access_token=${localStorage.token}`;\n                        classService.patch(apiEndpoint, {\n                            status: partialPayment\n                        })\n                            .then(response => {\n                                let obj={\n                                    \"bill\":response.data,\n                                    \"student\": dataInvoice.student,\n                                    \"service_v2\":dataInvoice.service_v2\n                                }\n                                dispatch({ type: PAY_BILL, payload: obj });\n                            })\n                    }\n                }\n            })\n\n    };\n}\n\n\nexport function getPaymentsForParent(profileId) {\n    return dispatch => {\n        let apiEndpoint = `/lines_payments/getPaymentsForParent/${profileId}?access_token=${localStorage.token}`;\n        classService.get(apiEndpoint)\n            .then(response => {\n                dispatch({ type: GET_PAYMENTS, payload: response.data.payments });\n            }).catch(error => {\n            });\n    };\n};\n\nexport function getPaymentsForStudent(profileId) {\n    return dispatch => {\n        let apiEndpoint = `/lines_payments/getPaymentsForStudent/${profileId}?access_token=${localStorage.token}`;\n        classService.get(apiEndpoint)\n            .then(response => {\n                dispatch({ type: GET_PAYMENTS, payload: response.data.payments });\n            }).catch(error => {\n            });\n    };\n};\n\nexport function getPayments(classId, status, month) {\n    return dispatch => {\n        let apiEndpoint = `/lines_payments/getLinesPayments?classId=${classId}&status=${status}&month=${month}&access_token=${localStorage.token}`;\n        classService.get(apiEndpoint)\n            .then(response => {\n                dispatch({ type: GET_PAYMENTS, payload: response.data.payments });\n            }).catch(error => {\n            });\n    };\n};\n\nexport function clearListPayments() {\n    return dispatch => {\n        dispatch({ type: CLEAR_LIST_PAYMENTS });\n    };\n};"]},"metadata":{},"sourceType":"module"}