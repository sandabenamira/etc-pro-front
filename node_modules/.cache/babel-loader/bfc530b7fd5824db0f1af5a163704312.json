{"ast":null,"code":"import { callService } from '../_services/call.service';\nimport _ from 'lodash';\nimport { GET_PERMISSION_SETTING, SHOW_ERROR_MESSAGE, HIDE_ERROR_MESSAGE, HIDE_SUCCESS_MESSAGE, SHOW_SUCCESS_MESSAGE, GET_USER_PERMISSION } from '../constants/ActionTypes';\nexport const getPermissionSetting = estabId => {\n  let id = parseInt(estabId, 10);\n  return dispatch => {\n    let apiEndpoint = `/establishments/${id}/permission?access_token=${localStorage.token}`;\n    callService.get(apiEndpoint).then(response => {\n      if (response) {\n        dispatch({\n          type: GET_PERMISSION_SETTING,\n          payload: response.data.permissionList\n        });\n      }\n    });\n  };\n};\nexport const getUserPermissions = (estabId, roleId) => {\n  let estab = 6;\n  let role = 7; // let id = parseInt(estabId, 10);\n\n  return dispatch => {\n    // let apiEndpoint = `/etab_role_permissions?access_token=${localStorage.token}?filter[where][and][0][fk_id_role]=${role}&filter[where][and][1][fk_id_etab]=${estab}&filter[include]=permission`;\n    // let apiEndpoint = `/etab_role_permissions?access_token=${localStorage.token}?filter[where][and][0][fk_id_etab]=77&filter[where][and][1][fk_id_role]=2`;\n    let apiEndpoint = `/etab_role_permissions?access_token=${localStorage.token}&filter[where][and][0][fk_id_etab]=` + estab + `&filter[where][and][1][fk_id_role]=` + role + `&filter[include]=permission`;\n    callService.get(apiEndpoint).then(response => {\n      if (response) {\n        console.log(response.data, 'userrrrr permission');\n        dispatch({\n          type: GET_USER_PERMISSION,\n          payload: response.data\n        });\n      }\n    });\n  };\n};\nexport const applyPermissionSetting = data => {\n  let permissionList = {\n    permissionRoleEtab: data\n  };\n  return dispatch => {\n    let apiEndpoint = `/permissions/attributePermission?access_token=${localStorage.token}`;\n    callService.put(apiEndpoint, permissionList).then(response => {\n      if (response) {\n        dispatch({\n          type: SHOW_SUCCESS_MESSAGE,\n          payload: \"L'affectation est effectuée avec succès\"\n        });\n        setTimeout(() => {\n          dispatch({\n            type: HIDE_SUCCESS_MESSAGE\n          });\n        }, 4000);\n        console.log(response.data, 'response applyPermissionSetting response');\n      } else {\n        dispatch({\n          type: SHOW_ERROR_MESSAGE,\n          payload: \"Une erreur est survenue lors de l'affectation merci d'essayer à nouveau\"\n        });\n        setTimeout(() => {\n          dispatch({\n            type: HIDE_ERROR_MESSAGE\n          });\n        }, 4000);\n      }\n    });\n  };\n};","map":{"version":3,"sources":["/home/oem/Documents/projects/educap/classebook-front-web/src/actions/PermissionAction.js"],"names":["callService","_","GET_PERMISSION_SETTING","SHOW_ERROR_MESSAGE","HIDE_ERROR_MESSAGE","HIDE_SUCCESS_MESSAGE","SHOW_SUCCESS_MESSAGE","GET_USER_PERMISSION","getPermissionSetting","estabId","id","parseInt","dispatch","apiEndpoint","localStorage","token","get","then","response","type","payload","data","permissionList","getUserPermissions","roleId","estab","role","console","log","applyPermissionSetting","permissionRoleEtab","put","setTimeout"],"mappings":"AAAA,SAASA,WAAT,QAA4B,2BAA5B;AACA,OAAOC,CAAP,MAAc,QAAd;AACA,SACEC,sBADF,EAEEC,kBAFF,EAGEC,kBAHF,EAIEC,oBAJF,EAKEC,oBALF,EAMEC,mBANF,QAOO,0BAPP;AASA,OAAO,MAAMC,oBAAoB,GAAIC,OAAD,IAAa;AAC/C,MAAIC,EAAE,GAAGC,QAAQ,CAACF,OAAD,EAAU,EAAV,CAAjB;AACA,SAAQG,QAAD,IAAc;AACnB,QAAIC,WAAW,GAAI,mBAAkBH,EAAG,4BAA2BI,YAAY,CAACC,KAAM,EAAtF;AAEAf,IAAAA,WAAW,CAACgB,GAAZ,CAAgBH,WAAhB,EAA6BI,IAA7B,CAAmCC,QAAD,IAAc;AAC9C,UAAIA,QAAJ,EAAc;AACXN,QAAAA,QAAQ,CAAC;AAAEO,UAAAA,IAAI,EAAEjB,sBAAR;AAAgCkB,UAAAA,OAAO,EAAEF,QAAQ,CAACG,IAAT,CAAcC;AAAvD,SAAD,CAAR;AACF;AACF,KAJD;AAKD,GARD;AASD,CAXM;AAYP,OAAO,MAAMC,kBAAkB,GAAG,CAACd,OAAD,EAASe,MAAT,KAAoB;AACpD,MAAIC,KAAK,GAAC,CAAV;AACA,MAAIC,IAAI,GAAE,CAAV,CAFoD,CAGpD;;AACA,SAAQd,QAAD,IAAc;AACnB;AACA;AACA,QAAIC,WAAW,GAAK,uCAAsCC,YAAY,CAACC,KAAM,qCAA1D,GACjBU,KADiB,GACV,qCADU,GAC2BC,IAD3B,GACiC,6BADpD;AAGA1B,IAAAA,WAAW,CAACgB,GAAZ,CAAgBH,WAAhB,EAA6BI,IAA7B,CAAmCC,QAAD,IAAc;AAC9C,UAAIA,QAAJ,EAAc;AACZS,QAAAA,OAAO,CAACC,GAAR,CAAYV,QAAQ,CAACG,IAArB,EAA0B,qBAA1B;AACCT,QAAAA,QAAQ,CAAC;AAAEO,UAAAA,IAAI,EAAEZ,mBAAR;AAA6Ba,UAAAA,OAAO,EAAEF,QAAQ,CAACG;AAA/C,SAAD,CAAR;AACF;AACF,KALD;AAMD,GAZD;AAaD,CAjBM;AAkBP,OAAO,MAAMQ,sBAAsB,GAAIR,IAAD,IAAU;AAC9C,MAAIC,cAAc,GAAG;AAAEQ,IAAAA,kBAAkB,EAAET;AAAtB,GAArB;AACA,SAAQT,QAAD,IAAc;AACnB,QAAIC,WAAW,GAAI,iDAAgDC,YAAY,CAACC,KAAM,EAAtF;AAEAf,IAAAA,WAAW,CAAC+B,GAAZ,CAAgBlB,WAAhB,EAA6BS,cAA7B,EAA6CL,IAA7C,CAAmDC,QAAD,IAAc;AAC9D,UAAIA,QAAJ,EAAc;AACZN,QAAAA,QAAQ,CAAC;AACPO,UAAAA,IAAI,EAAEb,oBADC;AAEPc,UAAAA,OAAO,EAAE;AAFF,SAAD,CAAR;AAIAY,QAAAA,UAAU,CAAC,MAAM;AACfpB,UAAAA,QAAQ,CAAC;AAAEO,YAAAA,IAAI,EAAEd;AAAR,WAAD,CAAR;AACD,SAFS,EAEP,IAFO,CAAV;AAGAsB,QAAAA,OAAO,CAACC,GAAR,CAAYV,QAAQ,CAACG,IAArB,EAA2B,0CAA3B;AACD,OATD,MASO;AACLT,QAAAA,QAAQ,CAAC;AACPO,UAAAA,IAAI,EAAEhB,kBADC;AAEPiB,UAAAA,OAAO,EAAE;AAFF,SAAD,CAAR;AAIAY,QAAAA,UAAU,CAAC,MAAM;AACfpB,UAAAA,QAAQ,CAAC;AAAEO,YAAAA,IAAI,EAAEf;AAAR,WAAD,CAAR;AACD,SAFS,EAEP,IAFO,CAAV;AAGD;AACF,KAnBD;AAoBD,GAvBD;AAwBD,CA1BM","sourcesContent":["import { callService } from '../_services/call.service';\nimport _ from 'lodash';\nimport {\n  GET_PERMISSION_SETTING,\n  SHOW_ERROR_MESSAGE,\n  HIDE_ERROR_MESSAGE,\n  HIDE_SUCCESS_MESSAGE,\n  SHOW_SUCCESS_MESSAGE,\n  GET_USER_PERMISSION\n} from '../constants/ActionTypes';\n\nexport const getPermissionSetting = (estabId) => {\n  let id = parseInt(estabId, 10);\n  return (dispatch) => {\n    let apiEndpoint = `/establishments/${id}/permission?access_token=${localStorage.token}`;\n\n    callService.get(apiEndpoint).then((response) => {\n      if (response) {\n         dispatch({ type: GET_PERMISSION_SETTING, payload: response.data.permissionList });\n      }\n    });\n  };\n};\nexport const getUserPermissions = (estabId,roleId) => {\n  let estab=6\n  let role= 7\n  // let id = parseInt(estabId, 10);\n  return (dispatch) => {\n    // let apiEndpoint = `/etab_role_permissions?access_token=${localStorage.token}?filter[where][and][0][fk_id_role]=${role}&filter[where][and][1][fk_id_etab]=${estab}&filter[include]=permission`;\n    // let apiEndpoint = `/etab_role_permissions?access_token=${localStorage.token}?filter[where][and][0][fk_id_etab]=77&filter[where][and][1][fk_id_role]=2`;\n    let apiEndpoint =  `/etab_role_permissions?access_token=${localStorage.token}&filter[where][and][0][fk_id_etab]=` +\n      estab+`&filter[where][and][1][fk_id_role]=`+role+`&filter[include]=permission`;\n    \n    callService.get(apiEndpoint).then((response) => {\n      if (response) {\n        console.log(response.data,'userrrrr permission');\n         dispatch({ type: GET_USER_PERMISSION, payload: response.data });\n      }\n    });\n  };\n};\nexport const applyPermissionSetting = (data) => {\n  let permissionList = { permissionRoleEtab: data };\n  return (dispatch) => {\n    let apiEndpoint = `/permissions/attributePermission?access_token=${localStorage.token}`;\n\n    callService.put(apiEndpoint, permissionList).then((response) => {\n      if (response) {\n        dispatch({\n          type: SHOW_SUCCESS_MESSAGE,\n          payload: \"L'affectation est effectuée avec succès\",\n        });\n        setTimeout(() => {\n          dispatch({ type: HIDE_SUCCESS_MESSAGE });\n        }, 4000);\n        console.log(response.data, 'response applyPermissionSetting response');\n      } else {\n        dispatch({\n          type: SHOW_ERROR_MESSAGE,\n          payload: \"Une erreur est survenue lors de l'affectation merci d'essayer à nouveau\",\n        });\n        setTimeout(() => {\n          dispatch({ type: HIDE_ERROR_MESSAGE });\n        }, 4000);\n      }\n    });\n  };\n};\n"]},"metadata":{},"sourceType":"module"}