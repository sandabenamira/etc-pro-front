{"ast":null,"code":"import { classService } from '../_services/class.service';\nimport { FETECHED_ALL_SERVICES, ADD_SERVICE, EDIT_SERVICE, DELETE_SERVICE, SHOW_ERROR_MESSAGE, HIDE_ERROR_MESSAGE, HIDE_SUCCESS_MESSAGE, SHOW_SUCCESS_MESSAGE, FETECHED_ALL_SERVICES_ARCHIVES, FETECHED_ALL_SERVICES_V2 } from '../constants/ActionTypes';\nimport baseUrl from '../config/config';\nimport axios from 'axios';\nimport _ from 'lodash';\nexport const addService = itemService => {\n  //1\n  return dispatch => {\n    let apiEndpoint = `/services?access_token=${localStorage.token}`;\n    classService.post(apiEndpoint, itemService).then(response => {\n      if (response) {\n        dispatch({\n          type: ADD_SERVICE,\n          payload: response.data\n        });\n        dispatch({\n          type: SHOW_SUCCESS_MESSAGE,\n          payload: 'La création est effectuée avec succès'\n        });\n        setTimeout(() => {\n          dispatch({\n            type: HIDE_SUCCESS_MESSAGE\n          });\n        }, 4000);\n      } else {\n        dispatch({\n          type: SHOW_ERROR_MESSAGE,\n          payload: \"Une erreur est survenue lors de la création merci d'essayer à nouveau\"\n        });\n        setTimeout(() => {\n          dispatch({\n            type: HIDE_ERROR_MESSAGE\n          });\n        }, 4000);\n      }\n    });\n  };\n};\nexport function getServiceV2(idEstablishment, idSchoolYear) {\n  return dispatch => {\n    let apiEndpoint = `/service_v2?access_token=${localStorage.token}&filter[where][and][0][fk_id_establishment]=${idEstablishment}&filter[where][and][1][fk_id_school_year]=${idSchoolYear}&filter[include]=currencyV2&filter[include]=frequencyV2&filter[include]=schoolYear`;\n    classService.get(apiEndpoint).then(response => {\n      if (response) {\n        const list = response.data;\n        console.log(list, 'list serviiiiiiice');\n        const serviceList = list.filter(element => element.status_service && element.fk_id_school_year == idSchoolYear);\n        const serviceListArchive = list.filter(element => element.status_service === false && element.fk_id_school_year == idSchoolYear);\n        dispatch({\n          type: FETECHED_ALL_SERVICES_V2,\n          payload: serviceList\n        });\n        dispatch({\n          type: FETECHED_ALL_SERVICES_ARCHIVES,\n          payload: serviceListArchive\n        });\n      }\n    });\n  };\n}\nexport function addServiceV2(itemService) {\n  return dispatch => {\n    let apiEndpoint = `/service_v2?access_token=${localStorage.token}`;\n    classService.post(apiEndpoint, itemService).then(response => {\n      if (_.isEmpty(response.data)) {\n        dispatch({\n          type: SHOW_ERROR_MESSAGE,\n          payload: \"Une erreur est survenue lors de la création merci d'essayer à nouveau\"\n        });\n        setTimeout(() => {\n          dispatch({\n            type: HIDE_ERROR_MESSAGE\n          });\n        }, 4000);\n      } else {\n        dispatch(getServiceV2(itemService.fk_id_establishment, itemService.fk_id_school_year));\n        dispatch({\n          type: SHOW_SUCCESS_MESSAGE,\n          payload: 'La création est effectuée avec succès'\n        });\n        setTimeout(() => {\n          dispatch({\n            type: HIDE_SUCCESS_MESSAGE\n          });\n        }, 4000);\n      }\n    }).catch(error => {});\n  };\n}\nexport const getServices = () => {\n  return dispatch => {\n    let apiEndpoint = `/services?access_token=${localStorage.token}`;\n    classService.get(apiEndpoint).then(response => {\n      const list = response.data;\n      const serviceList = list.filter(element => element.status);\n      dispatch({\n        type: FETECHED_ALL_SERVICES,\n        payload: serviceList\n      });\n    }).catch(err => {});\n  };\n};\nexport const getServicesByEstablishmentId = establishmentId => {\n  return dispatch => {\n    let apiEndpoint = `/services?access_token=${localStorage.token}&filter[where][establishment_id]=` + establishmentId;\n    classService.get(apiEndpoint).then(response => {\n      const list = response.data;\n      const serviceList = list.filter(element => element.status);\n      dispatch({\n        type: FETECHED_ALL_SERVICES,\n        payload: serviceList\n      });\n    }).catch(err => {});\n  };\n};\nexport function deleteServices(itemId) {\n  return dispatch => {\n    let apiEndpoint = `/services/` + itemId + `?access_token=${localStorage.token}`;\n    classService.get(apiEndpoint).then(response => {\n      const dataService = response.data;\n      let serviceData = {\n        name: dataService.name,\n        details: dataService.details,\n        start_date: dataService.start_date,\n        end_date: dataService.end_date,\n        price: dataService.price,\n        price_ttc: dataService.price_ttc,\n        tva: dataService.tva,\n        currency: dataService.currency,\n        payment_periodicity: dataService.payment_periodicity,\n        note: dataService.note,\n        status: false,\n        id: dataService.id,\n        establishment_id: dataService.establishment_id\n      };\n      let apiEndpoint2 = `/services/` + dataService.id + `?access_token=${localStorage.token}`;\n      classService.put(apiEndpoint2, serviceData).then(response => {\n        dispatch({\n          type: DELETE_SERVICE,\n          payload: response.data\n        });\n      }).catch(error => {});\n    }).catch(error => {});\n  };\n}\nexport function editService(dataService) {\n  return dispatch => {\n    let serviceData = {\n      name: dataService.name,\n      details: dataService.details,\n      start_date: dataService.start_date,\n      end_date: dataService.end_date,\n      price: dataService.price,\n      price_ttc: dataService.price_ttc,\n      tva: dataService.tva,\n      currency: dataService.currency,\n      payment_periodicity: dataService.payment_periodicity,\n      note: dataService.note,\n      status: true,\n      id: dataService.id,\n      establishment_id: dataService.establishment_id\n    };\n    let apiEndpoint = `/services/` + dataService.id + `?access_token=${localStorage.token}`;\n    classService.put(apiEndpoint, serviceData).then(response => {\n      if (response) {\n        dispatch({\n          type: EDIT_SERVICE,\n          payload: response.data\n        });\n        dispatch({\n          type: SHOW_SUCCESS_MESSAGE,\n          payload: 'La modification est effectuée avec succès'\n        });\n        setTimeout(() => {\n          dispatch({\n            type: HIDE_SUCCESS_MESSAGE\n          });\n        }, 4000);\n      } else {\n        dispatch({\n          type: SHOW_ERROR_MESSAGE,\n          payload: \"Une erreur est survenue lors de la modification merci d'essayer à nouveau\"\n        });\n        setTimeout(() => {\n          dispatch({\n            type: HIDE_ERROR_MESSAGE\n          });\n        }, 4000);\n      }\n    });\n  };\n}\nexport function editServiceV2(itemService) {\n  return dispatch => {\n    let apiEndpoint = `/service_v2/` + itemService.id + `?access_token=${localStorage.token}`;\n    classService.put(apiEndpoint, itemService).then(response => {\n      if (_.isEmpty(response.data)) {\n        dispatch({\n          type: SHOW_ERROR_MESSAGE,\n          payload: \"Une erreur est survenue lors de la modification merci d'essayer à nouveau\"\n        });\n        setTimeout(() => {\n          dispatch({\n            type: HIDE_ERROR_MESSAGE\n          });\n        }, 4000);\n      } else {\n        dispatch(getServiceV2(itemService.fk_id_establishment, itemService.fk_id_school_year));\n        dispatch({\n          type: SHOW_SUCCESS_MESSAGE,\n          payload: 'La modification est effectuée avec succès'\n        });\n        setTimeout(() => {\n          dispatch({\n            type: HIDE_SUCCESS_MESSAGE\n          });\n        }, 4000);\n      }\n    }).catch(error => {});\n  };\n}\nexport function deleteServiceV2(itemId) {\n  return dispatch => {\n    axios.patch(`${baseUrl.baseUrl}/service_v2/` + itemId + `?access_token=${localStorage.token}`, {\n      status_service: false\n    }).then(response => {\n      dispatch(getServiceV2(response.data.fk_id_establishment, response.data.fk_id_school_year));\n      dispatch({\n        type: SHOW_SUCCESS_MESSAGE,\n        payload: \"L'archivage  est effectuée avec succès\"\n      });\n      setTimeout(() => {\n        dispatch({\n          type: HIDE_SUCCESS_MESSAGE\n        });\n      }, 4000);\n    }).catch(function (error) {\n      dispatch({\n        type: SHOW_ERROR_MESSAGE,\n        payload: \"Une erreur est survenue lors de l'archivage merci d'essayer à nouveau\"\n      });\n      setTimeout(() => {\n        dispatch({\n          type: HIDE_ERROR_MESSAGE\n        });\n      }, 4000);\n    });\n  };\n}\nexport function publishServiceV2(itemId) {\n  return dispatch => {\n    axios.patch(`${baseUrl.baseUrl}/service_v2/` + itemId + `?access_token=${localStorage.token}`, {\n      status_service: true\n    }).then(response => {\n      dispatch(getServiceV2(response.data.fk_id_establishment));\n      dispatch({\n        type: SHOW_SUCCESS_MESSAGE,\n        payload: 'Prestation est publiée avec succès'\n      });\n      setTimeout(() => {\n        dispatch({\n          type: HIDE_SUCCESS_MESSAGE\n        });\n      }, 4000);\n    }).catch(function (error) {\n      dispatch({\n        type: SHOW_ERROR_MESSAGE,\n        payload: \"Une erreur est survenue lors de cette action merci d'essayer à nouveau\"\n      });\n      setTimeout(() => {\n        dispatch({\n          type: HIDE_ERROR_MESSAGE\n        });\n      }, 4000);\n    });\n  };\n}\nexport const serviceAction = {\n  addService,\n  getServices,\n  deleteServices,\n  getServicesByEstablishmentId,\n  deleteServiceV2,\n  publishServiceV2\n};","map":{"version":3,"sources":["/home/oem/Documents/projects/educap/classebook-front-web/src/actions/ServiceAction.js"],"names":["classService","FETECHED_ALL_SERVICES","ADD_SERVICE","EDIT_SERVICE","DELETE_SERVICE","SHOW_ERROR_MESSAGE","HIDE_ERROR_MESSAGE","HIDE_SUCCESS_MESSAGE","SHOW_SUCCESS_MESSAGE","FETECHED_ALL_SERVICES_ARCHIVES","FETECHED_ALL_SERVICES_V2","baseUrl","axios","_","addService","itemService","dispatch","apiEndpoint","localStorage","token","post","then","response","type","payload","data","setTimeout","getServiceV2","idEstablishment","idSchoolYear","get","list","console","log","serviceList","filter","element","status_service","fk_id_school_year","serviceListArchive","addServiceV2","isEmpty","fk_id_establishment","catch","error","getServices","status","err","getServicesByEstablishmentId","establishmentId","deleteServices","itemId","dataService","serviceData","name","details","start_date","end_date","price","price_ttc","tva","currency","payment_periodicity","note","id","establishment_id","apiEndpoint2","put","editService","editServiceV2","deleteServiceV2","patch","publishServiceV2","serviceAction"],"mappings":"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","sourcesContent":["import { classService } from '../_services/class.service';\nimport {\n  FETECHED_ALL_SERVICES,\n  ADD_SERVICE,\n  EDIT_SERVICE,\n  DELETE_SERVICE,\n  SHOW_ERROR_MESSAGE,\n  HIDE_ERROR_MESSAGE,\n  HIDE_SUCCESS_MESSAGE,\n  SHOW_SUCCESS_MESSAGE,\n  FETECHED_ALL_SERVICES_ARCHIVES,\n  FETECHED_ALL_SERVICES_V2,\n} from '../constants/ActionTypes';\nimport baseUrl from '../config/config';\nimport axios from 'axios';\nimport _ from 'lodash';\n\nexport const addService = (itemService) => {\n  //1\n  return (dispatch) => {\n    let apiEndpoint = `/services?access_token=${localStorage.token}`;\n    classService.post(apiEndpoint, itemService).then((response) => {\n      if (response) {\n        dispatch({ type: ADD_SERVICE, payload: response.data });\n        dispatch({\n          type: SHOW_SUCCESS_MESSAGE,\n          payload: 'La création est effectuée avec succès',\n        });\n        setTimeout(() => {\n          dispatch({ type: HIDE_SUCCESS_MESSAGE });\n        }, 4000);\n      } else {\n        dispatch({\n          type: SHOW_ERROR_MESSAGE,\n          payload: \"Une erreur est survenue lors de la création merci d'essayer à nouveau\",\n        });\n        setTimeout(() => {\n          dispatch({ type: HIDE_ERROR_MESSAGE });\n        }, 4000);\n      }\n    });\n  };\n};\n\nexport function getServiceV2(idEstablishment, idSchoolYear) {\n  return (dispatch) => {\n    let apiEndpoint = `/service_v2?access_token=${localStorage.token}&filter[where][and][0][fk_id_establishment]=${idEstablishment}&filter[where][and][1][fk_id_school_year]=${idSchoolYear}&filter[include]=currencyV2&filter[include]=frequencyV2&filter[include]=schoolYear`;\n    classService.get(apiEndpoint).then((response) => {\n      if (response) {\n        const list = response.data;\n        console.log(list, 'list serviiiiiiice');\n        const serviceList = list.filter(\n          (element) => element.status_service && element.fk_id_school_year == idSchoolYear\n        );\n        const serviceListArchive = list.filter(\n          (element) => element.status_service === false && element.fk_id_school_year == idSchoolYear\n        );\n\n        dispatch({ type: FETECHED_ALL_SERVICES_V2, payload: serviceList });\n        dispatch({\n          type: FETECHED_ALL_SERVICES_ARCHIVES,\n          payload: serviceListArchive,\n        });\n      }\n    });\n  };\n}\nexport function addServiceV2(itemService) {\n\n  return (dispatch) => {\n    let apiEndpoint = `/service_v2?access_token=${localStorage.token}`;\n    classService\n      .post(apiEndpoint, itemService)\n      .then((response) => {\n        if (_.isEmpty(response.data)) {\n          dispatch({\n            type: SHOW_ERROR_MESSAGE,\n            payload: \"Une erreur est survenue lors de la création merci d'essayer à nouveau\",\n          });\n          setTimeout(() => {\n            dispatch({ type: HIDE_ERROR_MESSAGE });\n          }, 4000);\n        } else {\n          dispatch(getServiceV2(itemService.fk_id_establishment, itemService.fk_id_school_year));\n          dispatch({\n            type: SHOW_SUCCESS_MESSAGE,\n            payload: 'La création est effectuée avec succès',\n          });\n          setTimeout(() => {\n            dispatch({ type: HIDE_SUCCESS_MESSAGE });\n          }, 4000);\n        }\n      })\n      .catch((error) => {});\n  };\n}\n\nexport const getServices = () => {\n  return (dispatch) => {\n    let apiEndpoint = `/services?access_token=${localStorage.token}`;\n    classService\n      .get(apiEndpoint)\n      .then((response) => {\n        const list = response.data;\n        const serviceList = list.filter((element) => element.status);\n        dispatch({ type: FETECHED_ALL_SERVICES, payload: serviceList });\n      })\n      .catch((err) => {});\n  };\n};\n\nexport const getServicesByEstablishmentId = (establishmentId) => {\n  return (dispatch) => {\n    let apiEndpoint =\n      `/services?access_token=${localStorage.token}&filter[where][establishment_id]=` +\n      establishmentId;\n    classService\n      .get(apiEndpoint)\n      .then((response) => {\n        const list = response.data;\n        const serviceList = list.filter((element) => element.status);\n\n        dispatch({ type: FETECHED_ALL_SERVICES, payload: serviceList });\n      })\n      .catch((err) => {});\n  };\n};\n\nexport function deleteServices(itemId) {\n  return (dispatch) => {\n    let apiEndpoint = `/services/` + itemId + `?access_token=${localStorage.token}`;\n    classService\n      .get(apiEndpoint)\n      .then((response) => {\n        const dataService = response.data;\n        let serviceData = {\n          name: dataService.name,\n          details: dataService.details,\n          start_date: dataService.start_date,\n          end_date: dataService.end_date,\n          price: dataService.price,\n          price_ttc: dataService.price_ttc,\n          tva: dataService.tva,\n          currency: dataService.currency,\n          payment_periodicity: dataService.payment_periodicity,\n          note: dataService.note,\n          status: false,\n          id: dataService.id,\n          establishment_id: dataService.establishment_id,\n        };\n        let apiEndpoint2 = `/services/` + dataService.id + `?access_token=${localStorage.token}`;\n        classService\n          .put(apiEndpoint2, serviceData)\n\n          .then((response) => {\n            dispatch({ type: DELETE_SERVICE, payload: response.data });\n          })\n          .catch((error) => {});\n      })\n      .catch((error) => {});\n  };\n}\n\nexport function editService(dataService) {\n  return (dispatch) => {\n    let serviceData = {\n      name: dataService.name,\n      details: dataService.details,\n      start_date: dataService.start_date,\n      end_date: dataService.end_date,\n      price: dataService.price,\n      price_ttc: dataService.price_ttc,\n      tva: dataService.tva,\n      currency: dataService.currency,\n      payment_periodicity: dataService.payment_periodicity,\n      note: dataService.note,\n      status: true,\n      id: dataService.id,\n      establishment_id: dataService.establishment_id,\n    };\n    let apiEndpoint = `/services/` + dataService.id + `?access_token=${localStorage.token}`;\n    classService.put(apiEndpoint, serviceData).then((response) => {\n      if (response) {\n        dispatch({ type: EDIT_SERVICE, payload: response.data });\n        dispatch({\n          type: SHOW_SUCCESS_MESSAGE,\n          payload: 'La modification est effectuée avec succès',\n        });\n        setTimeout(() => {\n          dispatch({ type: HIDE_SUCCESS_MESSAGE });\n        }, 4000);\n      } else {\n        dispatch({\n          type: SHOW_ERROR_MESSAGE,\n          payload: \"Une erreur est survenue lors de la modification merci d'essayer à nouveau\",\n        });\n        setTimeout(() => {\n          dispatch({ type: HIDE_ERROR_MESSAGE });\n        }, 4000);\n      }\n    });\n  };\n}\n\nexport function editServiceV2(itemService) {\n  return (dispatch) => {\n    let apiEndpoint = `/service_v2/` + itemService.id + `?access_token=${localStorage.token}`;\n    classService\n      .put(apiEndpoint, itemService)\n      .then((response) => {\n        if (_.isEmpty(response.data)) {\n          dispatch({\n            type: SHOW_ERROR_MESSAGE,\n            payload: \"Une erreur est survenue lors de la modification merci d'essayer à nouveau\",\n          });\n          setTimeout(() => {\n            dispatch({ type: HIDE_ERROR_MESSAGE });\n          }, 4000);\n        } else {\n          dispatch(getServiceV2(itemService.fk_id_establishment, itemService.fk_id_school_year));\n          dispatch({\n            type: SHOW_SUCCESS_MESSAGE,\n            payload: 'La modification est effectuée avec succès',\n          });\n          setTimeout(() => {\n            dispatch({ type: HIDE_SUCCESS_MESSAGE });\n          }, 4000);\n        }\n      })\n      .catch((error) => {});\n  };\n}\n\nexport function deleteServiceV2(itemId) {\n  return (dispatch) => {\n    axios\n      .patch(`${baseUrl.baseUrl}/service_v2/` + itemId + `?access_token=${localStorage.token}`, {\n        status_service: false,\n      })\n      .then((response) => {\n        dispatch(getServiceV2(response.data.fk_id_establishment, response.data.fk_id_school_year));\n        dispatch({\n          type: SHOW_SUCCESS_MESSAGE,\n          payload: \"L'archivage  est effectuée avec succès\",\n        });\n        setTimeout(() => {\n          dispatch({ type: HIDE_SUCCESS_MESSAGE });\n        }, 4000);\n      })\n      .catch(function(error) {\n        dispatch({\n          type: SHOW_ERROR_MESSAGE,\n          payload: \"Une erreur est survenue lors de l'archivage merci d'essayer à nouveau\",\n        });\n        setTimeout(() => {\n          dispatch({ type: HIDE_ERROR_MESSAGE });\n        }, 4000);\n      });\n  };\n}\n\nexport function publishServiceV2(itemId) {\n  return (dispatch) => {\n    axios\n      .patch(`${baseUrl.baseUrl}/service_v2/` + itemId + `?access_token=${localStorage.token}`, {\n        status_service: true,\n      })\n      .then((response) => {\n        dispatch(getServiceV2(response.data.fk_id_establishment));\n        dispatch({\n          type: SHOW_SUCCESS_MESSAGE,\n          payload: 'Prestation est publiée avec succès',\n        });\n        setTimeout(() => {\n          dispatch({ type: HIDE_SUCCESS_MESSAGE });\n        }, 4000);\n      })\n      .catch(function(error) {\n        dispatch({\n          type: SHOW_ERROR_MESSAGE,\n          payload: \"Une erreur est survenue lors de cette action merci d'essayer à nouveau\",\n        });\n        setTimeout(() => {\n          dispatch({ type: HIDE_ERROR_MESSAGE });\n        }, 4000);\n      });\n  };\n}\n\nexport const serviceAction = {\n  addService,\n  getServices,\n  deleteServices,\n  getServicesByEstablishmentId,\n  deleteServiceV2,\n  publishServiceV2,\n};\n"]},"metadata":{},"sourceType":"module"}