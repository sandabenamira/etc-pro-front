{"ast":null,"code":"var _jsxFileName = \"/home/oem/Documents/projects/educap-pro/educap-pro-front/src/containers/Navigation/NavCollapse.js\";\nimport React, { useEffect } from 'react';\nimport { Collapse, List, ListItem } from '@material-ui/core';\nimport IconExpandLess from '@material-ui/icons/ExpandLess';\nimport IconExpandMore from '@material-ui/icons/ExpandMore';\nimport { useHistory } from 'react-router-dom';\nimport IntlMessages from '../../util/IntlMessages';\nimport NavSection from './NavSection';\nimport NavMenuItem from './NavMenuItem';\nimport { RoleContext } from '../../Context';\nimport Can from '../../can';\n\nconst NavCollapse = props => {\n  const history = useHistory();\n  const {\n    name,\n    icon,\n    children = []\n  } = props;\n  const isExpandable = children && children.length > 0;\n  const [open, setOpen] = React.useState(false);\n  useEffect(() => {\n    if (isUrlInChildren(props, history.location.pathname)) {\n      setOpen(true);\n    } else {\n      setOpen(false);\n    }\n  }, []);\n\n  function handleClick() {\n    setOpen(!open);\n  }\n\n  history.listen((location, action) => {\n    if (isUrlInChildren(props, location.pathname)) {\n      setOpen(true);\n    } else {\n      setOpen(false);\n    }\n  });\n  /**\r\n   * Check if the given url can be found\r\n   * in one of the given parent's children\r\n   *\r\n   * @param parent\r\n   * @param url\r\n   * @returns {boolean}\r\n   */\n\n  function isUrlInChildren(parent, url) {\n    if (!parent.children) {\n      return false;\n    }\n\n    for (let i = 0; i < parent.children.length; i++) {\n      if (parent.children[i].children) {\n        if (isUrlInChildren(parent.children[i], url)) {\n          return true;\n        }\n      }\n\n      if (parent.children[i].link === url || url.includes(parent.children[i].link)) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  const MenuCollapse = /*#__PURE__*/React.createElement(RoleContext.Consumer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 5\n    }\n  }, ({\n    role\n  }) => /*#__PURE__*/React.createElement(Can, {\n    role: role,\n    perform: `module-nav-${name}`,\n    yes: () => /*#__PURE__*/React.createElement(ListItem, {\n      className: \"nav-collapse-btn\",\n      button: true,\n      onClick: handleClick,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 13\n      }\n    }, !!icon && /*#__PURE__*/React.createElement(\"i\", {\n      className: 'zmdi zmdi-hc-fw  zmdi-' + icon,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 26\n      }\n    }), /*#__PURE__*/React.createElement(\"span\", {\n      className: \"nav-text\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(IntlMessages, {\n      id: `sidebar.components.${props.name}`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 17\n      }\n    })), isExpandable && !open && /*#__PURE__*/React.createElement(IconExpandMore, {\n      className: \"nav-arrow\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 41\n      }\n    }), isExpandable && open && /*#__PURE__*/React.createElement(IconExpandLess, {\n      className: \"nav-arrow\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 40\n      }\n    })),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 9\n    }\n  }));\n  const MenuItemChildren = isExpandable ? /*#__PURE__*/React.createElement(Collapse, {\n    className: \"nav-collapse-item\",\n    in: open,\n    timeout: \"auto\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(List, {\n    component: \"div\",\n    disablePadding: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 7\n    }\n  }, children.map((item, index) => /*#__PURE__*/React.createElement(RoleContext.Consumer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 11\n    }\n  }, ({\n    role\n  }) => /*#__PURE__*/React.createElement(Can, {\n    role: role,\n    perform: `module-nav-${name}`,\n    yes: () => {\n      switch (item.type) {\n        case 'section':\n          return /*#__PURE__*/React.createElement(NavSection, Object.assign({}, item, {\n            key: index,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 103,\n              columnNumber: 30\n            }\n          }));\n\n        case 'collapse':\n          return /*#__PURE__*/React.createElement(NavCollapse, Object.assign({}, item, {\n            key: index,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 105,\n              columnNumber: 30\n            }\n          }));\n\n        case 'item':\n          return /*#__PURE__*/React.createElement(NavMenuItem, Object.assign({}, item, {\n            key: index,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 107,\n              columnNumber: 30\n            }\n          }));\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 15\n    }\n  }))))) : null;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: `nav-collapse ${open ? 'open' : 'open'}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 5\n    }\n  }, MenuCollapse, MenuItemChildren);\n};\n\nexport default NavCollapse;","map":{"version":3,"sources":["/home/oem/Documents/projects/educap-pro/educap-pro-front/src/containers/Navigation/NavCollapse.js"],"names":["React","useEffect","Collapse","List","ListItem","IconExpandLess","IconExpandMore","useHistory","IntlMessages","NavSection","NavMenuItem","RoleContext","Can","NavCollapse","props","history","name","icon","children","isExpandable","length","open","setOpen","useState","isUrlInChildren","location","pathname","handleClick","listen","action","parent","url","i","link","includes","MenuCollapse","role","MenuItemChildren","map","item","index","type"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,QAAT,EAAmBC,IAAnB,EAAyBC,QAAzB,QAAyC,mBAAzC;AACA,OAAOC,cAAP,MAA2B,+BAA3B;AACA,OAAOC,cAAP,MAA2B,+BAA3B;AACA,SAASC,UAAT,QAA2B,kBAA3B;AAEA,OAAOC,YAAP,MAAyB,yBAAzB;AACA,OAAOC,UAAP,MAAuB,cAAvB;AACA,OAAOC,WAAP,MAAwB,eAAxB;AACA,SAASC,WAAT,QAA4B,eAA5B;AACA,OAAOC,GAAP,MAAgB,WAAhB;;AAEA,MAAMC,WAAW,GAAIC,KAAD,IAAW;AAC7B,QAAMC,OAAO,GAAGR,UAAU,EAA1B;AAEA,QAAM;AAAES,IAAAA,IAAF;AAAQC,IAAAA,IAAR;AAAcC,IAAAA,QAAQ,GAAG;AAAzB,MAAgCJ,KAAtC;AACA,QAAMK,YAAY,GAAGD,QAAQ,IAAIA,QAAQ,CAACE,MAAT,GAAkB,CAAnD;AACA,QAAM,CAACC,IAAD,EAAOC,OAAP,IAAkBtB,KAAK,CAACuB,QAAN,CAAe,KAAf,CAAxB;AAEAtB,EAAAA,SAAS,CAAC,MAAM;AACd,QAAIuB,eAAe,CAACV,KAAD,EAAQC,OAAO,CAACU,QAAR,CAAiBC,QAAzB,CAAnB,EAAuD;AACrDJ,MAAAA,OAAO,CAAC,IAAD,CAAP;AACD,KAFD,MAEO;AACLA,MAAAA,OAAO,CAAC,KAAD,CAAP;AACD;AACF,GANQ,EAMN,EANM,CAAT;;AAQA,WAASK,WAAT,GAAuB;AACrBL,IAAAA,OAAO,CAAC,CAACD,IAAF,CAAP;AACD;;AAEDN,EAAAA,OAAO,CAACa,MAAR,CAAe,CAACH,QAAD,EAAWI,MAAX,KAAsB;AACnC,QAAIL,eAAe,CAACV,KAAD,EAAQW,QAAQ,CAACC,QAAjB,CAAnB,EAA+C;AAC7CJ,MAAAA,OAAO,CAAC,IAAD,CAAP;AACD,KAFD,MAEO;AACLA,MAAAA,OAAO,CAAC,KAAD,CAAP;AACD;AACF,GAND;AAQA;;;;;;;;;AAQA,WAASE,eAAT,CAAyBM,MAAzB,EAAiCC,GAAjC,EAAsC;AACpC,QAAI,CAACD,MAAM,CAACZ,QAAZ,EAAsB;AACpB,aAAO,KAAP;AACD;;AAED,SAAK,IAAIc,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,MAAM,CAACZ,QAAP,CAAgBE,MAApC,EAA4CY,CAAC,EAA7C,EAAiD;AAC/C,UAAIF,MAAM,CAACZ,QAAP,CAAgBc,CAAhB,EAAmBd,QAAvB,EAAiC;AAC/B,YAAIM,eAAe,CAACM,MAAM,CAACZ,QAAP,CAAgBc,CAAhB,CAAD,EAAqBD,GAArB,CAAnB,EAA8C;AAC5C,iBAAO,IAAP;AACD;AACF;;AAED,UAAID,MAAM,CAACZ,QAAP,CAAgBc,CAAhB,EAAmBC,IAAnB,KAA4BF,GAA5B,IAAmCA,GAAG,CAACG,QAAJ,CAAaJ,MAAM,CAACZ,QAAP,CAAgBc,CAAhB,EAAmBC,IAAhC,CAAvC,EAA8E;AAC5E,eAAO,IAAP;AACD;AACF;;AAED,WAAO,KAAP;AACD;;AAED,QAAME,YAAY,gBAChB,oBAAC,WAAD,CAAa,QAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACG,CAAC;AAAEC,IAAAA;AAAF,GAAD,kBACC,oBAAC,GAAD;AACE,IAAA,IAAI,EAAEA,IADR;AAEE,IAAA,OAAO,EAAG,cAAapB,IAAK,EAF9B;AAGE,IAAA,GAAG,EAAE,mBACH,oBAAC,QAAD;AAAU,MAAA,SAAS,EAAC,kBAApB;AAAuC,MAAA,MAAM,MAA7C;AAA8C,MAAA,OAAO,EAAEW,WAAvD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACG,CAAC,CAACV,IAAF,iBAAU;AAAG,MAAA,SAAS,EAAE,2BAA2BA,IAAzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADb,eAEE;AAAM,MAAA,SAAS,EAAC,UAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,YAAD;AAAc,MAAA,EAAE,EAAG,sBAAqBH,KAAK,CAACE,IAAK,EAAnD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CAFF,EAOGG,YAAY,IAAI,CAACE,IAAjB,iBAAyB,oBAAC,cAAD;AAAgB,MAAA,SAAS,EAAC,WAA1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAP5B,EAQGF,YAAY,IAAIE,IAAhB,iBAAwB,oBAAC,cAAD;AAAgB,MAAA,SAAS,EAAC,WAA1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAR3B,CAJJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFJ,CADF;AAuBA,QAAMgB,gBAAgB,GAAGlB,YAAY,gBACnC,oBAAC,QAAD;AAAU,IAAA,SAAS,EAAC,mBAApB;AAAwC,IAAA,EAAE,EAAEE,IAA5C;AAAkD,IAAA,OAAO,EAAC,MAA1D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,IAAD;AAAM,IAAA,SAAS,EAAC,KAAhB;AAAsB,IAAA,cAAc,MAApC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGH,QAAQ,CAACoB,GAAT,CAAa,CAACC,IAAD,EAAOC,KAAP,kBACZ,oBAAC,WAAD,CAAa,QAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACG,CAAC;AAAEJ,IAAAA;AAAF,GAAD,kBACC,oBAAC,GAAD;AACE,IAAA,IAAI,EAAEA,IADR;AAEE,IAAA,OAAO,EAAG,cAAapB,IAAK,EAF9B;AAGE,IAAA,GAAG,EAAE,MAAM;AACT,cAAQuB,IAAI,CAACE,IAAb;AACE,aAAK,SAAL;AACE,8BAAO,oBAAC,UAAD,oBAAgBF,IAAhB;AAAsB,YAAA,GAAG,EAAEC,KAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAAP;;AACF,aAAK,UAAL;AACE,8BAAO,oBAAC,WAAD,oBAAiBD,IAAjB;AAAuB,YAAA,GAAG,EAAEC,KAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAAP;;AACF,aAAK,MAAL;AACE,8BAAO,oBAAC,WAAD,oBAAiBD,IAAjB;AAAuB,YAAA,GAAG,EAAEC,KAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAAP;AANJ;AAQD,KAZH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFJ,CADD,CADH,CADF,CADmC,GAyBjC,IAzBJ;AA2BA,sBACE;AAAK,IAAA,SAAS,EAAG,gBAAenB,IAAI,GAAG,MAAH,GAAY,MAAO,EAAvD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGc,YADH,EAEGE,gBAFH,CADF;AAMD,CA/GD;;AAiHA,eAAexB,WAAf","sourcesContent":["import React, { useEffect } from 'react';\r\nimport { Collapse, List, ListItem } from '@material-ui/core';\r\nimport IconExpandLess from '@material-ui/icons/ExpandLess';\r\nimport IconExpandMore from '@material-ui/icons/ExpandMore';\r\nimport { useHistory } from 'react-router-dom';\r\n\r\nimport IntlMessages from '../../util/IntlMessages';\r\nimport NavSection from './NavSection';\r\nimport NavMenuItem from './NavMenuItem';\r\nimport { RoleContext } from '../../Context';\r\nimport Can from '../../can';\r\n\r\nconst NavCollapse = (props) => {\r\n  const history = useHistory();\r\n\r\n  const { name, icon, children = [] } = props;\r\n  const isExpandable = children && children.length > 0;\r\n  const [open, setOpen] = React.useState(false);\r\n\r\n  useEffect(() => {\r\n    if (isUrlInChildren(props, history.location.pathname)) {\r\n      setOpen(true);\r\n    } else {\r\n      setOpen(false);\r\n    }\r\n  }, []);\r\n\r\n  function handleClick() {\r\n    setOpen(!open);\r\n  }\r\n\r\n  history.listen((location, action) => {\r\n    if (isUrlInChildren(props, location.pathname)) {\r\n      setOpen(true);\r\n    } else {\r\n      setOpen(false);\r\n    }\r\n  });\r\n\r\n  /**\r\n   * Check if the given url can be found\r\n   * in one of the given parent's children\r\n   *\r\n   * @param parent\r\n   * @param url\r\n   * @returns {boolean}\r\n   */\r\n  function isUrlInChildren(parent, url) {\r\n    if (!parent.children) {\r\n      return false;\r\n    }\r\n\r\n    for (let i = 0; i < parent.children.length; i++) {\r\n      if (parent.children[i].children) {\r\n        if (isUrlInChildren(parent.children[i], url)) {\r\n          return true;\r\n        }\r\n      }\r\n\r\n      if (parent.children[i].link === url || url.includes(parent.children[i].link)) {\r\n        return true;\r\n      }\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  const MenuCollapse = (\r\n    <RoleContext.Consumer>\r\n      {({ role }) => (\r\n        <Can\r\n          role={role}\r\n          perform={`module-nav-${name}`}\r\n          yes={() => (\r\n            <ListItem className=\"nav-collapse-btn\" button onClick={handleClick}>\r\n              {!!icon && <i className={'zmdi zmdi-hc-fw  zmdi-' + icon} />}\r\n              <span className=\"nav-text\">\r\n                <IntlMessages id={`sidebar.components.${props.name}`} />\r\n              </span>\r\n\r\n              {/* Display the expand menu if the item has children */}\r\n              {isExpandable && !open && <IconExpandMore className=\"nav-arrow\" />}\r\n              {isExpandable && open && <IconExpandLess className=\"nav-arrow\" />}\r\n            </ListItem>\r\n          )}\r\n        />\r\n      )}\r\n    </RoleContext.Consumer>\r\n  );\r\n\r\n  const MenuItemChildren = isExpandable ? (\r\n    <Collapse className=\"nav-collapse-item\" in={open} timeout=\"auto\">\r\n      <List component=\"div\" disablePadding>\r\n        {children.map((item, index) => (\r\n          <RoleContext.Consumer>\r\n            {({ role }) => (\r\n              <Can\r\n                role={role}\r\n                perform={`module-nav-${name}`}\r\n                yes={() => {\r\n                  switch (item.type) {\r\n                    case 'section':\r\n                      return <NavSection {...item} key={index} />;\r\n                    case 'collapse':\r\n                      return <NavCollapse {...item} key={index} />;\r\n                    case 'item':\r\n                      return <NavMenuItem {...item} key={index} />;\r\n                  }\r\n                }}\r\n              />\r\n            )}\r\n          </RoleContext.Consumer>\r\n        ))}\r\n      </List>\r\n    </Collapse>\r\n  ) : null;\r\n\r\n  return (\r\n    <div className={`nav-collapse ${open ? 'open' : 'open'}`}>\r\n      {MenuCollapse}\r\n      {MenuItemChildren}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NavCollapse;\r\n"]},"metadata":{},"sourceType":"module"}