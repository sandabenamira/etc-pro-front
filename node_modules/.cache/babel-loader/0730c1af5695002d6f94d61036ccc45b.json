{"ast":null,"code":"import { classService } from \"../_services/class.service\";\nimport { SHOW_SUCCESS_MESSAGE, HIDE_SUCCESS_MESSAGE, SHOW_ERROR_MESSAGE, HIDE_ERROR_MESSAGE, GET_LEVELS, ADD_LEVELS, EDIT_LEVELS, DELETE_LEVELS, ARCHIVED_GET_LEVELS } from \"../constants/ActionTypes\";\nexport function addlevel(data) {\n  return dispatch => {\n    let apiEndpoint = `/level_v3s?access_token=${localStorage.token}`;\n    classService.post(apiEndpoint, data).then(response => {\n      if (response) {\n        dispatch({\n          type: ADD_LEVELS,\n          payload: response.data\n        });\n        dispatch({\n          type: SHOW_SUCCESS_MESSAGE,\n          payload: \"La création est effectuée avec succès\"\n        });\n        setTimeout(() => {\n          dispatch({\n            type: HIDE_SUCCESS_MESSAGE\n          });\n        }, 4000);\n      } else {\n        dispatch({\n          type: SHOW_ERROR_MESSAGE,\n          payload: \"Une erreur est survenue lors de la création merci d'essayer à nouveau\"\n        });\n        setTimeout(() => {\n          dispatch({\n            type: HIDE_ERROR_MESSAGE\n          });\n        }, 4000);\n      }\n    });\n  };\n}\nexport function editLevel(data) {\n  return dispatch => {\n    let apiEndpoint = `/level_v3s/${data.id}?access_token=${localStorage.token}`;\n    classService.patch(apiEndpoint, {\n      name: data.name\n    }).then(response => {\n      if (response) {\n        dispatch({\n          type: EDIT_LEVELS,\n          payload: response.data\n        });\n      }\n    });\n  };\n}\nexport function getLevel(establishementId, schoolYearId) {\n  return dispatch => {\n    let apiEndpoint = `/level_v3s?access_token=${localStorage.token}&filter[where][fk_id_school_year]=${schoolYearId}&filter[include][educationType]`;\n    classService.get(apiEndpoint).then(response => {\n      if (response) {\n        let levelsListByEstab = [];\n        response.data.forEach(element => {\n          if (element.educationType.fk_id_establishment == establishementId) {\n            levelsListByEstab.push(element);\n          }\n        });\n        const list = levelsListByEstab;\n        const LevelList = list.filter(element => element.status);\n        const ArchivedLevelsList = list.filter(element => element.status == false);\n        dispatch({\n          type: GET_LEVELS,\n          payload: LevelList\n        });\n        dispatch({\n          type: ARCHIVED_GET_LEVELS,\n          payload: ArchivedLevelsList\n        });\n      }\n    });\n  };\n}\nexport function deletelevel(itemId) {\n  return dispatch => {\n    let apiEndpoint = `/level_v3s/` + itemId.id + `?access_token=${localStorage.token}&filter[where][and][0][fk_id_establishment]=${localStorage.establishment_id}&filter[where][and][1][fk_id_school_year]=${localStorage.school_year_id}`;\n    classService.patch(apiEndpoint, {\n      status: false\n    }).then(response => {\n      const list = response.data;\n      dispatch({\n        type: DELETE_LEVELS,\n        payload: response.data\n      });\n    }).catch(function (error) {});\n  };\n}","map":{"version":3,"sources":["/home/oem/Documents/projects/educap/classebook-front-web/src/actions/LevelAction.js"],"names":["classService","SHOW_SUCCESS_MESSAGE","HIDE_SUCCESS_MESSAGE","SHOW_ERROR_MESSAGE","HIDE_ERROR_MESSAGE","GET_LEVELS","ADD_LEVELS","EDIT_LEVELS","DELETE_LEVELS","ARCHIVED_GET_LEVELS","addlevel","data","dispatch","apiEndpoint","localStorage","token","post","then","response","type","payload","setTimeout","editLevel","id","patch","name","getLevel","establishementId","schoolYearId","get","levelsListByEstab","forEach","element","educationType","fk_id_establishment","push","list","LevelList","filter","status","ArchivedLevelsList","deletelevel","itemId","establishment_id","school_year_id","catch","error"],"mappings":"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","sourcesContent":["import { classService } from \"../_services/class.service\";\nimport {\n  SHOW_SUCCESS_MESSAGE,\n  HIDE_SUCCESS_MESSAGE,\n  SHOW_ERROR_MESSAGE,\n  HIDE_ERROR_MESSAGE,\n  GET_LEVELS,\n  ADD_LEVELS,\n  EDIT_LEVELS,\n  DELETE_LEVELS,\n  ARCHIVED_GET_LEVELS,\n} from \"../constants/ActionTypes\";\n\nexport function addlevel(data) {\n  return (dispatch) => {\n     let apiEndpoint = `/level_v3s?access_token=${localStorage.token}`;\n    classService.post(apiEndpoint, data).then((response) => {\n      if (response) {\n        dispatch({ type: ADD_LEVELS, payload: response.data });\n        dispatch({\n          type: SHOW_SUCCESS_MESSAGE,\n          payload: \"La création est effectuée avec succès\",\n        });\n        setTimeout(() => {\n          dispatch({ type: HIDE_SUCCESS_MESSAGE });\n        }, 4000);\n      } else {\n        dispatch({\n          type: SHOW_ERROR_MESSAGE,\n          payload:\n            \"Une erreur est survenue lors de la création merci d'essayer à nouveau\",\n        });\n        setTimeout(() => {\n          dispatch({ type: HIDE_ERROR_MESSAGE });\n        }, 4000);\n      }\n    });\n  };\n}\n\nexport function editLevel(data) {\n  return (dispatch) => {\n     let apiEndpoint = `/level_v3s/${data.id}?access_token=${localStorage.token}`;\n    classService.patch(apiEndpoint, { name: data.name }).then((response) => {\n      if (response) {\n        dispatch({ type: EDIT_LEVELS, payload: response.data });\n       }\n    });\n  };\n}\n\nexport function getLevel(establishementId, schoolYearId) {\n  return (dispatch) => {\n     let apiEndpoint = `/level_v3s?access_token=${localStorage.token}&filter[where][fk_id_school_year]=${schoolYearId}&filter[include][educationType]`;\n    classService.get(apiEndpoint).then((response) => {\n       if (response) {\n        let levelsListByEstab = [];\n        response.data.forEach((element) => {\n           if(element.educationType.fk_id_establishment==establishementId){\n           levelsListByEstab.push(element)\n            }\n        });\n        const list = levelsListByEstab;\n        const LevelList = list.filter((element) => element.status);\n        const ArchivedLevelsList = list.filter(\n          (element) => element.status == false\n        );\n         dispatch({ type: GET_LEVELS, payload: LevelList });\n        dispatch({ type: ARCHIVED_GET_LEVELS, payload: ArchivedLevelsList });\n      }\n    });\n  };\n}\n\nexport function deletelevel(itemId) {\n  return (dispatch) => {\n    let apiEndpoint =\n      `/level_v3s/` +\n      itemId.id +\n      `?access_token=${localStorage.token}&filter[where][and][0][fk_id_establishment]=${localStorage.establishment_id}&filter[where][and][1][fk_id_school_year]=${localStorage.school_year_id}`;\n    classService\n      .patch(apiEndpoint, {\n        status: false,\n      })\n      .then((response) => {\n        const list = response.data;\n\n        dispatch({ type: DELETE_LEVELS, payload: response.data });\n      })\n      .catch(function(error) {});\n  };\n}\n"]},"metadata":{},"sourceType":"module"}