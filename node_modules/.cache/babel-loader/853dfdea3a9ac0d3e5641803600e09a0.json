{"ast":null,"code":"var _jsxFileName = \"/home/oem/Documents/projects/educap/classebook-front-web/src/app/routes/Learning/routes/Homeworks/HomeworkList.js\";\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { getSectionFromLevel } from '../../../../../actions/sectionAction';\nimport { getLevelListFromEstabType } from '../../../../../actions/classLevelAction';\nimport axios from 'axios';\nimport baseUrl from '../../../../../config/config';\nimport { getClassesByEstablishmentId } from '../../../../../actions/classeAction';\nimport { roleIdAdmin } from '../../../../../config/config';\nimport { roleIdProfessor } from '../../../../../config/config';\nimport { roleIdParent } from '../../../../../config/config';\nimport { roleIdStudent } from '../../../../../config/config';\nimport _ from 'lodash';\nimport { privateStatus, publicStatus, allStatus } from '../../../../../config/config';\nimport moment from 'moment';\nimport HomeworkItem from './HomeworkItem';\nimport DeleteHomework from './DeleteHomework';\nimport { deleteHomework } from '../../../../../actions/HomeworkAction';\nimport EditHomework from './EditHomework';\nimport IntlMessages from '../../../../../util/IntlMessages';\nimport { classService } from '../../../../../_services/class.service';\n\nclass HomeworkList extends Component {\n  constructor(props) {\n    super(props);\n\n    this.handleChangeDate = name => date => {\n      this.setState({\n        [name]: date\n      });\n\n      if (name === 'publicationDate') {\n        this.setState({\n          renderingDate: date,\n          correctionDate: date\n        });\n      } else if (name === 'renderingDate') {\n        this.setState({\n          correctionDate: date\n        });\n      }\n    };\n\n    this.handleChangeClassList = selectedOption => {\n      if (selectedOption != null) {\n        let classesId = _.map(selectedOption, 'id');\n\n        this.setState({\n          classesId,\n          isEmptylistClass: false,\n          classItem: selectedOption\n        });\n      } else {\n        this.setState({\n          classesId: []\n        });\n      }\n    };\n\n    this.handleChangeSubject = selectedOption => {\n      this.setState({\n        subjectId: selectedOption.id,\n        subjectItem: selectedOption,\n        classItem: []\n      });\n\n      if (this.props.userProfile.role_id === roleIdAdmin) {\n        let apiEndpoint = `/assignment_class_subjects?access_token=${localStorage.token}&filter[where][fk_id_subject_v4]=${selectedOption.value}&filter[include]=class&filter[include]=course`;\n        classService.get(apiEndpoint).then(response => {\n          if (response) {\n            let classesSubjects = response.data.filter(element => element.status);\n            let newList = [];\n            classesSubjects.map(element => {\n              let object = {};\n\n              if (!_.isEmpty(element.course)) {\n                object.label = element.class.name;\n                object.id = element.course[0].id;\n                object.value = element.course[0].id;\n                newList.push(object);\n              }\n            });\n            this.setState({\n              classes: newList\n            });\n          }\n        });\n      } else {\n        let apiEndpoint = `/assignment_class_subjects/${selectedOption.value}?access_token=${localStorage.token}&filter[include]=class&filter[include]=course`;\n        classService.get(apiEndpoint).then(response => {\n          if (response) {\n            let element = response.data;\n\n            if (element.status) {\n              let object = {};\n              object.label = element.class.name;\n              object.id = element.course[0].id;\n              object.value = element.course[0].id;\n              this.setState({\n                classes: [object]\n              });\n            }\n          }\n        });\n      }\n    };\n\n    this.handleChangeHomeworkType = selectedOption => {\n      this.setState({\n        homeworkType: selectedOption\n      });\n    };\n\n    this.handleChange = name => event => {\n      this.setState({\n        [name]: event.target.value\n      });\n    };\n\n    this.state = {\n      HomeworkTypes: [{\n        label: /*#__PURE__*/React.createElement(IntlMessages, {\n          id: \"toDo.book.exercise\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 29,\n            columnNumber: 18\n          }\n        }),\n        value: 'book',\n        id: 1\n      }, {\n        label: /*#__PURE__*/React.createElement(IntlMessages, {\n          id: \"toDo.series.exercise\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 34,\n            columnNumber: 18\n          }\n        }),\n        value: 'serie',\n        id: 2\n      }, {\n        label: /*#__PURE__*/React.createElement(IntlMessages, {\n          id: \"toDo.other.exercise\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 39,\n            columnNumber: 18\n          }\n        }),\n        value: 'other',\n        id: 3\n      }],\n      classes: [],\n      subjects: [],\n      deleteIsopen: false,\n      itemIdDelete: '',\n      editIsopen: false,\n      itemEdit: {},\n      nameFile: '',\n      subjectId: null,\n      subjectItem: {},\n      classItem: [{}],\n      publicationDate: new Date()\n    };\n    this.handleDelete = this.handleDelete.bind(this);\n    this.handleCancelDelete = this.handleCancelDelete.bind(this);\n    this.handleSubmitDelete = this.handleSubmitDelete.bind(this);\n    this.handleEdit = this.handleEdit.bind(this);\n    this.handleChange = this.handleChange.bind(this);\n    this.handleChangeHomeworkType = this.handleChangeHomeworkType.bind(this);\n    this.handleChangeSubject = this.handleChangeSubject.bind(this);\n    this.handleChangeClassList = this.handleChangeClassList.bind(this);\n    this.cancelModal = this.cancelModal.bind(this);\n    this.handleChangeDate = this.handleChangeDate.bind(this);\n  }\n\n  handleEdit(item) {\n    if (this.props.userProfile.role_id === roleIdAdmin) {\n      let apiEndpoint = `/assignment_class_subjects?access_token=${localStorage.token}&filter[where][fk_id_subject_v4]=${item.homework.fk_id_subject}&filter[include]=class&filter[include]=course`;\n      classService.get(apiEndpoint).then(response => {\n        if (response) {\n          let classesSubjects = response.data.filter(element => element.status);\n          let newList = [];\n          classesSubjects.map(element => {\n            let object = {};\n\n            if (!_.isEmpty(element.course)) {\n              object.label = element.class.name;\n              object.id = element.course[0].id;\n              object.value = element.course[0].id;\n              newList.push(object);\n            }\n          });\n          this.setState({\n            classes: newList\n          });\n        }\n      });\n    } else {\n      let apiEndpoint = `/assignment_class_subjects/${item.homework.fk_id_subject}?access_token=${localStorage.token}&filter[include]=class&filter[include]=course`;\n      classService.get(apiEndpoint).then(response => {\n        if (response) {\n          let element = response.data;\n\n          if (element.status) {\n            let object = {};\n            object.label = element.class.name;\n            object.id = element.course[0].id;\n            object.value = element.course[0].id;\n            this.setState({\n              classes: [object]\n            });\n          }\n        }\n      });\n    }\n\n    console.log(item, 'ediiiiit');\n    let homeworkType = this.state.HomeworkTypes.find(element => element.value == item.homework.homework_type);\n    let subjectItem = this.props.subjects.find(element => element.id == item.homework.fk_id_subject);\n    let classItem = {\n      label: item.className,\n      id: item.courseId,\n      value: item.courseId\n    };\n    this.setState({\n      editIsopen: true,\n      itemEdit: item,\n      nameFile: item.homework.title,\n      homeworkType,\n      subjects: this.props.subjects,\n      subjectItem,\n      classItem: [classItem]\n    });\n  }\n\n  handleSubmitDelete() {\n    this.setState({\n      deleteIsopen: false\n    });\n    this.props.dispatch(deleteHomework(this.state.itemIdDelete));\n  }\n\n  handleDelete(id) {\n    this.setState({\n      deleteIsopen: true,\n      itemIdDelete: id\n    });\n  }\n\n  handleCancelDelete() {\n    this.setState({\n      deleteIsopen: false,\n      itemIdDelete: ''\n    });\n  }\n\n  cancelModal() {\n    this.setState({\n      classes: [],\n      subjects: [],\n      editIsopen: false,\n      itemEdit: {},\n      nameFile: '',\n      subjectId: null,\n      subjectItem: {},\n      classItem: [{}]\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-xl-12 col-md-12 col-lg-12 col-sm-6 \",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"   price-tables row pt-default d-flex flex-wrap justify-content-start \",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 9\n      }\n    }, this.props.homeworks.map((homeworkItem, index) => /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-md-12 col-lg-6 col-sm-6 col-xl-3 \",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(HomeworkItem, {\n      key: index,\n      homeworkItem: homeworkItem,\n      handleDelete: this.handleDelete,\n      handleEdit: this.handleEdit,\n      archived: false,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 15\n      }\n    })))), this.state.editIsopen === true ? /*#__PURE__*/React.createElement(EditHomework, {\n      editIsopen: this.state.editIsopen,\n      values: this.state,\n      handleChange: this.handleChange,\n      handleChangeHomeworkType: this.handleChangeHomeworkType,\n      handleChangeSubject: this.handleChangeSubject,\n      handleChangeClassList: this.handleChangeClassList,\n      cancelModal: this.cancelModal,\n      handleChangeDate: this.handleChangeDate,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 11\n      }\n    }) : '', this.state.deleteIsopen === true ? /*#__PURE__*/React.createElement(DeleteHomework, {\n      modal: this.state.deleteIsopen,\n      handleCancelDelete: this.handleCancelDelete,\n      handleSubmitDelete: this.handleSubmitDelete,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 11\n      }\n    }) : '');\n  }\n\n}\n\nfunction mapStateToProps(state) {\n  return {\n    userProfile: state.auth.userProfile,\n    ClassSettings: state.ClassSettingsReducer.classSettings\n  };\n}\n\nexport default connect(mapStateToProps)(HomeworkList);","map":{"version":3,"sources":["/home/oem/Documents/projects/educap/classebook-front-web/src/app/routes/Learning/routes/Homeworks/HomeworkList.js"],"names":["React","Component","connect","getSectionFromLevel","getLevelListFromEstabType","axios","baseUrl","getClassesByEstablishmentId","roleIdAdmin","roleIdProfessor","roleIdParent","roleIdStudent","_","privateStatus","publicStatus","allStatus","moment","HomeworkItem","DeleteHomework","deleteHomework","EditHomework","IntlMessages","classService","HomeworkList","constructor","props","handleChangeDate","name","date","setState","renderingDate","correctionDate","handleChangeClassList","selectedOption","classesId","map","isEmptylistClass","classItem","handleChangeSubject","subjectId","id","subjectItem","userProfile","role_id","apiEndpoint","localStorage","token","value","get","then","response","classesSubjects","data","filter","element","status","newList","object","isEmpty","course","label","class","push","classes","handleChangeHomeworkType","homeworkType","handleChange","event","target","state","HomeworkTypes","subjects","deleteIsopen","itemIdDelete","editIsopen","itemEdit","nameFile","publicationDate","Date","handleDelete","bind","handleCancelDelete","handleSubmitDelete","handleEdit","cancelModal","item","homework","fk_id_subject","console","log","find","homework_type","className","courseId","title","dispatch","render","homeworks","homeworkItem","index","mapStateToProps","auth","ClassSettings","ClassSettingsReducer","classSettings"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\n\nimport { connect } from 'react-redux';\nimport { getSectionFromLevel } from '../../../../../actions/sectionAction';\nimport { getLevelListFromEstabType } from '../../../../../actions/classLevelAction';\nimport axios from 'axios';\nimport baseUrl from '../../../../../config/config';\nimport { getClassesByEstablishmentId } from '../../../../../actions/classeAction';\nimport { roleIdAdmin } from '../../../../../config/config';\nimport { roleIdProfessor } from '../../../../../config/config';\nimport { roleIdParent } from '../../../../../config/config';\nimport { roleIdStudent } from '../../../../../config/config';\nimport _ from 'lodash';\nimport { privateStatus, publicStatus, allStatus } from '../../../../../config/config';\nimport moment from 'moment';\nimport HomeworkItem from './HomeworkItem';\nimport DeleteHomework from './DeleteHomework';\nimport { deleteHomework } from '../../../../../actions/HomeworkAction';\nimport EditHomework from './EditHomework';\nimport IntlMessages from '../../../../../util/IntlMessages';\nimport { classService } from '../../../../../_services/class.service';\n\nclass HomeworkList extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      HomeworkTypes: [\n        {\n          label: <IntlMessages id=\"toDo.book.exercise\" />,\n          value: 'book',\n          id: 1,\n        },\n        {\n          label: <IntlMessages id=\"toDo.series.exercise\" />,\n          value: 'serie',\n          id: 2,\n        },\n        {\n          label: <IntlMessages id=\"toDo.other.exercise\" />,\n          value: 'other',\n          id: 3,\n        },\n      ],\n      classes: [],\n      subjects: [],\n      deleteIsopen: false,\n      itemIdDelete: '',\n      editIsopen: false,\n      itemEdit: {},\n      nameFile: '',\n      subjectId: null,\n      subjectItem: {},\n      classItem: [{}],\n      publicationDate: new Date(),\n    };\n    this.handleDelete = this.handleDelete.bind(this);\n    this.handleCancelDelete = this.handleCancelDelete.bind(this);\n    this.handleSubmitDelete = this.handleSubmitDelete.bind(this);\n    this.handleEdit = this.handleEdit.bind(this);\n    this.handleChange = this.handleChange.bind(this);\n    this.handleChangeHomeworkType = this.handleChangeHomeworkType.bind(this);\n    this.handleChangeSubject = this.handleChangeSubject.bind(this);\n    this.handleChangeClassList = this.handleChangeClassList.bind(this);\n    this.cancelModal = this.cancelModal.bind(this);\n    this.handleChangeDate = this.handleChangeDate.bind(this);\n  }\n  handleChangeDate = (name) => (date) => {\n    this.setState({ [name]: date });\n    if (name === 'publicationDate') {\n      this.setState({ renderingDate: date, correctionDate: date });\n    } else if (name === 'renderingDate') {\n      this.setState({ correctionDate: date });\n    }\n  };\n  handleChangeClassList = (selectedOption) => {\n    if (selectedOption != null) {\n      let classesId = _.map(selectedOption, 'id');\n      this.setState({\n        classesId,\n        isEmptylistClass: false,\n        classItem: selectedOption,\n      });\n    } else {\n      this.setState({ classesId: [] });\n    }\n  };\n  handleChangeSubject = (selectedOption) => {\n    this.setState({\n      subjectId: selectedOption.id,\n      subjectItem: selectedOption,\n      classItem: [],\n    });\n    if (this.props.userProfile.role_id === roleIdAdmin) {\n      let apiEndpoint = `/assignment_class_subjects?access_token=${localStorage.token}&filter[where][fk_id_subject_v4]=${selectedOption.value}&filter[include]=class&filter[include]=course`;\n      classService.get(apiEndpoint).then((response) => {\n        if (response) {\n          let classesSubjects = response.data.filter((element) => element.status);\n          let newList = [];\n          classesSubjects.map((element) => {\n            let object = {};\n            if (!_.isEmpty(element.course)) {\n              object.label = element.class.name;\n              object.id = element.course[0].id;\n              object.value = element.course[0].id;\n\n              newList.push(object);\n            }\n          });\n\n          this.setState({ classes: newList });\n        }\n      });\n    } else {\n      let apiEndpoint = `/assignment_class_subjects/${selectedOption.value}?access_token=${localStorage.token}&filter[include]=class&filter[include]=course`;\n      classService.get(apiEndpoint).then((response) => {\n        if (response) {\n          let element = response.data;\n          if (element.status) {\n            let object = {};\n            object.label = element.class.name;\n            object.id = element.course[0].id;\n            object.value = element.course[0].id;\n            this.setState({ classes: [object] });\n          }\n        }\n      });\n    }\n  };\n  handleChangeHomeworkType = (selectedOption) => {\n    this.setState({ homeworkType: selectedOption });\n  };\n  handleChange = (name) => (event) => {\n    this.setState({ [name]: event.target.value });\n  };\n  handleEdit(item) {\n    if (this.props.userProfile.role_id === roleIdAdmin) {\n      let apiEndpoint = `/assignment_class_subjects?access_token=${localStorage.token}&filter[where][fk_id_subject_v4]=${item.homework.fk_id_subject}&filter[include]=class&filter[include]=course`;\n      classService.get(apiEndpoint).then((response) => {\n        if (response) {\n          let classesSubjects = response.data.filter((element) => element.status);\n          let newList = [];\n          classesSubjects.map((element) => {\n            let object = {};\n            if (!_.isEmpty(element.course)) {\n              object.label = element.class.name;\n              object.id = element.course[0].id;\n              object.value = element.course[0].id;\n\n              newList.push(object);\n            }\n          });\n\n          this.setState({ classes: newList });\n        }\n      });\n    } else {\n      let apiEndpoint = `/assignment_class_subjects/${item.homework.fk_id_subject}?access_token=${localStorage.token}&filter[include]=class&filter[include]=course`;\n      classService.get(apiEndpoint).then((response) => {\n        if (response) {\n          let element = response.data;\n          if (element.status) {\n            let object = {};\n            object.label = element.class.name;\n            object.id = element.course[0].id;\n            object.value = element.course[0].id;\n            this.setState({ classes: [object] });\n          }\n        }\n      });\n    }\n    console.log(item, 'ediiiiit');\n    let homeworkType = this.state.HomeworkTypes.find(\n      (element) => element.value == item.homework.homework_type\n    );\n    let subjectItem = this.props.subjects.find(\n      (element) => element.id == item.homework.fk_id_subject\n    );\n    let classItem = {\n      label: item.className,\n      id: item.courseId,\n      value: item.courseId,\n    };\n    this.setState({\n      editIsopen: true,\n      itemEdit: item,\n      nameFile: item.homework.title,\n      homeworkType,\n      subjects: this.props.subjects,\n      subjectItem,\n      classItem: [classItem],\n    });\n  }\n  handleSubmitDelete() {\n    this.setState({ deleteIsopen: false });\n    this.props.dispatch(deleteHomework(this.state.itemIdDelete));\n  }\n  handleDelete(id) {\n    this.setState({ deleteIsopen: true, itemIdDelete: id });\n  }\n\n  handleCancelDelete() {\n    this.setState({ deleteIsopen: false, itemIdDelete: '' });\n  }\n  cancelModal() {\n    this.setState({\n      classes: [],\n      subjects: [],\n      editIsopen: false,\n      itemEdit: {},\n      nameFile: '',\n      subjectId: null,\n      subjectItem: {},\n      classItem: [{}],\n    });\n  }\n  render() {\n    return (\n      <div className=\"col-xl-12 col-md-12 col-lg-12 col-sm-6 \">\n        <div className=\"   price-tables row pt-default d-flex flex-wrap justify-content-start \">\n          {this.props.homeworks.map((homeworkItem, index) => (\n            <div className=\"col-md-12 col-lg-6 col-sm-6 col-xl-3 \">\n              <HomeworkItem\n                key={index}\n                homeworkItem={homeworkItem}\n                handleDelete={this.handleDelete}\n                handleEdit={this.handleEdit}\n                archived={false}\n              />\n            </div>\n          ))}\n        </div>\n\n        {this.state.editIsopen === true ? (\n          <EditHomework\n            editIsopen={this.state.editIsopen}\n            values={this.state}\n            handleChange={this.handleChange}\n            handleChangeHomeworkType={this.handleChangeHomeworkType}\n            handleChangeSubject={this.handleChangeSubject}\n            handleChangeClassList={this.handleChangeClassList}\n            cancelModal={this.cancelModal}\n            handleChangeDate={this.handleChangeDate}\n          />\n        ) : (\n          ''\n        )}\n\n        {this.state.deleteIsopen === true ? (\n          <DeleteHomework\n            modal={this.state.deleteIsopen}\n            handleCancelDelete={this.handleCancelDelete}\n            handleSubmitDelete={this.handleSubmitDelete}\n          ></DeleteHomework>\n        ) : (\n          ''\n        )}\n        {/* {this.state.call == true ? (\n          <JitsiComponent values={this.state} />\n        ) : (\n          <div></div>\n        )} */}\n      </div>\n    );\n  }\n}\n\nfunction mapStateToProps(state) {\n  return {\n    userProfile: state.auth.userProfile,\n    ClassSettings: state.ClassSettingsReducer.classSettings,\n  };\n}\n\nexport default connect(mapStateToProps)(HomeworkList);\n"]},"metadata":{},"sourceType":"module"}