{"ast":null,"code":"var _jsxFileName = \"/home/oem/Documents/projects/educap/classebook-front-web/src/app/routes/Profile/Contact/index.js\";\nimport React from \"react\";\nimport Widget from \"../../../../components/Widget\";\nimport IntlMessages from '../../../../util/IntlMessages';\nimport { classService } from '../../../../_services/class.service';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport FormGroup from '@material-ui/core/FormGroup';\nimport FormHelperText from '@material-ui/core/FormHelperText';\nimport Button from \"@material-ui/core/Button\";\nimport { Alert } from 'reactstrap';\nimport axios from 'axios';\n\nclass Contact extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.handleChange = name => (event, checked) => {\n      this.setState({\n        [name]: checked,\n        isSubmitting: true\n      });\n    };\n\n    this.state = {\n      stuppUserConnected: [],\n      emailInterne: '',\n      emailExterne: '',\n      sms: '',\n      isSubmitting: false,\n      alert_success: false,\n      alert_failed: false\n    };\n    this.handleChange = this.handleChange.bind(this);\n    this.submit = this.submit.bind(this);\n  }\n\n  componentDidMount() {\n    let apiEndpoint = `/profiles/` + localStorage.profileId + `?access_token=${localStorage.token}&filter[include]=user&filter[include]=notifications`;\n    classService.get(apiEndpoint).then(res => {\n      console.log(res.data);\n\n      if (res) {\n        this.setState({\n          stuppUserConnected: res.data // ,emailExterne :res.data.notifications.emailexterne,emailInterne:res.data.notifications.emailinterne, sms: res.data.notifications.sms\n\n        });\n      }\n    });\n  }\n\n  submit() {\n    let data = {\n      emailinterne: this.state.emailInterne,\n      emailexterne: this.state.emailExterne,\n      sms: this.state.sms,\n      profile_id: this.state.stuppUserConnected.id\n    };\n    let apiEndpoint2 = `/notifications/` + this.state.stuppUserConnected.id + `?access_token=${localStorage.token}`;\n    classService.put(apiEndpoint2, data).then(response => {\n      if (response.status === 200) {\n        this.setState({\n          alert_success: true\n        });\n        let timeout = setTimeout(() => this.setState({\n          alert_success: false\n        }), 3000);\n      }\n    }).catch(error => {\n      this.setState({\n        alert_failed: true\n      });\n      let timeout = setTimeout(() => this.setState({\n        alert_failed: false\n      }), 3000);\n    });\n  }\n\n  render() {\n    const stuppUserContact = this.state.stuppUserConnected;\n    return /*#__PURE__*/React.createElement(Widget, {\n      title: \"Contact\",\n      styleName: \"jr-card-profile-sm\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"media align-items-center flex-nowrap jr-pro-contact-list\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mr-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: `zmdi zmdi-${'email'} jr-fs-xxl text-grey`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"media-body\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: \"mb-0 text-grey jr-fs-sm\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(IntlMessages, {\n      id: \"components.profile.email\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 56\n      }\n    })), /*#__PURE__*/React.createElement(\"p\", {\n      className: \"jr-link\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 13\n      }\n    }, stuppUserContact.email))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"media align-items-center flex-nowrap jr-pro-contact-list\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mr-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: `zmdi zmdi-${'phone'} jr-fs-xxl text-grey`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"media-body\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: \"mb-0 text-grey jr-fs-sm\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(IntlMessages, {\n      id: \"components.profile.phone\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 56\n      }\n    })), /*#__PURE__*/React.createElement(\"p\", {\n      className: \"mb-0\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 13\n      }\n    }, stuppUserContact.phone))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mb-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(FormHelperText, {\n      className: \"text-grey\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 11\n      }\n    }, \"Choisir type de notification\"), this.state.alert_success ? /*#__PURE__*/React.createElement(Alert, {\n      className: \"shadow-lg\",\n      color: \"success\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(IntlMessages, {\n      id: \"edit.user.message\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 16\n      }\n    })) : null, this.state.alert_failed ? /*#__PURE__*/React.createElement(Alert, {\n      className: \"shadow-lg\",\n      color: \"secondary\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(IntlMessages, {\n      id: \"edit.user.error\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 16\n      }\n    })) : null, /*#__PURE__*/React.createElement(FormGroup, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(FormControlLabel, {\n      control: /*#__PURE__*/React.createElement(Checkbox, {\n        checked: this.state.sms,\n        onChange: this.handleChange('sms'),\n        value: \"sms\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 17\n        }\n      }),\n      label: \"SMS\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(FormControlLabel, {\n      control: /*#__PURE__*/React.createElement(Checkbox, {\n        color: \"primary\",\n        checked: this.state.emailExterne,\n        onChange: this.handleChange('emailExterne'),\n        value: \"emailexterne\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 17\n        }\n      }),\n      label: \"Email Externe\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(FormControlLabel, {\n      control: /*#__PURE__*/React.createElement(Checkbox, {\n        color: \"primary\",\n        checked: this.state.emailInterne,\n        onChange: this.handleChange('emailInterne'),\n        value: \"emailinterne\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 17\n        }\n      }),\n      label: \"Email Interne\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-md-12 text-left \",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      variant: \"contained\",\n      className: \"jr-btn bg-indigo text-white \",\n      type: \"submit\",\n      disabled: !this.state.isSubmitting,\n      onClick: this.submit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(IntlMessages, {\n      id: \"components.establishments.formModify.buttonModify\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 88\n      }\n    })))));\n  }\n\n}\n\nexport default Contact;","map":{"version":3,"sources":["/home/oem/Documents/projects/educap/classebook-front-web/src/app/routes/Profile/Contact/index.js"],"names":["React","Widget","IntlMessages","classService","Checkbox","FormControlLabel","FormGroup","FormHelperText","Button","Alert","axios","Contact","Component","constructor","props","handleChange","name","event","checked","setState","isSubmitting","state","stuppUserConnected","emailInterne","emailExterne","sms","alert_success","alert_failed","bind","submit","componentDidMount","apiEndpoint","localStorage","profileId","token","get","then","res","console","log","data","emailinterne","emailexterne","profile_id","id","apiEndpoint2","put","response","status","timeout","setTimeout","catch","error","render","stuppUserContact","email","phone"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport Widget from \"../../../../components/Widget\";\r\nimport IntlMessages from '../../../../util/IntlMessages';\r\nimport { classService } from '../../../../_services/class.service';\r\nimport Checkbox from '@material-ui/core/Checkbox';\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\r\nimport FormGroup from '@material-ui/core/FormGroup';\r\nimport FormHelperText from '@material-ui/core/FormHelperText';\r\nimport Button from \"@material-ui/core/Button\";\r\nimport { Alert } from 'reactstrap';\r\nimport axios from 'axios';\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass Contact extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      stuppUserConnected: [],\r\n      emailInterne: '',\r\n      emailExterne: '',\r\n      sms: '',\r\n      isSubmitting: false,\r\n      alert_success: false,\r\n      alert_failed: false\r\n    };\r\n    this.handleChange = this.handleChange.bind(this)\r\n    this.submit = this.submit.bind(this)\r\n\r\n  };\r\n\r\n  componentDidMount() {\r\n    let apiEndpoint = `/profiles/` + localStorage.profileId + `?access_token=${localStorage.token}&filter[include]=user&filter[include]=notifications`\r\n    classService.get(apiEndpoint)\r\n      .then(res => {\r\n      console.log(res.data);\r\n      \r\n        if (res) {\r\n           this.setState({ stuppUserConnected:res.data \r\n            // ,emailExterne :res.data.notifications.emailexterne,emailInterne:res.data.notifications.emailinterne, sms: res.data.notifications.sms\r\n          });\r\n        }\r\n      })\r\n\r\n  }\r\n  handleChange = name => (event, checked) => {\r\n\r\n    this.setState({ [name]: checked, isSubmitting: true });\r\n  };\r\n  submit() {\r\n    let data ={\r\n      emailinterne: this.state.emailInterne,\r\n      emailexterne: this.state.emailExterne,\r\n      sms: this.state.sms,\r\n      profile_id:this.state.stuppUserConnected.id \r\n\r\n    }\r\n      let apiEndpoint2 = `/notifications/` + this.state.stuppUserConnected.id + `?access_token=${localStorage.token}`;\r\n\r\n    classService.put(apiEndpoint2, data)\r\n    .then(response => {\r\n      if(response.status===200){\r\n\r\n      \r\n      this.setState({ alert_success: true })\r\n     let  timeout = setTimeout(() => this.setState({ alert_success: false }), 3000)\r\n      }\r\n\r\n    }).catch(error => {\r\n      this.setState({ alert_failed: true })\r\n        let timeout = setTimeout(() => this.setState({ alert_failed: false }), 3000)\r\n  \r\n      \r\n\r\n    });\r\n\r\n  }\r\n  render() {\r\n \r\n  \r\n    const stuppUserContact = this.state.stuppUserConnected;\r\n    return (\r\n      <Widget title=\"Contact\" styleName=\"jr-card-profile-sm\">\r\n        <div className=\"media align-items-center flex-nowrap jr-pro-contact-list\">\r\n          <div className=\"mr-3\">\r\n            <i className={`zmdi zmdi-${'email'} jr-fs-xxl text-grey`} />\r\n          </div>\r\n          <div className=\"media-body\">\r\n            <span className=\"mb-0 text-grey jr-fs-sm\">{<IntlMessages id=\"components.profile.email\" />}</span>\r\n            <p className=\"jr-link\">{stuppUserContact.email}</p>\r\n          </div>\r\n        </div>\r\n        <div className=\"media align-items-center flex-nowrap jr-pro-contact-list\">\r\n          <div className=\"mr-3\">\r\n            <i className={`zmdi zmdi-${'phone'} jr-fs-xxl text-grey`} />\r\n          </div>\r\n          <div className=\"media-body\">\r\n            <span className=\"mb-0 text-grey jr-fs-sm\">{<IntlMessages id=\"components.profile.phone\" />}</span>\r\n            <p className=\"mb-0\">{stuppUserContact.phone}</p>\r\n          </div>\r\n        </div>\r\n        <div className=\"mb-4\">\r\n          <FormHelperText className=\"text-grey\">Choisir type de notification</FormHelperText>\r\n          {this.state.alert_success ?\r\n            <Alert className=\"shadow-lg\" color=\"success\">\r\n              {<IntlMessages id=\"edit.user.message\" />}\r\n            </Alert> : null\r\n          }\r\n          {this.state.alert_failed ?\r\n            <Alert className=\"shadow-lg\" color=\"secondary\">\r\n              \r\n              {<IntlMessages id=\"edit.user.error\" />}\r\n          </Alert> : null\r\n          }\r\n\r\n          <FormGroup>\r\n            <FormControlLabel\r\n              control={\r\n                <Checkbox\r\n                  checked={this.state.sms}\r\n                  onChange={this.handleChange('sms')}\r\n                  value=\"sms\"\r\n                />\r\n              }\r\n              label=\"SMS\"\r\n            />\r\n            <FormControlLabel\r\n              control={\r\n                <Checkbox color=\"primary\"\r\n                  checked={this.state.emailExterne}\r\n                  onChange={this.handleChange('emailExterne')}\r\n                  value=\"emailexterne\"\r\n                />\r\n              }\r\n              label=\"Email Externe\"\r\n            />\r\n            <FormControlLabel\r\n              control={\r\n                <Checkbox color=\"primary\"\r\n                  checked={this.state.emailInterne}\r\n                  onChange={this.handleChange('emailInterne')}\r\n                  value=\"emailinterne\"\r\n                />\r\n              }\r\n              label=\"Email Interne\"\r\n            />\r\n\r\n          </FormGroup>\r\n          <div className=\"col-md-12 text-left \">\r\n\r\n            <Button variant=\"contained\"\r\n              className=\"jr-btn bg-indigo text-white \"\r\n              type=\"submit\" disabled={!this.state.isSubmitting} onClick={this.submit}>{<IntlMessages id=\"components.establishments.formModify.buttonModify\" />}</Button>\r\n          </div>\r\n\r\n        </div>\r\n\r\n\r\n      </Widget>\r\n    )\r\n  }\r\n}\r\nexport default Contact;\r\n\r\n\r\n\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}