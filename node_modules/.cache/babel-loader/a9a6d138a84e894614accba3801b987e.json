{"ast":null,"code":"var _jsxFileName = \"/home/oem/Documents/projects/educap/classebook-front-web/src/app/routes/todo/Devoir/ConversationCell.js\";\nimport React from 'react';\nimport DownloadFiles from './DownloadFiles';\nimport { classService } from \"../../../../_services/class.service\";\nimport _ from 'lodash';\nvar options = {\n  weekday: 'long',\n  year: 'numeric',\n  month: 'short',\n  day: 'numeric'\n};\n\nclass ConversationCell extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      url: '',\n      downloadModal: false\n    };\n    this.handleCancel = this.handleCancel.bind(this);\n    this.downloadFile = this.downloadFile.bind(this);\n  }\n\n  handleCancel() {\n    this.setState({\n      downloadModal: false\n    });\n  }\n\n  downloadFile() {\n    this.setState({\n      downloadModal: true\n    });\n    const files = this.props.conversation.file;\n\n    if (files !== null) {\n      let apiEndpoint = '';\n      var estblishmentId = localStorage.getItem('establishment_id');\n      apiEndpoint = `/establishments/` + estblishmentId + `?access_token=${localStorage.token}`;\n      classService.get(apiEndpoint).then(response => {\n        if (response) {\n          this.setState({\n            establishmentName: response.data.name\n          });\n          apiEndpoint = `/containers/checkFileExist/${response.data.name}?access_token=${localStorage.token}`;\n          classService.get(apiEndpoint).then(response => {\n            if (response) {\n              let fileList = _.isEmpty(response.data.checkFile) ? null : response.data.checkFile.find(item => item.name === files);\n              const establishLogoUrl = _.isEmpty(fileList) ? null : `/containers/` + this.state.establishmentName + '/download/' + fileList.name + `?access_token=${localStorage.token}`;\n\n              if (establishLogoUrl !== null) {\n                classService.getPhoto(establishLogoUrl).then(response => {\n                  if (response) {\n                    var arr = response.data;\n                    var data2 = new Uint8Array(arr);\n                    var blob = new Blob([data2], {\n                      type: 'application/pdf'\n                    });\n                    var url = URL.createObjectURL(blob);\n                    this.setState({\n                      url: url,\n                      downloadFile: true\n                    });\n                  }\n                }).catch(err => {\n                  console.log('erorrrrrrrrr', err);\n                });\n              } else {\n                this.setState({\n                  url: null\n                });\n              }\n            }\n          });\n        }\n      });\n    } else {}\n  }\n\n  render() {\n    const {\n      conversation,\n      language\n    } = this.props;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"d-flex module-detail-item\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"chat-toto-info\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"d-flex  flex-column\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"b\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"name mr-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 15\n      }\n    }, language === 'tunisia' ? new Date(conversation.comment_date).toLocaleDateString('ar-TN', options) : language === 'french' ? new Date(conversation.comment_date).toLocaleDateString('fr-FR', options) : new Date(conversation.comment_date).toLocaleDateString('en-US', options)), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"time text-muted\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 15\n      }\n    }, language === 'tunisia' ? /*#__PURE__*/React.createElement(\"h4\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 21\n      }\n    }, conversation.profile.user.surname_ar, \" \", conversation.profile.user.name_ar, \" \") : /*#__PURE__*/React.createElement(\"h4\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 21\n      }\n    }, conversation.profile.user.name, \" \", conversation.profile.user.surname)))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"message\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 11\n      }\n    }, conversation.comment), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"text-primary\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 11\n      }\n    }, \" \", /*#__PURE__*/React.createElement(\"p\", {\n      onClick: () => this.downloadFile(),\n      className: \" mt-auto mb-0 pointer\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 42\n      }\n    }, conversation.file_name))), this.state.downloadModal ? /*#__PURE__*/React.createElement(DownloadFiles, {\n      opendownload: this.state.downloadModal,\n      cancelModal: this.handleCancel,\n      url: this.state.url,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 37\n      }\n    }) : '');\n  }\n\n}\n\nexport default ConversationCell;","map":{"version":3,"sources":["/home/oem/Documents/projects/educap/classebook-front-web/src/app/routes/todo/Devoir/ConversationCell.js"],"names":["React","DownloadFiles","classService","_","options","weekday","year","month","day","ConversationCell","Component","constructor","props","state","url","downloadModal","handleCancel","bind","downloadFile","setState","files","conversation","file","apiEndpoint","estblishmentId","localStorage","getItem","token","get","then","response","establishmentName","data","name","fileList","isEmpty","checkFile","find","item","establishLogoUrl","getPhoto","arr","data2","Uint8Array","blob","Blob","type","URL","createObjectURL","catch","err","console","log","render","language","Date","comment_date","toLocaleDateString","profile","user","surname_ar","name_ar","surname","comment","file_name"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport DownloadFiles from './DownloadFiles';\r\nimport { classService } from \"../../../../_services/class.service\";\r\nimport _ from 'lodash';\r\nvar options = {\r\n  weekday: 'long',\r\n  year: 'numeric',\r\n  month: 'short',\r\n  day: 'numeric',\r\n};\r\nclass ConversationCell extends React.Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {\r\n      url: '',\r\n      downloadModal: false,\r\n\r\n    }\r\n    this.handleCancel = this.handleCancel.bind(this)\r\n    this.downloadFile = this.downloadFile.bind(this)\r\n  }\r\n  handleCancel() {\r\n    this.setState({  downloadModal: false })\r\n  };\r\n  downloadFile() {\r\n    this.setState({ downloadModal: true })\r\n    const files = this.props.conversation.file;\r\n\r\n    if (files !== null) {\r\n      let apiEndpoint = '';\r\n      var estblishmentId = localStorage.getItem('establishment_id');\r\n      apiEndpoint = `/establishments/` + estblishmentId + `?access_token=${localStorage.token}`\r\n      classService.get(apiEndpoint)\r\n        .then(response => {\r\n          if (response) {\r\n            this.setState({\r\n              establishmentName: response.data.name\r\n            })\r\n            apiEndpoint = `/containers/checkFileExist/${response.data.name}?access_token=${localStorage.token}`\r\n            classService.get(apiEndpoint)\r\n              .then((response) => {\r\n                if (response) {\r\n                  let fileList = _.isEmpty(response.data.checkFile) ? null :\r\n                    response.data.checkFile.find(item => item.name === files);\r\n                  const establishLogoUrl = _.isEmpty(fileList) ? null : `/containers/` + this.state.establishmentName + '/download/' + fileList.name + `?access_token=${localStorage.token}`;\r\n\r\n                  if (establishLogoUrl !== null) {\r\n\r\n                    classService.getPhoto(establishLogoUrl)\r\n\r\n                      .then((response) => {\r\n                        if (response) {\r\n                          var arr = response.data;\r\n                          var data2 = new Uint8Array(arr);\r\n                          var blob = new Blob([data2], { type: 'application/pdf' });\r\n                          var url = URL.createObjectURL(blob);\r\n                          this.setState({\r\n                            url: url,\r\n                            downloadFile: true\r\n                          })\r\n                        }\r\n                      })\r\n                      .catch((err) => {\r\n                        console.log('erorrrrrrrrr', err);\r\n                      })\r\n                  }\r\n                  else {\r\n                    this.setState({\r\n                      url: null\r\n                    })\r\n                  }\r\n                }\r\n              });\r\n          }\r\n        })\r\n    } else {\r\n    }\r\n  }\r\n  render() {\r\n    const { conversation, language } = this.props;\r\n    return (\r\n      <div className=\"d-flex module-detail-item\">\r\n        <div className=\"chat-toto-info\">\r\n          <div className=\"d-flex  flex-column\">\r\n            <br/>\r\n            <b>\r\n              <div className=\"name mr-2\">\r\n                {language === 'tunisia'\r\n                  ? new Date(conversation.comment_date).toLocaleDateString('ar-TN', options)\r\n                  : language === 'french'\r\n                    ? new Date(conversation.comment_date).toLocaleDateString('fr-FR', options)\r\n                    : new Date(conversation.comment_date).toLocaleDateString('en-US', options)}\r\n                 </div>\r\n              <div className=\"time text-muted\">\r\n                \r\n                {language === 'tunisia'\r\n                  ? <h4>{conversation.profile.user.surname_ar} {conversation.profile.user.name_ar} </h4>\r\n                  : <h4>{conversation.profile.user.name} {conversation.profile.user.surname}</h4>\r\n                  }\r\n                </div>\r\n            </b>\r\n          </div>\r\n          <div className=\"message\">{conversation.comment}</div>\r\n          <div className=\"text-primary\"> <p onClick={() => this.downloadFile()} className=\" mt-auto mb-0 pointer\">{conversation.file_name}</p></div>\r\n        </div>\r\n        {this.state.downloadModal ? < DownloadFiles opendownload={this.state.downloadModal} cancelModal={this.handleCancel} url={this.state.url} /> : ''}\r\n      </div>\r\n    )\r\n  };\r\n}\r\nexport default ConversationCell;"]},"metadata":{},"sourceType":"module"}