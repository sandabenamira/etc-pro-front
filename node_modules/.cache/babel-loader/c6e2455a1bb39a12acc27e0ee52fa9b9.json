{"ast":null,"code":"var _jsxFileName = \"/home/oem/Documents/projects/educap/classebook-front-web/src/app/routes/FinancialManagement/routes/Billing/BillItem.js\";\nimport React, { Component } from \"react\";\nimport AppBar from \"@material-ui/core/AppBar\";\nimport Tabs from \"@material-ui/core/Tabs\";\nimport Tab from \"@material-ui/core/Tab\";\nimport IntlMessages from \"../../../../../util/IntlMessages\";\nimport \"jspdf-autotable\";\nimport jsPDF from \"jspdf\";\nimport DetailsBill from \"./DetailsBill\";\nimport { invoiceNotificationWithMail, invoiceNotificationWithSMS } from '../../../../../actions/BillAction';\nimport { connect } from 'react-redux';\nimport PayBill from '../Payment/PayBill';\nimport { unpaidInvoice, partiallyPaidInvoice, billPaid, lateInvoice } from '../../../../../config/config';\nimport { url } from \"../ServiceAllocation/photo\";\nimport { withStyles } from '@material-ui/core/styles';\n\nconst styles = theme => ({\n  textColorPrimary: {\n    color: \"#FFFFFF\"\n  }\n});\n\nexport class BillItem extends Component {\n  constructor(props) {\n    super(props);\n\n    this.jsPdfGenerator = () => {\n      let bill = this.props.item;\n      var doc = new jsPDF(\"p\", \"pt\", \"a4\", true);\n      var imgData = url;\n      doc.addImage(imgData, \"JPEG\", 485, 20, 80, 80);\n      doc.setFontType(\"bold\");\n      doc.setTextColor(0, 0, 255);\n      doc.text(20, 50, \"Facture N°: \" + bill.bill.reference);\n      doc.text(350, 50, \"2020/2021\");\n      doc.setFontType(\"times\");\n      doc.setTextColor(0, 0, 0);\n      doc.text(350, 140, \"M. ou Mme \" + bill.student.student_parents[0].parent.profile.user.name + \" \" + bill.student.student_parents[0].parent.profile.user.surname);\n      doc.text(350, 160, \"adresse : \" + bill.student.student_parents[0].parent.profile.user.address);\n      doc.text(350, 180, \"Code Postal : \" + bill.student.student_parents[0].parent.profile.user.zip_code); // doc.text(350, 200, 'Rue : Cyber Parc ,Sousse');\n      // doc.text(350, 220, 'Tel:+216 *******');\n\n      doc.text(20, 140, \"De ADN EXPERTISE \");\n      doc.text(20, 160, \"Rue : Cyber Parc ,Sousse\");\n      doc.text(20, 180, \"Tel:+216 *******\");\n      doc.text(20, 200, \"Email: Adn-Expertise@gmail.com\");\n      doc.setFontType(\"bold\");\n      doc.text(20, 240, \"Facture des prestations:\");\n      doc.setFontType(\"times\");\n      doc.text(20, 260, \" L'élève \" + bill.student.profile.user.name + \" \" + bill.student.profile.user.surname + \" ( \" + bill.student.class.name + \" )\");\n      var columns = [\"ID\", \"Description\", \"Quantité\", \"Prix unitaire HT\", \"TVA\", \"TOTAL TTC\"];\n      var rows = [[1, \"Bus\", \"3\", \"15 DT\", \"6 DT\", \"21 DT\"], [2, \"Cantine\", \"3\", \"30 DT\", \"6DT\", \"36 DT\"], [3, \"Inscription\", \"1\", \"100 DT\", \"20 DT\", \"120 DT\"], [, \"\", \"\", \"\", \"\"], [, \"\", \"\", \"\", \"Total HT\", \"200 DT\"], [, \"\", \"\", \"\", \"TVA\", \"20 DT\"], [, \"\", \"\", \"\", \"Total TTC\", \"220 DT\"]];\n      var rowsDynamiq = [];\n      bill.service_v2.map(element => rowsDynamiq.push([element.id, element.name_fr_service, \"1\", element.price_service, element.vat_service + \" %\", element.price_service * (element.vat_service + 100) / 100]));\n      rowsDynamiq.push([, \"\", \"\", \"\", \"\"]);\n      rowsDynamiq.push([, \"\", \"\", \"\", \"Total HT\", bill.bill.total_excl_tax]);\n      rowsDynamiq.push([, \"\", \"\", \"\", \"TVA\", bill.bill.total_vat + \" %\"]);\n      rowsDynamiq.push([, \"\", \"\", \"\", \"Total TTC\", bill.bill.total_incl_tax]);\n      doc.autoTable(columns, rowsDynamiq, {\n        margin: {\n          top: 300\n        }\n      });\n      doc.save(bill.bill.reference);\n    };\n\n    this.state = {\n      openDetails: false,\n      payBill: false\n    };\n    this.handleDetails = this.handleDetails.bind(this);\n    this.handleCancelDetails = this.handleCancelDetails.bind(this);\n    this.SendMail = this.SendMail.bind(this);\n    this.sendSMS = this.sendSMS.bind(this);\n    this.payBill = this.payBill.bind(this);\n    this.cancelModal = this.cancelModal.bind(this);\n  }\n\n  payBill() {\n    this.setState({\n      payBill: true\n    });\n  }\n\n  cancelModal() {\n    this.setState({\n      payBill: false\n    });\n  }\n\n  sendSMS() {\n    let data = this.props.item;\n    let dataForNotif = {\n      'bill': data.bill,\n      'parent': data.student.student_parents[0].parent.profile.user\n    };\n    this.props.dispatch(invoiceNotificationWithSMS(dataForNotif));\n  }\n\n  SendMail() {\n    let data = this.props.item;\n    let dataForNotif = {\n      'service_v2': data.service_v2,\n      'bill': data.bill,\n      'parent': data.student.student_parents[0].parent.profile.user\n    };\n    this.props.dispatch(invoiceNotificationWithMail(dataForNotif));\n  }\n\n  handleDetails() {\n    this.setState({\n      openDetails: true\n    });\n  }\n\n  handleCancelDetails() {\n    this.setState({\n      openDetails: false\n    });\n  } ///// Générer une facture //////////////////\n\n\n  /////////////////////////////////////////\n  render() {\n    const {\n      classes\n    } = this.props;\n    let element = this.props.item;\n    let statusInvoice = this.props.item.bill.status;\n    const statusStyle = statusInvoice === unpaidInvoice ? \"text-white bg-danger\" : statusInvoice === partiallyPaidInvoice ? \"bg-amber\" : statusInvoice === billPaid ? \"text-white bg-success\" : \"text-white bg-warning\";\n    const status = statusInvoice === unpaidInvoice ? /*#__PURE__*/React.createElement(IntlMessages, {\n      id: \"filter.unpaid.service\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 10\n      }\n    }) : statusInvoice === partiallyPaidInvoice ? /*#__PURE__*/React.createElement(IntlMessages, {\n      id: \"invoice.partially.paid\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 12\n      }\n    }) : statusInvoice === billPaid ? /*#__PURE__*/React.createElement(IntlMessages, {\n      id: \"filter.paid.service\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 14\n      }\n    }) : /*#__PURE__*/React.createElement(IntlMessages, {\n      id: \"invoice.late\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 14\n      }\n    });\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \" row col-lg-12 col-md-12 pt-2 d-flex justify-content-center alignement-items-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"d-flex flex-row col-lg-12 col-md-12 justify-content-start align-items-center \",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(AppBar, {\n      position: \"relative\",\n      style: {\n        borderTopRightRadius: \"80px\",\n        borderBottomRightRadius: \"80px\",\n        borderTopLeftRadius: \"80px\",\n        borderBottomLeftRadius: \"80px\",\n        border: \"1px solid #abada8\",\n        height: \"100%\",\n        backgroundColor: \"#4a3ea3\",\n        fontSize: \"15px\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Tabs, {\n      value: false,\n      onChange: this.handleChange,\n      variant: \"scrollable\",\n      scrollButtons: \"on\",\n      textColor: \"primary\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Tab, {\n      style: {\n        width: \"45%\",\n        textColor: \"#FFFFFF\"\n      },\n      icon: /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          textAlign: \"left\"\n        },\n        className: classes.textColorPrimary,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 219,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(\"h3\", {\n        style: {\n          marginBottom: \"0px\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 21\n        }\n      }, element.bill.reference)),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 15\n      }\n    }), this.props.month == \"\" ? /*#__PURE__*/React.createElement(Tab, {\n      style: {\n        backgroundColor: \"#FFFFFF\"\n      },\n      icon: /*#__PURE__*/React.createElement(\"h3\", {\n        style: {\n          marginBottom: \"0px\",\n          fontSize: \"15px\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 229,\n          columnNumber: 21\n        }\n      }, element.bill.generation_date.slice(0, 10)),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 17\n      }\n    }) : \"\", /*#__PURE__*/React.createElement(Tab, {\n      style: {\n        backgroundColor: \"#FFFFFF\",\n        minWidth: \"10px\"\n      },\n      icon: /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          borderWidth: \"thin\",\n          borderStyle: \"solid\",\n          borderColor: \"#979A9A\",\n          height: \"30px\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 238,\n          columnNumber: 19\n        }\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 15\n      }\n    }), /*#__PURE__*/React.createElement(Tab, {\n      style: {\n        backgroundColor: \"#FFFFFF\",\n        minWidth: \"260px\"\n      },\n      icon: /*#__PURE__*/React.createElement(\"h3\", {\n        style: {\n          marginBottom: \"0px\",\n          fontSize: \"15px\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 251,\n          columnNumber: 19\n        }\n      }, \" \", element.student.student_parents[0].parent.profile.user.name + \" \" + element.student.student_parents[0].parent.profile.user.surname),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 248,\n        columnNumber: 15\n      }\n    }), /*#__PURE__*/React.createElement(Tab, {\n      style: {\n        backgroundColor: \"#FFFFFF\",\n        minWidth: \"10px\"\n      },\n      icon: /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          borderWidth: \"thin\",\n          borderStyle: \"solid\",\n          borderColor: \"#979A9A\",\n          height: \"30px\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 261,\n          columnNumber: 19\n        }\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 258,\n        columnNumber: 15\n      }\n    }), /*#__PURE__*/React.createElement(Tab, {\n      style: {\n        backgroundColor: \"#FFFFFF\",\n        minWidth: \"250px\"\n      },\n      icon: /*#__PURE__*/React.createElement(\"h3\", {\n        style: {\n          marginBottom: \"0px\",\n          fontSize: \"15px\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 274,\n          columnNumber: 19\n        }\n      }, \" Montant : \", element.bill.total_incl_tax),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 271,\n        columnNumber: 15\n      }\n    }), /*#__PURE__*/React.createElement(Tab, {\n      style: {\n        backgroundColor: \"#FFFFFF\",\n        minWidth: \"10px\"\n      },\n      icon: /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          borderWidth: \"thin\",\n          borderStyle: \"solid\",\n          borderColor: \"#979A9A\",\n          height: \"30px\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 282,\n          columnNumber: 19\n        }\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 279,\n        columnNumber: 15\n      }\n    }), /*#__PURE__*/React.createElement(Tab, {\n      style: {\n        backgroundColor: \"#FFFFFF\",\n        minWidth: \"200px\"\n      },\n      icon: /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          marginBottom: \"0px\"\n        },\n        className: ` badge text-uppercase ${statusStyle}`,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 295,\n          columnNumber: 19\n        }\n      }, status),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 292,\n        columnNumber: 15\n      }\n    }), /*#__PURE__*/React.createElement(Tab, {\n      style: {\n        backgroundColor: \"#FFFFFF\",\n        minWidth: \"10px\"\n      },\n      icon: /*#__PURE__*/React.createElement(\"div\", {\n        className: \"d-flex\",\n        style: {\n          borderWidth: \"thin\",\n          borderStyle: \"solid\",\n          borderColor: \"#979A9A\",\n          height: \"30px\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 304,\n          columnNumber: 19\n        }\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 301,\n        columnNumber: 15\n      }\n    }), /*#__PURE__*/React.createElement(Tab, {\n      style: {\n        backgroundColor: \"#FFFFFF\",\n        minWidth: \"200px\"\n      },\n      icon: /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 318,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        size: \"small\",\n        className: \" zmdi zmdi-download zmdi-hc-2x\",\n        style: {\n          color: \"text-grey\",\n          marginRight: \"5px\",\n          marginLeft: \"5px\"\n        },\n        onClick: this.jsPdfGenerator,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 319,\n          columnNumber: 21\n        }\n      }), /*#__PURE__*/React.createElement(\"i\", {\n        className: \"zmdi zmdi-eye zmdi-hc-2x\",\n        style: {\n          color: \"text-grey\",\n          marginRight: \"5px\",\n          marginLeft: \"5px\"\n        },\n        onClick: this.handleDetails,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 329,\n          columnNumber: 21\n        }\n      }), /*#__PURE__*/React.createElement(\"i\", {\n        className: \"zmdi zmdi-email zmdi-hc-2x\",\n        style: {\n          color: \"text-grey\",\n          marginRight: \"5px\",\n          marginLeft: \"5px\"\n        },\n        onClick: this.SendMail,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 338,\n          columnNumber: 21\n        }\n      }), /*#__PURE__*/React.createElement(\"i\", {\n        className: \"zmdi zmdi-smartphone-android zmdi-hc-2x\",\n        style: {\n          color: \"text-grey\",\n          marginRight: \"5px\",\n          marginLeft: \"5px\"\n        },\n        onClick: this.sendSMS,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 347,\n          columnNumber: 21\n        }\n      })),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 315,\n        columnNumber: 15\n      }\n    }), this.props.item.bill.status !== billPaid ? /*#__PURE__*/React.createElement(Tab, {\n      icon: /*#__PURE__*/React.createElement(\"p\", {\n        onClick: this.payBill,\n        className: \" mt-auto mb-0 pointer\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 362,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        className: classes.textColorPrimary,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 363,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(IntlMessages, {\n        id: \"button.proceedToThePayment\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 363,\n          columnNumber: 64\n        }\n      }))),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 360,\n        columnNumber: 17\n      }\n    }) : \"\"))), /*#__PURE__*/React.createElement(DetailsBill, {\n      data: element,\n      openDetail: this.state.openDetails,\n      cancel: this.handleCancelDetails,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 371,\n        columnNumber: 9\n      }\n    }), this.state.payBill ? /*#__PURE__*/React.createElement(PayBill, {\n      cancelModal: this.cancelModal,\n      invoice: this.props.item,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 377,\n        columnNumber: 31\n      }\n    }) : \" \");\n  }\n\n}\nexport default withStyles(styles)(connect()(BillItem));","map":{"version":3,"sources":["/home/oem/Documents/projects/educap/classebook-front-web/src/app/routes/FinancialManagement/routes/Billing/BillItem.js"],"names":["React","Component","AppBar","Tabs","Tab","IntlMessages","jsPDF","DetailsBill","invoiceNotificationWithMail","invoiceNotificationWithSMS","connect","PayBill","unpaidInvoice","partiallyPaidInvoice","billPaid","lateInvoice","url","withStyles","styles","theme","textColorPrimary","color","BillItem","constructor","props","jsPdfGenerator","bill","item","doc","imgData","addImage","setFontType","setTextColor","text","reference","student","student_parents","parent","profile","user","name","surname","address","zip_code","class","columns","rows","rowsDynamiq","service_v2","map","element","push","id","name_fr_service","price_service","vat_service","total_excl_tax","total_vat","total_incl_tax","autoTable","margin","top","save","state","openDetails","payBill","handleDetails","bind","handleCancelDetails","SendMail","sendSMS","cancelModal","setState","data","dataForNotif","dispatch","render","classes","statusInvoice","status","statusStyle","borderTopRightRadius","borderBottomRightRadius","borderTopLeftRadius","borderBottomLeftRadius","border","height","backgroundColor","fontSize","handleChange","width","textColor","textAlign","marginBottom","month","generation_date","slice","minWidth","borderWidth","borderStyle","borderColor","marginRight","marginLeft"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport AppBar from \"@material-ui/core/AppBar\";\nimport Tabs from \"@material-ui/core/Tabs\";\nimport Tab from \"@material-ui/core/Tab\";\nimport IntlMessages from \"../../../../../util/IntlMessages\";\nimport \"jspdf-autotable\";\nimport jsPDF from \"jspdf\";\nimport DetailsBill from \"./DetailsBill\";\nimport { invoiceNotificationWithMail, invoiceNotificationWithSMS } from '../../../../../actions/BillAction';\nimport { connect } from 'react-redux';\nimport PayBill from '../Payment/PayBill'\nimport { unpaidInvoice, partiallyPaidInvoice, billPaid, lateInvoice } from '../../../../../config/config'\nimport { url } from \"../ServiceAllocation/photo\";\nimport { withStyles } from '@material-ui/core/styles';\n\nconst styles = theme => ({\n  textColorPrimary: {\n    color: \"#FFFFFF\",\n  }\n})\n\nexport class BillItem extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      openDetails: false,\n      payBill: false,\n    };\n\n    this.handleDetails = this.handleDetails.bind(this);\n    this.handleCancelDetails = this.handleCancelDetails.bind(this);\n    this.SendMail = this.SendMail.bind(this);\n    this.sendSMS = this.sendSMS.bind(this);\n    this.payBill = this.payBill.bind(this);\n    this.cancelModal = this.cancelModal.bind(this);\n\n  }\n  payBill() {\n    this.setState({ payBill: true })\n\n  }\n  cancelModal() { this.setState({ payBill: false }) };\n\n  sendSMS() {\n    let data = this.props.item\n    let dataForNotif = {\n      'bill': data.bill,\n      'parent': data.student.student_parents[0].parent.profile.user\n    }\n    this.props.dispatch(invoiceNotificationWithSMS(dataForNotif))\n\n  }\n  SendMail() {\n    let data = this.props.item\n    let dataForNotif = {\n      'service_v2': data.service_v2,\n      'bill': data.bill,\n      'parent': data.student.student_parents[0].parent.profile.user\n    }\n    this.props.dispatch(invoiceNotificationWithMail(dataForNotif))\n\n  }\n\n  handleDetails() {\n    this.setState({ openDetails: true });\n  }\n\n  handleCancelDetails() {\n    this.setState({ openDetails: false });\n  }\n\n  ///// Générer une facture //////////////////\n\n  jsPdfGenerator = () => {\n    let bill = this.props.item;\n    var doc = new jsPDF(\"p\", \"pt\", \"a4\", true);\n    var imgData = url;\n\n    doc.addImage(imgData, \"JPEG\", 485, 20, 80, 80);\n    doc.setFontType(\"bold\");\n    doc.setTextColor(0, 0, 255);\n    doc.text(20, 50, \"Facture N°: \" + bill.bill.reference);\n    doc.text(350, 50, \"2020/2021\");\n\n    doc.setFontType(\"times\");\n    doc.setTextColor(0, 0, 0);\n    doc.text(\n      350,\n      140,\n      \"M. ou Mme \" +\n      bill.student.student_parents[0].parent.profile.user.name +\n      \" \" +\n      bill.student.student_parents[0].parent.profile.user.surname\n    );\n    doc.text(\n      350,\n      160,\n      \"adresse : \" + bill.student.student_parents[0].parent.profile.user.address\n    );\n    doc.text(\n      350,\n      180,\n      \"Code Postal : \" +\n      bill.student.student_parents[0].parent.profile.user.zip_code\n    );\n    // doc.text(350, 200, 'Rue : Cyber Parc ,Sousse');\n    // doc.text(350, 220, 'Tel:+216 *******');\n\n    doc.text(20, 140, \"De ADN EXPERTISE \");\n    doc.text(20, 160, \"Rue : Cyber Parc ,Sousse\");\n    doc.text(20, 180, \"Tel:+216 *******\");\n    doc.text(20, 200, \"Email: Adn-Expertise@gmail.com\");\n\n    doc.setFontType(\"bold\");\n    doc.text(20, 240, \"Facture des prestations:\");\n    doc.setFontType(\"times\");\n    doc.text(\n      20,\n      260,\n      \" L'élève \" +\n      bill.student.profile.user.name +\n      \" \" +\n      bill.student.profile.user.surname +\n      \" ( \" +\n      bill.student.class.name +\n      \" )\"\n    );\n\n    var columns = [\n      \"ID\",\n      \"Description\",\n      \"Quantité\",\n      \"Prix unitaire HT\",\n      \"TVA\",\n      \"TOTAL TTC\",\n    ];\n    var rows = [\n      [1, \"Bus\", \"3\", \"15 DT\", \"6 DT\", \"21 DT\"],\n      [2, \"Cantine\", \"3\", \"30 DT\", \"6DT\", \"36 DT\"],\n      [3, \"Inscription\", \"1\", \"100 DT\", \"20 DT\", \"120 DT\"],\n      [, \"\", \"\", \"\", \"\"],\n      [, \"\", \"\", \"\", \"Total HT\", \"200 DT\"],\n      [, \"\", \"\", \"\", \"TVA\", \"20 DT\"],\n      [, \"\", \"\", \"\", \"Total TTC\", \"220 DT\"],\n    ];\n    var rowsDynamiq = [];\n\n    bill.service_v2.map((element) =>\n      rowsDynamiq.push([\n        element.id,\n        element.name_fr_service,\n        \"1\",\n        element.price_service,\n        element.vat_service + \" %\",\n        (element.price_service * (element.vat_service + 100)) / 100,\n      ])\n    );\n\n    rowsDynamiq.push([, \"\", \"\", \"\", \"\"]);\n    rowsDynamiq.push([, \"\", \"\", \"\", \"Total HT\", bill.bill.total_excl_tax]);\n    rowsDynamiq.push([, \"\", \"\", \"\", \"TVA\", bill.bill.total_vat + \" %\"]);\n    rowsDynamiq.push([, \"\", \"\", \"\", \"Total TTC\", bill.bill.total_incl_tax]);\n\n    doc.autoTable(columns, rowsDynamiq, { margin: { top: 300 } });\n\n    doc.save(bill.bill.reference);\n  };\n  /////////////////////////////////////////\n  render() {\n    const { classes } = this.props;\n    let element = this.props.item;\n    let statusInvoice = this.props.item.bill.status\n    const statusStyle = (statusInvoice === unpaidInvoice)\n      ? \"text-white bg-danger\"\n      : (statusInvoice === partiallyPaidInvoice)\n        ? \"bg-amber\"\n        : (statusInvoice === billPaid)\n          ? \"text-white bg-success\"\n          : \"text-white bg-warning\"\n\n    const status = (statusInvoice === unpaidInvoice)\n      ? (<IntlMessages id=\"filter.unpaid.service\" />)\n      : (statusInvoice === partiallyPaidInvoice)\n        ? (<IntlMessages id=\"invoice.partially.paid\" />)\n        : (statusInvoice === billPaid)\n          ? (<IntlMessages id=\"filter.paid.service\" />)\n          : (<IntlMessages id=\"invoice.late\" />);\n\n    return (\n      <div className=\" row col-lg-12 col-md-12 pt-2 d-flex justify-content-center alignement-items-center\">\n        <div className=\"d-flex flex-row col-lg-12 col-md-12 justify-content-start align-items-center \" >\n\n          <AppBar\n            position=\"relative\"\n            style={{\n              borderTopRightRadius: \"80px\",\n              borderBottomRightRadius: \"80px\",\n              borderTopLeftRadius: \"80px\",\n              borderBottomLeftRadius: \"80px\",\n              border: \"1px solid #abada8\",\n              height: \"100%\",\n              backgroundColor: \"#4a3ea3\",\n              fontSize: \"15px\",\n            }}\n          >\n            <Tabs\n              value={false}\n              onChange={this.handleChange}\n              variant=\"scrollable\"\n              scrollButtons=\"on\"\n              textColor=\"primary\"\n\n            >\n              <Tab\n                style={{ width: \"45%\", textColor: \"#FFFFFF\" }}\n                icon={\n\n                  <div style={{ textAlign: \"left\" }} className={classes.textColorPrimary} >\n                    <h3 style={{ marginBottom: \"0px\" }}>{element.bill.reference}</h3>\n                  </div>\n                }\n              />\n\n              {this.props.month == \"\" ? (\n                <Tab\n                  style={{ backgroundColor: \"#FFFFFF\" }}\n                  icon={\n                    <h3 style={{ marginBottom: \"0px\", fontSize: \"15px\" }}>{element.bill.generation_date.slice(0, 10)}</h3>\n                  }\n                />\n              ) : (\n                  \"\"\n                )}\n              <Tab\n                style={{ backgroundColor: \"#FFFFFF\", minWidth: \"10px\" }}\n                icon={\n                  <div\n                    style={{\n                      borderWidth: \"thin\",\n                      borderStyle: \"solid\",\n                      borderColor: \"#979A9A\",\n                      height: \"30px\",\n                    }}\n                  ></div>\n                }\n              />\n              <Tab\n                style={{ backgroundColor: \"#FFFFFF\", minWidth: \"260px\" }}\n                icon={\n                  <h3 style={{ marginBottom: \"0px\", fontSize: \"15px\" }}> {element.student.student_parents[0].parent.profile.user\n                    .name +\n                    \" \" +\n                    element.student.student_parents[0].parent.profile.user\n                      .surname}</h3>\n                }\n              />\n              <Tab\n                style={{ backgroundColor: \"#FFFFFF\", minWidth: \"10px\" }}\n                icon={\n                  <div\n                    style={{\n                      borderWidth: \"thin\",\n                      borderStyle: \"solid\",\n                      borderColor: \"#979A9A\",\n                      height: \"30px\",\n                    }}\n                  ></div>\n                }\n              />\n              <Tab\n                style={{ backgroundColor: \"#FFFFFF\", minWidth: \"250px\" }}\n                icon={\n                  <h3 style={{ marginBottom: \"0px\", fontSize: \"15px\" }}> Montant : {element.bill.total_incl_tax}</h3>\n                }\n              />\n\n\n              <Tab\n                style={{ backgroundColor: \"#FFFFFF\", minWidth: \"10px\" }}\n                icon={\n                  <div\n                    style={{\n                      borderWidth: \"thin\",\n                      borderStyle: \"solid\",\n                      borderColor: \"#979A9A\",\n                      height: \"30px\",\n                    }}\n                  ></div>\n                }\n              />\n              <Tab\n                style={{ backgroundColor: \"#FFFFFF\", minWidth: \"200px\" }}\n                icon={\n                  <div style={{ marginBottom: \"0px\" }} className={` badge text-uppercase ${statusStyle}`}>\n                    {status}\n                  </div>\n                }\n              />\n\n              <Tab\n                style={{ backgroundColor: \"#FFFFFF\", minWidth: \"10px\" }}\n                icon={\n                  <div\n                    className=\"d-flex\"\n                    style={{\n                      borderWidth: \"thin\",\n                      borderStyle: \"solid\",\n                      borderColor: \"#979A9A\",\n                      height: \"30px\",\n                    }}\n                  ></div>\n                }\n              />\n              <Tab\n                style={{ backgroundColor: \"#FFFFFF\", minWidth: \"200px\" }}\n                icon={\n                  <div>\n                    <i\n                      size=\"small\"\n                      className=\" zmdi zmdi-download zmdi-hc-2x\"\n                      style={{\n                        color: \"text-grey\",\n                        marginRight: \"5px\",\n                        marginLeft: \"5px\",\n                      }}\n                      onClick={this.jsPdfGenerator}\n                    />\n                    <i\n                      className=\"zmdi zmdi-eye zmdi-hc-2x\"\n                      style={{\n                        color: \"text-grey\",\n                        marginRight: \"5px\",\n                        marginLeft: \"5px\",\n                      }}\n                      onClick={this.handleDetails}\n                    />\n                    <i\n                      className=\"zmdi zmdi-email zmdi-hc-2x\"\n                      style={{\n                        color: \"text-grey\",\n                        marginRight: \"5px\",\n                        marginLeft: \"5px\",\n                      }}\n                      onClick={this.SendMail}\n                    />\n                    <i\n                      className=\"zmdi zmdi-smartphone-android zmdi-hc-2x\"\n                      style={{\n                        color: \"text-grey\",\n                        marginRight: \"5px\",\n                        marginLeft: \"5px\",\n                      }}\n                      onClick={this.sendSMS}\n                    />\n                  </div>\n                }\n              />\n              {this.props.item.bill.status !== billPaid ? (\n                <Tab\n                  icon={\n                    <p onClick={this.payBill} className=\" mt-auto mb-0 pointer\" >\n                      <b className={classes.textColorPrimary}>{<IntlMessages id=\"button.proceedToThePayment\" />}</b>\n                    </p>\n                  }\n                />\n              ) : \"\"}\n            </Tabs>\n          </AppBar>\n        </div>\n        <DetailsBill\n          data={element}\n          openDetail={this.state.openDetails}\n          cancel={this.handleCancelDetails}\n        />\n\n        {this.state.payBill ? <PayBill cancelModal={this.cancelModal} invoice={this.props.item} /> : \" \"}\n      </div>\n    );\n  }\n}\n\nexport default withStyles(styles)(connect()(BillItem));\n"]},"metadata":{},"sourceType":"module"}