{"ast":null,"code":"import baseUrl from \"../config/config\";\nimport axios from \"axios\";\nimport { FETCH_ALL_ROLE, ADD_USER, GET_ALL_USERS_FOR_ADMIN, GET_ALL_USERS_FOR_SUPER_ADMIN, EDIT_USER, DELETE_USER, SHOW_ERROR_MESSAGE, HIDE_ERROR_MESSAGE, HIDE_SUCCESS_MESSAGE, SHOW_SUCCESS_MESSAGE, HIDE_WARNING_MESSAGE, SHOW_WARNING_MESSAGE, SHOW_LOADER, HIDE_LOADER } from \"../constants/ActionTypes\";\nimport _ from \"lodash\";\nimport { getError } from \"../Error/Error\";\nimport { classService } from \"../_services/class.service\";\nimport { roleIdStudent } from \"../config/config\";\nexport function getAllRole() {\n  return function (dispatch) {\n    axios.get(`${baseUrl.baseUrl}/roles?access_token=${localStorage.token}`).then(res => {\n      dispatch({\n        type: FETCH_ALL_ROLE,\n        payload: res.data\n      });\n    });\n  };\n}\nexport function getAllUsersForAdmin(establishmentId, schoolYearId) {\n  return function (dispatch) {\n    axios.get(`${baseUrl.baseUrl}/users/${establishmentId}/${schoolYearId}?access_token=${localStorage.token}`).then(res => {\n      console.log(\"res\", res.data);\n      dispatch({\n        type: GET_ALL_USERS_FOR_ADMIN,\n        payload: res.data.users\n      });\n    });\n  };\n}\nexport function getAllUsersForSuperAdministrator() {\n  return function (dispatch) {\n    axios.get(`${baseUrl.baseUrl}/users?access_token=${localStorage.token}`).then(res => {\n      console.log(\"res\", res.data);\n      dispatch({\n        type: GET_ALL_USERS_FOR_SUPER_ADMIN,\n        payload: res.data\n      });\n    });\n  };\n}\nexport const addUsers = data => {\n  return dispatch => {\n    let dataUser = {\n      name: data.name,\n      surname: data.surname,\n      gender: data.gender,\n      dateOfBirth: data.dateOfBirth,\n      address: data.address,\n      phone: data.phone,\n      cin: data.cin,\n      zipCode: data.zipCode,\n      country: data.userCountry,\n      photo: data.photo,\n      name_ar: data.name_ar,\n      surname_ar: data.surname_ar,\n      creation_date: new Date(),\n      nationality: data.nationality,\n      placeOfBirth: data.placeOfBirth,\n      email: data.email,\n      roleId: data.roleId,\n      establishmentId: data.establishmentId,\n      assignClassSubject: data.assignClassSubject,\n      classId: data.studentClass,\n      schoolYearId: data.schoolyearId,\n      paperFiles: null,\n      creation_date: Date(),\n      functionName: data.functionName,\n      password: data.password,\n      login: data.login\n    };\n    let apiEndpoint = `/users/createByRole?access_token=${localStorage.token}`;\n    classService.post(apiEndpoint, dataUser).then(response => {\n      let userId = response.data.existe.userData.id;\n\n      if (data.userPhoto.name != undefined) {\n        let photoUser = data.userPhoto;\n        var object = {};\n        object.file = photoUser;\n        object.fileName = \"user\" + userId;\n        const myNewFile = new File([object.file], photoUser.name, {\n          type: object.file.type\n        });\n        let formadata = new FormData();\n        formadata.append(\"file\", myNewFile);\n        dispatch({\n          type: SHOW_LOADER,\n          payload: true\n        });\n        const photoUrl = `${baseUrl.baseUrl}/containers/classebook.data.storage/upload?access_token=${localStorage.token}`;\n        axios({\n          url: photoUrl,\n          method: \"POST\",\n          data: formadata\n        }).then(response => {\n          let urlPhotoUser = `${baseUrl.baseUrl}/users/` + userId + `?access_token=${localStorage.token}`;\n          axios.patch(urlPhotoUser, {\n            id: userId,\n            photo: response.data.result.files.file[0].providerResponse.location\n          }).then(response => {\n            if (response) {\n              console.log(\"response photo\", response);\n            } else {\n              console.log(response.data, \"photo not upload\");\n            }\n          });\n        });\n      }\n\n      if (response && data.userPapiersFiles.length > 0) {\n        let formadata = new FormData();\n        data.userPapiersFiles.map((element, index) => {\n          let userPapiersFile = element;\n          const fileExtension = userPapiersFile.name.replace(/^.*\\./, \"\");\n          const fileName = \"userPapiersfile\" + userId + index + String(Date.now()).slice(-2) + \".\" + fileExtension;\n          var object = {};\n          object.file = userPapiersFile;\n          object.fileName = fileName;\n          const myNewFile = new File([object.file], fileName, {\n            type: object.file.type\n          });\n          formadata.append(\"file\", myNewFile);\n        });\n        let filesURL = [];\n        const URLUserPapiersFiles = `${baseUrl.baseUrl}/containers/classebook.data.storage/upload?access_token=${localStorage.token}`;\n        axios({\n          url: URLUserPapiersFiles,\n          method: \"POST\",\n          data: formadata\n        }).then(response => {\n          if (response) {\n            filesURL = response.data.result.files.file.map((urlFile, index) => {\n              return urlFile.providerResponse.location;\n            });\n            let urlPhotoUser = `${baseUrl.baseUrl}/users/` + userId + `?access_token=${localStorage.token}`;\n            axios.patch(urlPhotoUser, {\n              id: userId,\n              paper_files: filesURL\n            }).then(response => {\n              if (response) {\n                console.log(\"response photo\", response);\n              } else {\n                console.log(response.data, \"photo not upload\");\n              }\n            });\n          }\n        }).catch(err => {});\n      } else if (!response) {\n        console.log(\"ereeeu\", response);\n        dispatch({\n          type: SHOW_ERROR_MESSAGE,\n          payload: \"Une erreur est survenue lors de la création merci d'essayer à nouveau\"\n        });\n        setTimeout(() => {\n          dispatch({\n            type: HIDE_ERROR_MESSAGE\n          });\n        }, 4000);\n      }\n    });\n  };\n};","map":{"version":3,"sources":["/home/oem/Documents/projects/educap/classebook-front-web/src/actions/usersAction.js"],"names":["baseUrl","axios","FETCH_ALL_ROLE","ADD_USER","GET_ALL_USERS_FOR_ADMIN","GET_ALL_USERS_FOR_SUPER_ADMIN","EDIT_USER","DELETE_USER","SHOW_ERROR_MESSAGE","HIDE_ERROR_MESSAGE","HIDE_SUCCESS_MESSAGE","SHOW_SUCCESS_MESSAGE","HIDE_WARNING_MESSAGE","SHOW_WARNING_MESSAGE","SHOW_LOADER","HIDE_LOADER","_","getError","classService","roleIdStudent","getAllRole","dispatch","get","localStorage","token","then","res","type","payload","data","getAllUsersForAdmin","establishmentId","schoolYearId","console","log","users","getAllUsersForSuperAdministrator","addUsers","dataUser","name","surname","gender","dateOfBirth","address","phone","cin","zipCode","country","userCountry","photo","name_ar","surname_ar","creation_date","Date","nationality","placeOfBirth","email","roleId","assignClassSubject","classId","studentClass","schoolyearId","paperFiles","functionName","password","login","apiEndpoint","post","response","userId","existe","userData","id","userPhoto","undefined","photoUser","object","file","fileName","myNewFile","File","formadata","FormData","append","photoUrl","url","method","urlPhotoUser","patch","result","files","providerResponse","location","userPapiersFiles","length","map","element","index","userPapiersFile","fileExtension","replace","String","now","slice","filesURL","URLUserPapiersFiles","urlFile","paper_files","catch","err","setTimeout"],"mappings":"AAAA,OAAOA,OAAP,MAAoB,kBAApB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SACEC,cADF,EAEEC,QAFF,EAGEC,uBAHF,EAIEC,6BAJF,EAKEC,SALF,EAMEC,WANF,EAOEC,kBAPF,EAQEC,kBARF,EASEC,oBATF,EAUEC,oBAVF,EAWEC,oBAXF,EAYEC,oBAZF,EAaEC,WAbF,EAcEC,WAdF,QAeO,0BAfP;AAgBA,OAAOC,CAAP,MAAc,QAAd;AACA,SAASC,QAAT,QAAyB,gBAAzB;AACA,SAASC,YAAT,QAA6B,4BAA7B;AACA,SAASC,aAAT,QAA8B,kBAA9B;AAEA,OAAO,SAASC,UAAT,GAAsB;AAC3B,SAAO,UAASC,QAAT,EAAmB;AACxBpB,IAAAA,KAAK,CACFqB,GADH,CACQ,GAAEtB,OAAO,CAACA,OAAQ,uBAAsBuB,YAAY,CAACC,KAAM,EADnE,EAEGC,IAFH,CAESC,GAAD,IAAS;AACbL,MAAAA,QAAQ,CAAC;AAAEM,QAAAA,IAAI,EAAEzB,cAAR;AAAwB0B,QAAAA,OAAO,EAAEF,GAAG,CAACG;AAArC,OAAD,CAAR;AACD,KAJH;AAKD,GAND;AAOD;AACD,OAAO,SAASC,mBAAT,CAA6BC,eAA7B,EAA8CC,YAA9C,EAA4D;AACjE,SAAO,UAASX,QAAT,EAAmB;AACxBpB,IAAAA,KAAK,CACFqB,GADH,CACQ,GAAEtB,OAAO,CAACA,OAAQ,UAAS+B,eAAgB,IAAGC,YAAa,iBAAgBT,YAAY,CAACC,KAAM,EADtG,EAEGC,IAFH,CAESC,GAAD,IAAS;AACbO,MAAAA,OAAO,CAACC,GAAR,CAAY,KAAZ,EAAkBR,GAAG,CAACG,IAAtB;AACAR,MAAAA,QAAQ,CAAC;AAAEM,QAAAA,IAAI,EAAEvB,uBAAR;AAAiCwB,QAAAA,OAAO,EAAEF,GAAG,CAACG,IAAJ,CAASM;AAAnD,OAAD,CAAR;AACD,KALH;AAMD,GAPD;AAQD;AACD,OAAO,SAASC,gCAAT,GAA4C;AACjD,SAAO,UAASf,QAAT,EAAmB;AACxBpB,IAAAA,KAAK,CACFqB,GADH,CACQ,GAAEtB,OAAO,CAACA,OAAQ,uBAAsBuB,YAAY,CAACC,KAAM,EADnE,EAEGC,IAFH,CAESC,GAAD,IAAS;AACbO,MAAAA,OAAO,CAACC,GAAR,CAAY,KAAZ,EAAkBR,GAAG,CAACG,IAAtB;AACAR,MAAAA,QAAQ,CAAC;AAAEM,QAAAA,IAAI,EAAEtB,6BAAR;AAAuCuB,QAAAA,OAAO,EAAEF,GAAG,CAACG;AAApD,OAAD,CAAR;AACD,KALH;AAMD,GAPD;AAQD;AACD,OAAO,MAAMQ,QAAQ,GAAIR,IAAD,IAAU;AAChC,SAAQR,QAAD,IAAc;AACnB,QAAIiB,QAAQ,GAAG;AACbC,MAAAA,IAAI,EAAEV,IAAI,CAACU,IADE;AAEbC,MAAAA,OAAO,EAAEX,IAAI,CAACW,OAFD;AAGbC,MAAAA,MAAM,EAAEZ,IAAI,CAACY,MAHA;AAIbC,MAAAA,WAAW,EAAEb,IAAI,CAACa,WAJL;AAKbC,MAAAA,OAAO,EAAEd,IAAI,CAACc,OALD;AAMbC,MAAAA,KAAK,EAAEf,IAAI,CAACe,KANC;AAObC,MAAAA,GAAG,EAAEhB,IAAI,CAACgB,GAPG;AAQbC,MAAAA,OAAO,EAAEjB,IAAI,CAACiB,OARD;AASbC,MAAAA,OAAO,EAAClB,IAAI,CAACmB,WATA;AAUbC,MAAAA,KAAK,EAAEpB,IAAI,CAACoB,KAVC;AAWbC,MAAAA,OAAO,EAAErB,IAAI,CAACqB,OAXD;AAYbC,MAAAA,UAAU,EAAEtB,IAAI,CAACsB,UAZJ;AAabC,MAAAA,aAAa,EAAE,IAAIC,IAAJ,EAbF;AAcbC,MAAAA,WAAW,EAAEzB,IAAI,CAACyB,WAdL;AAebC,MAAAA,YAAY,EAAE1B,IAAI,CAAC0B,YAfN;AAgBbC,MAAAA,KAAK,EAAE3B,IAAI,CAAC2B,KAhBC;AAiBbC,MAAAA,MAAM,EAAE5B,IAAI,CAAC4B,MAjBA;AAkBb1B,MAAAA,eAAe,EAAEF,IAAI,CAACE,eAlBT;AAmBb2B,MAAAA,kBAAkB,EAAE7B,IAAI,CAAC6B,kBAnBZ;AAoBbC,MAAAA,OAAO,EAAE9B,IAAI,CAAC+B,YApBD;AAqBb5B,MAAAA,YAAY,EAAEH,IAAI,CAACgC,YArBN;AAsBbC,MAAAA,UAAU,EAAE,IAtBC;AAuBbV,MAAAA,aAAa,EAAEC,IAAI,EAvBN;AAwBbU,MAAAA,YAAY,EAAClC,IAAI,CAACkC,YAxBL;AAyBbC,MAAAA,QAAQ,EAACnC,IAAI,CAACmC,QAzBD;AA0BbC,MAAAA,KAAK,EAACpC,IAAI,CAACoC;AA1BE,KAAf;AA4BA,QAAIC,WAAW,GAAI,oCAAmC3C,YAAY,CAACC,KAAM,EAAzE;AACAN,IAAAA,YAAY,CAACiD,IAAb,CAAkBD,WAAlB,EAA+B5B,QAA/B,EAAyCb,IAAzC,CAA+C2C,QAAD,IAAc;AAC1D,UAAIC,MAAM,GAAGD,QAAQ,CAACvC,IAAT,CAAcyC,MAAd,CAAqBC,QAArB,CAA8BC,EAA3C;;AACA,UAAI3C,IAAI,CAAC4C,SAAL,CAAelC,IAAf,IAAuBmC,SAA3B,EAAsC;AACpC,YAAIC,SAAS,GAAG9C,IAAI,CAAC4C,SAArB;AACA,YAAIG,MAAM,GAAG,EAAb;AACAA,QAAAA,MAAM,CAACC,IAAP,GAAcF,SAAd;AACAC,QAAAA,MAAM,CAACE,QAAP,GAAkB,SAAST,MAA3B;AACA,cAAMU,SAAS,GAAG,IAAIC,IAAJ,CAAS,CAACJ,MAAM,CAACC,IAAR,CAAT,EAAwBF,SAAS,CAACpC,IAAlC,EAAwC;AACxDZ,UAAAA,IAAI,EAAEiD,MAAM,CAACC,IAAP,CAAYlD;AADsC,SAAxC,CAAlB;AAGA,YAAIsD,SAAS,GAAG,IAAIC,QAAJ,EAAhB;AACAD,QAAAA,SAAS,CAACE,MAAV,CAAiB,MAAjB,EAAyBJ,SAAzB;AACA1D,QAAAA,QAAQ,CAAC;AACPM,UAAAA,IAAI,EAAEb,WADC;AAEPc,UAAAA,OAAO,EAAE;AAFF,SAAD,CAAR;AAIA,cAAMwD,QAAQ,GAAI,GAAEpF,OAAO,CAACA,OAAQ,2DAA0DuB,YAAY,CAACC,KAAM,EAAjH;AACAvB,QAAAA,KAAK,CAAC;AACJoF,UAAAA,GAAG,EAAED,QADD;AAEJE,UAAAA,MAAM,EAAE,MAFJ;AAGJzD,UAAAA,IAAI,EAAEoD;AAHF,SAAD,CAAL,CAIGxD,IAJH,CAIS2C,QAAD,IAAc;AACnB,cAAImB,YAAY,GACd,GAAEvF,OAAO,CAACA,OAAQ,SAAnB,GACAqE,MADA,GAEC,iBAAgB9C,YAAY,CAACC,KAAM,EAHrC;AAKDvB,UAAAA,KAAK,CACFuF,KADH,CACSD,YADT,EACuB;AACnBf,YAAAA,EAAE,EAAEH,MADe;AAEnBpB,YAAAA,KAAK,EACHmB,QAAQ,CAACvC,IAAT,CAAc4D,MAAd,CAAqBC,KAArB,CAA2Bb,IAA3B,CAAgC,CAAhC,EAAmCc,gBAAnC,CAAoDC;AAHnC,WADvB,EAMGnE,IANH,CAMS2C,QAAD,IAAc;AAClB,gBAAIA,QAAJ,EAAc;AACZnC,cAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ,EAA8BkC,QAA9B;AACD,aAFD,MAEO;AACLnC,cAAAA,OAAO,CAACC,GAAR,CAAYkC,QAAQ,CAACvC,IAArB,EAA2B,kBAA3B;AACD;AACF,WAZH;AAaD,SAvBD;AAwBD;;AACD,UAAIuC,QAAQ,IAAIvC,IAAI,CAACgE,gBAAL,CAAsBC,MAAtB,GAA+B,CAA/C,EAAkD;AAChD,YAAIb,SAAS,GAAG,IAAIC,QAAJ,EAAhB;AACArD,QAAAA,IAAI,CAACgE,gBAAL,CAAsBE,GAAtB,CAA0B,CAACC,OAAD,EAAUC,KAAV,KAAoB;AAC5C,cAAIC,eAAe,GAAGF,OAAtB;AACA,gBAAMG,aAAa,GAAGD,eAAe,CAAC3D,IAAhB,CAAqB6D,OAArB,CAA6B,OAA7B,EAAsC,EAAtC,CAAtB;AACA,gBAAMtB,QAAQ,GACZ,oBACAT,MADA,GAEA4B,KAFA,GAGAI,MAAM,CAAChD,IAAI,CAACiD,GAAL,EAAD,CAAN,CAAmBC,KAAnB,CAAyB,CAAC,CAA1B,CAHA,GAIA,GAJA,GAKAJ,aANF;AAOA,cAAIvB,MAAM,GAAG,EAAb;AACAA,UAAAA,MAAM,CAACC,IAAP,GAAcqB,eAAd;AACAtB,UAAAA,MAAM,CAACE,QAAP,GAAkBA,QAAlB;AACA,gBAAMC,SAAS,GAAG,IAAIC,IAAJ,CAAS,CAACJ,MAAM,CAACC,IAAR,CAAT,EAAwBC,QAAxB,EAAkC;AAClDnD,YAAAA,IAAI,EAAEiD,MAAM,CAACC,IAAP,CAAYlD;AADgC,WAAlC,CAAlB;AAGAsD,UAAAA,SAAS,CAACE,MAAV,CAAiB,MAAjB,EAAyBJ,SAAzB;AACD,SAjBD;AAmBA,YAAIyB,QAAQ,GAAG,EAAf;AAEA,cAAMC,mBAAmB,GAAI,GAAEzG,OAAO,CAACA,OAAQ,2DAA0DuB,YAAY,CAACC,KAAM,EAA5H;AACAvB,QAAAA,KAAK,CAAC;AACJoF,UAAAA,GAAG,EAAEoB,mBADD;AAEJnB,UAAAA,MAAM,EAAE,MAFJ;AAGJzD,UAAAA,IAAI,EAAEoD;AAHF,SAAD,CAAL,CAKGxD,IALH,CAKS2C,QAAD,IAAc;AAClB,cAAIA,QAAJ,EAAc;AACZoC,YAAAA,QAAQ,GAAGpC,QAAQ,CAACvC,IAAT,CAAc4D,MAAd,CAAqBC,KAArB,CAA2Bb,IAA3B,CAAgCkB,GAAhC,CACT,CAACW,OAAD,EAAUT,KAAV,KAAoB;AAClB,qBAAOS,OAAO,CAACf,gBAAR,CAAyBC,QAAhC;AACD,aAHQ,CAAX;AAKA,gBAAIL,YAAY,GACb,GAAEvF,OAAO,CAACA,OAAQ,SAAnB,GACAqE,MADA,GAEC,iBAAgB9C,YAAY,CAACC,KAAM,EAHtC;AAKAvB,YAAAA,KAAK,CACFuF,KADH,CACSD,YADT,EACuB;AACnBf,cAAAA,EAAE,EAAEH,MADe;AAEnBsC,cAAAA,WAAW,EAAEH;AAFM,aADvB,EAKG/E,IALH,CAKS2C,QAAD,IAAc;AAClB,kBAAIA,QAAJ,EAAc;AACZnC,gBAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ,EAA8BkC,QAA9B;AACD,eAFD,MAEO;AACLnC,gBAAAA,OAAO,CAACC,GAAR,CAAYkC,QAAQ,CAACvC,IAArB,EAA2B,kBAA3B;AACD;AACF,aAXH;AAYD;AACF,SA9BH,EA+BG+E,KA/BH,CA+BUC,GAAD,IAAS,CAAE,CA/BpB;AAgCD,OAxDD,MAwDO,IAAI,CAACzC,QAAL,EAAe;AACpBnC,QAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ,EAAsBkC,QAAtB;AACA/C,QAAAA,QAAQ,CAAC;AACPM,UAAAA,IAAI,EAAEnB,kBADC;AAEPoB,UAAAA,OAAO,EACL;AAHK,SAAD,CAAR;AAKAkF,QAAAA,UAAU,CAAC,MAAM;AACfzF,UAAAA,QAAQ,CAAC;AAAEM,YAAAA,IAAI,EAAElB;AAAR,WAAD,CAAR;AACD,SAFS,EAEP,IAFO,CAAV;AAGD;AACF,KA7GD;AA8GD,GA5ID;AA6ID,CA9IM","sourcesContent":["import baseUrl from \"../config/config\";\nimport axios from \"axios\";\nimport {\n  FETCH_ALL_ROLE,\n  ADD_USER,\n  GET_ALL_USERS_FOR_ADMIN,\n  GET_ALL_USERS_FOR_SUPER_ADMIN,\n  EDIT_USER,\n  DELETE_USER,\n  SHOW_ERROR_MESSAGE,\n  HIDE_ERROR_MESSAGE,\n  HIDE_SUCCESS_MESSAGE,\n  SHOW_SUCCESS_MESSAGE,\n  HIDE_WARNING_MESSAGE,\n  SHOW_WARNING_MESSAGE,\n  SHOW_LOADER,\n  HIDE_LOADER,\n} from \"../constants/ActionTypes\";\nimport _ from \"lodash\";\nimport { getError } from \"../Error/Error\";\nimport { classService } from \"../_services/class.service\";\nimport { roleIdStudent } from \"../config/config\";\n\nexport function getAllRole() {\n  return function(dispatch) {\n    axios\n      .get(`${baseUrl.baseUrl}/roles?access_token=${localStorage.token}`)\n      .then((res) => {\n        dispatch({ type: FETCH_ALL_ROLE, payload: res.data });\n      });\n  };\n}\nexport function getAllUsersForAdmin(establishmentId, schoolYearId) {\n  return function(dispatch) {\n    axios\n      .get(`${baseUrl.baseUrl}/users/${establishmentId}/${schoolYearId}?access_token=${localStorage.token}`)\n      .then((res) => {\n        console.log(\"res\",res.data);\n        dispatch({ type: GET_ALL_USERS_FOR_ADMIN, payload: res.data.users});\n      });\n  };\n}\nexport function getAllUsersForSuperAdministrator() {\n  return function(dispatch) {\n    axios\n      .get(`${baseUrl.baseUrl}/users?access_token=${localStorage.token}`)\n      .then((res) => {\n        console.log(\"res\",res.data);\n        dispatch({ type: GET_ALL_USERS_FOR_SUPER_ADMIN, payload: res.data});\n      });\n  };\n}\nexport const addUsers = (data) => {\n  return (dispatch) => {\n    let dataUser = {\n      name: data.name,\n      surname: data.surname,\n      gender: data.gender,\n      dateOfBirth: data.dateOfBirth,\n      address: data.address,\n      phone: data.phone,\n      cin: data.cin,\n      zipCode: data.zipCode,\n      country:data.userCountry,\n      photo: data.photo,\n      name_ar: data.name_ar,\n      surname_ar: data.surname_ar,\n      creation_date: new Date(),\n      nationality: data.nationality,\n      placeOfBirth: data.placeOfBirth,\n      email: data.email,\n      roleId: data.roleId,\n      establishmentId: data.establishmentId,\n      assignClassSubject: data.assignClassSubject,\n      classId: data.studentClass,\n      schoolYearId: data.schoolyearId,\n      paperFiles: null,\n      creation_date: Date(),\n      functionName:data.functionName,\n      password:data.password,\n      login:data.login\n    };\n    let apiEndpoint = `/users/createByRole?access_token=${localStorage.token}`;\n    classService.post(apiEndpoint, dataUser).then((response) => {\n      let userId = response.data.existe.userData.id;\n      if (data.userPhoto.name != undefined) {\n        let photoUser = data.userPhoto;\n        var object = {};\n        object.file = photoUser;\n        object.fileName = \"user\" + userId;\n        const myNewFile = new File([object.file], photoUser.name, {\n          type: object.file.type,\n        });\n        let formadata = new FormData();\n        formadata.append(\"file\", myNewFile);\n        dispatch({\n          type: SHOW_LOADER,\n          payload: true,\n        });\n        const photoUrl = `${baseUrl.baseUrl}/containers/classebook.data.storage/upload?access_token=${localStorage.token}`;\n        axios({\n          url: photoUrl,\n          method: \"POST\",\n          data: formadata,\n        }).then((response) => {\n           let urlPhotoUser =\n            `${baseUrl.baseUrl}/users/` +\n            userId +\n            `?access_token=${localStorage.token}`;\n\n          axios\n            .patch(urlPhotoUser, {\n              id: userId,\n              photo:\n                response.data.result.files.file[0].providerResponse.location,\n            })\n            .then((response) => {\n              if (response) {\n                console.log(\"response photo\", response);\n              } else {\n                console.log(response.data, \"photo not upload\");\n              }\n            });\n        });\n      }\n      if (response && data.userPapiersFiles.length > 0) {\n        let formadata = new FormData();\n        data.userPapiersFiles.map((element, index) => {\n          let userPapiersFile = element;\n          const fileExtension = userPapiersFile.name.replace(/^.*\\./, \"\");\n          const fileName =\n            \"userPapiersfile\" +\n            userId +\n            index +\n            String(Date.now()).slice(-2) +\n            \".\" +\n            fileExtension;\n          var object = {};\n          object.file = userPapiersFile;\n          object.fileName = fileName;\n          const myNewFile = new File([object.file], fileName, {\n            type: object.file.type,\n          });\n          formadata.append(\"file\", myNewFile);\n        });\n\n        let filesURL = [];\n\n        const URLUserPapiersFiles = `${baseUrl.baseUrl}/containers/classebook.data.storage/upload?access_token=${localStorage.token}`;\n        axios({\n          url: URLUserPapiersFiles,\n          method: \"POST\",\n          data: formadata,\n        })\n          .then((response) => {\n            if (response) {\n              filesURL = response.data.result.files.file.map(\n                (urlFile, index) => {\n                  return urlFile.providerResponse.location;\n                }\n              );\n              let urlPhotoUser =\n                `${baseUrl.baseUrl}/users/` +\n                userId +\n                `?access_token=${localStorage.token}`;\n\n              axios\n                .patch(urlPhotoUser, {\n                  id: userId,\n                  paper_files: filesURL,\n                })\n                .then((response) => {\n                  if (response) {\n                    console.log(\"response photo\", response);\n                  } else {\n                    console.log(response.data, \"photo not upload\");\n                  }\n                });\n            }\n          })\n          .catch((err) => {});\n      } else if (!response) {\n        console.log(\"ereeeu\", response);\n        dispatch({\n          type: SHOW_ERROR_MESSAGE,\n          payload:\n            \"Une erreur est survenue lors de la création merci d'essayer à nouveau\",\n        });\n        setTimeout(() => {\n          dispatch({ type: HIDE_ERROR_MESSAGE });\n        }, 4000);\n      }\n    });\n  };\n};\n"]},"metadata":{},"sourceType":"module"}