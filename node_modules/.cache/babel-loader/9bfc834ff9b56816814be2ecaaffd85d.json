{"ast":null,"code":"var _jsxFileName = \"/home/oem/Documents/projects/educap/classebook-front-web/src/app/routes/Learning/routes/Homeworks/HomeworkList.js\";\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { getSectionFromLevel } from '../../../../../actions/sectionAction';\nimport { getLevelListFromEstabType } from '../../../../../actions/classLevelAction';\nimport axios from 'axios';\nimport baseUrl from '../../../../../config/config';\nimport { getClassesByEstablishmentId } from '../../../../../actions/classeAction';\nimport { roleIdAdmin } from '../../../../../config/config';\nimport { roleIdProfessor } from '../../../../../config/config';\nimport { roleIdParent } from '../../../../../config/config';\nimport { roleIdStudent } from '../../../../../config/config';\nimport _ from 'lodash';\nimport { privateStatus, publicStatus, allStatus } from '../../../../../config/config';\nimport moment from 'moment';\nimport HomeworkItem from './HomeworkItem';\nimport DeleteHomework from './DeleteHomework';\nimport { deleteHomework, editHomework } from '../../../../../actions/HomeworkAction';\nimport EditHomework from './EditHomework';\nimport IntlMessages from '../../../../../util/IntlMessages';\nimport { classService } from '../../../../../_services/class.service';\nimport DetailHomework from './DetailHomework';\nimport { object } from 'prop-types';\n\nclass HomeworkList extends Component {\n  constructor(props) {\n    super(props);\n\n    this.handleChangePostTime = time => {\n      this.setState({\n        postTime: time._d\n      });\n    };\n\n    this.handleChangeDate = name => date => {\n      this.setState({\n        [name]: date\n      });\n    };\n\n    this.handleChangeClassList = selectedOption => {\n      if (selectedOption != null) {\n        let classesId = _.map(selectedOption, 'id');\n\n        this.setState({\n          classesId,\n          isEmptylistClass: false,\n          classItem: selectedOption\n        });\n      } else {\n        this.setState({\n          classesId: [],\n          classItem: []\n        });\n      }\n    };\n\n    this.handleChangeSubject = selectedOption => {\n      if (selectedOption.id != this.state.subjectId) {\n        this.setState({\n          subjectColor: selectedOption.color,\n          subjectName: selectedOption.label,\n          subjectId: selectedOption.id,\n          subjectItem: selectedOption,\n          classItem: [],\n          classesId: [],\n          errorClass: false\n        });\n\n        if (this.props.userProfile.role_id === roleIdAdmin) {\n          let apiEndpoint = `/assignment_class_subjects?access_token=${localStorage.token}&filter[where][fk_id_subject_v4]=${selectedOption.value}&filter[include]=class&filter[include]=course`;\n          classService.get(apiEndpoint).then(response => {\n            if (response) {\n              let classesSubjects = response.data.filter(element => element.status);\n              let newList = [];\n              classesSubjects.map(element => {\n                let object = {};\n\n                if (!_.isEmpty(element.course)) {\n                  object.label = element.class.name;\n                  object.id = element.course[0].id;\n                  object.value = element.course[0].id;\n                  newList.push(object);\n                }\n              });\n              this.setState({\n                classes: newList\n              });\n            }\n          });\n        } else {\n          let apiEndpoint = `/assignment_class_subjects/${selectedOption.value}?access_token=${localStorage.token}&filter[include]=class&filter[include]=course`;\n          classService.get(apiEndpoint).then(response => {\n            if (response) {\n              let element = response.data;\n\n              if (element.status) {\n                let object = {};\n                object.label = element.class.name;\n                object.id = element.course[0].id;\n                object.value = element.course[0].id;\n                this.setState({\n                  classes: [object]\n                });\n              }\n            }\n          });\n        }\n      }\n    };\n\n    this.handleChangeHomeworkType = selectedOption => {\n      this.setState({\n        homeworkType: selectedOption\n      });\n    };\n\n    this.handleChange = name => event => {\n      this.setState({\n        [name]: event.target.value\n      });\n    };\n\n    this.state = {\n      HomeworkTypes: [{\n        label: /*#__PURE__*/React.createElement(IntlMessages, {\n          id: \"toDo.book.exercise\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 31,\n            columnNumber: 18\n          }\n        }),\n        value: 'book',\n        id: 1\n      }, {\n        label: /*#__PURE__*/React.createElement(IntlMessages, {\n          id: \"toDo.series.exercise\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 36,\n            columnNumber: 18\n          }\n        }),\n        value: 'serie',\n        id: 2\n      }, {\n        label: /*#__PURE__*/React.createElement(IntlMessages, {\n          id: \"toDo.other.exercise\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 41,\n            columnNumber: 18\n          }\n        }),\n        value: 'other',\n        id: 3\n      }],\n      classes: [],\n      subjects: [],\n      deleteIsopen: false,\n      itemIdDelete: '',\n      editIsopen: false,\n      itemEdit: {},\n      nameFile: '',\n      subjectId: null,\n      subjectItem: {},\n      classItem: [{}],\n      publicationDate: new Date(),\n      postTime: new Date(),\n      renderingDate: new Date(),\n      correctionDate: new Date(),\n      description: '',\n      courseUrl: '',\n      nameFiles: [],\n      homeworkFiles: [],\n      messageAlerte: '',\n      alerteStatus: false,\n      errorClass: false,\n      isEmptylistClass: false,\n      homeworkId: '',\n      homeworkFilesDelete: [],\n      isOpenDetail: false,\n      nameFilesDetails: []\n    };\n    this.handleDelete = this.handleDelete.bind(this);\n    this.handleCancelDelete = this.handleCancelDelete.bind(this);\n    this.handleSubmitDelete = this.handleSubmitDelete.bind(this);\n    this.handleEdit = this.handleEdit.bind(this);\n    this.handleChange = this.handleChange.bind(this);\n    this.handleChangeHomeworkType = this.handleChangeHomeworkType.bind(this);\n    this.handleChangeSubject = this.handleChangeSubject.bind(this);\n    this.handleChangeClassList = this.handleChangeClassList.bind(this);\n    this.cancelModal = this.cancelModal.bind(this);\n    this.handleChangeDate = this.handleChangeDate.bind(this);\n    this.attachFile = this.attachFile.bind(this);\n    this.handleChangePostTime = this.handleChangePostTime.bind(this);\n    this.deleteFile = this.deleteFile.bind(this);\n    this.submitEditHomework = this.submitEditHomework.bind(this);\n    this.handleShowDetail = this.handleShowDetail.bind(this);\n    this.handleCancel = this.handleCancel.bind(this);\n    this.communActions = this.communActions.bind(this);\n  }\n\n  handleCancel() {\n    this.setState({\n      isOpenDetail: false\n    });\n  }\n\n  handleShowDetail(item) {\n    this.communActions(item);\n    this.setState({\n      isOpenDetail: true\n    });\n  }\n\n  submitEditHomework(e) {\n    e.preventDefault();\n\n    if (this.state.subjectId === null) {\n      this.setState({\n        errorClass: true\n      });\n    } else if (_.isEmpty(this.state.classesId)) {\n      this.setState({\n        isEmptylistClass: true\n      });\n    } else {\n      let oldFiles = this.state.itemEdit.homework.homeworkFiles.filter(element => !this.state.homeworkFilesDelete.includes(element.id));\n      let dataHomework = {};\n      dataHomework.title = this.state.nameFile;\n      dataHomework.homeworkType = this.state.homeworkType.value == undefined ? '' : this.state.homeworkType.value;\n      dataHomework.subjectId = this.state.subjectId;\n      dataHomework.subjectColor = this.state.subjectColor;\n      dataHomework.classesId = this.state.classesId;\n      dataHomework.publicationDate = this.state.publicationDate;\n      dataHomework.publicationTime = this.state.postTime;\n      dataHomework.courseUrl = this.state.courseUrl;\n      dataHomework.description = this.state.description;\n      dataHomework.correctionDate = this.state.correctionDate;\n      dataHomework.renderingDate = this.state.renderingDate;\n      dataHomework.subjectName = this.state.subjectName;\n      dataHomework.homeworkId = this.state.homeworkId;\n      dataHomework.files_deleted = this.state.homeworkFilesDelete;\n      this.props.dispatch(editHomework(dataHomework, this.state.homeworkFiles, this.state.classItem, oldFiles));\n      this.cancelModal();\n    }\n  }\n\n  deleteFile(filename) {\n    let nameFiles = this.state.nameFiles.filter(element => element != filename);\n    let homeworkFiles = this.state.homeworkFiles.filter(element => element.name != filename);\n    let deletedFiles = [];\n\n    if (this.state.itemEdit.homework.homeworkFiles != undefined) {\n      this.state.itemEdit.homework.homeworkFiles.map(element => {\n        if (element.name == filename) {\n          deletedFiles.push(element.id);\n        }\n      });\n    }\n\n    this.state.homeworkFilesDelete.map(element => {\n      deletedFiles.push(element);\n    });\n    this.setState({\n      nameFiles,\n      homeworkFiles,\n      homeworkFilesDelete: deletedFiles\n    });\n  }\n\n  attachFile(e) {\n    var oldFiles = this.state.homeworkFiles;\n    var files = Object.values(e.target.files);\n    var nameFiles = this.state.nameFiles;\n\n    if (files !== undefined && this.state.nameFiles.length + files.length < 6) {\n      files.map(element => {\n        nameFiles.push(element.name);\n        oldFiles.push(element);\n      });\n      this.setState({\n        homeworkFiles: oldFiles,\n        nameFiles\n      });\n    } else {\n      this.setState({\n        messageAlerte: 'vous avez dépasser 5 fichiers',\n        alerteStatus: true\n      });\n      setTimeout(() => {\n        this.setState({\n          messageAlerte: '',\n          alerteStatus: false\n        });\n      }, 4000);\n    }\n  }\n\n  communActions(item) {\n    let homeworkType = this.state.HomeworkTypes.find(element => element.value == item.homework.homework_type);\n    let subjectItem = this.props.subjects.find(element => element.id == item.homework.fk_id_subject);\n    let classItem = {\n      label: item.className,\n      id: item.courseId,\n      value: item.courseId\n    };\n    var nameFiles = item.homework.homeworkFiles.map(element => element.name);\n    var nameFilesDetails = item.homework.homeworkFiles.map(element => {\n      let obj = {};\n      obj.name = element.name;\n      obj.url = element.url_file;\n      return obj;\n    });\n    this.setState({\n      homeworkId: item.homework.id,\n      itemEdit: item,\n      nameFile: item.homework.title,\n      homeworkType,\n      subjects: this.props.subjects,\n      subjectItem,\n      subjectId: item.homework.fk_id_subject,\n      subjectColor: item.homework.subject.color,\n      subjectName: item.homework.subject.name,\n      classItem: [classItem],\n      classesId: [item.courseId],\n      description: item.homework.description,\n      publicationDate: item.homework.publication_date,\n      renderingDate: item.homework.rendering_date,\n      correctionDate: item.homework.correction_date,\n      postTime: item.homework.publication_time,\n      courseUrl: item.homework.course_url,\n      nameFiles\n    });\n  }\n\n  handleEdit(item) {\n    console.log(item, 'ediiiiit');\n    this.communActions(item);\n\n    if (this.props.userProfile.role_id === roleIdAdmin) {\n      let apiEndpoint = `/assignment_class_subjects?access_token=${localStorage.token}&filter[where][fk_id_subject_v4]=${item.homework.fk_id_subject}&filter[include]=class&filter[include]=course`;\n      classService.get(apiEndpoint).then(response => {\n        if (response) {\n          let classesSubjects = response.data.filter(element => element.status);\n          let newList = [];\n          classesSubjects.map(element => {\n            let object = {};\n\n            if (!_.isEmpty(element.course)) {\n              object.label = element.class.name;\n              object.id = element.course[0].id;\n              object.value = element.course[0].id;\n              newList.push(object);\n            }\n          });\n          this.setState({\n            classes: newList\n          });\n        }\n      });\n    } else {\n      let apiEndpoint = `/assignment_class_subjects/${item.homework.fk_id_subject}?access_token=${localStorage.token}&filter[include]=class&filter[include]=course`;\n      classService.get(apiEndpoint).then(response => {\n        if (response) {\n          let element = response.data;\n\n          if (element.status) {\n            let object = {};\n            object.label = element.class.name;\n            object.id = element.course[0].id;\n            object.value = element.course[0].id;\n            this.setState({\n              classes: [object]\n            });\n          }\n        }\n      });\n    }\n\n    this.setState({\n      editIsopen: true\n    });\n  }\n\n  handleSubmitDelete() {\n    this.setState({\n      deleteIsopen: false\n    });\n    this.props.dispatch(deleteHomework(this.state.itemIdDelete));\n  }\n\n  handleDelete(id) {\n    this.setState({\n      deleteIsopen: true,\n      itemIdDelete: id\n    });\n  }\n\n  handleCancelDelete() {\n    this.setState({\n      deleteIsopen: false,\n      itemIdDelete: ''\n    });\n  }\n\n  cancelModal() {\n    this.setState({\n      classes: [],\n      subjects: [],\n      editIsopen: false,\n      itemEdit: {},\n      nameFile: '',\n      subjectId: null,\n      subjectItem: {},\n      classItem: [{}],\n      publicationDate: new Date(),\n      postTime: new Date(),\n      renderingDate: new Date(),\n      correctionDate: new Date(),\n      description: '',\n      courseUrl: '',\n      nameFiles: [],\n      homeworkFiles: [],\n      messageAlerte: '',\n      alerteStatus: false,\n      errorClass: false,\n      isEmptylistClass: false,\n      homeworkId: '',\n      homeworkFilesDelete: []\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-xl-12 col-md-12 col-lg-12 col-sm-6 \",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 363,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"   price-tables row pt-default d-flex flex-wrap justify-content-start \",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 364,\n        columnNumber: 9\n      }\n    }, this.props.homeworks.map((homeworkItem, index) => /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-md-12 col-lg-6 col-sm-6 col-xl-3 \",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 366,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(HomeworkItem, {\n      key: index,\n      homeworkItem: homeworkItem,\n      handleDelete: this.handleDelete,\n      handleEdit: this.handleEdit,\n      archived: false,\n      handleShowDetail: this.handleShowDetail,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 367,\n        columnNumber: 15\n      }\n    })))), this.state.editIsopen === true ? /*#__PURE__*/React.createElement(EditHomework, {\n      editIsopen: this.state.editIsopen,\n      values: this.state,\n      handleChange: this.handleChange,\n      handleChangeHomeworkType: this.handleChangeHomeworkType,\n      handleChangeSubject: this.handleChangeSubject,\n      handleChangeClassList: this.handleChangeClassList,\n      cancelModal: this.cancelModal,\n      handleChangeDate: this.handleChangeDate,\n      attachFile: this.attachFile,\n      handleChangePostTime: this.handleChangePostTime,\n      deleteFile: this.deleteFile,\n      submitEditHomework: this.submitEditHomework,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 380,\n        columnNumber: 11\n      }\n    }) : '', this.state.deleteIsopen === true ? /*#__PURE__*/React.createElement(DeleteHomework, {\n      modal: this.state.deleteIsopen,\n      handleCancelDelete: this.handleCancelDelete,\n      handleSubmitDelete: this.handleSubmitDelete,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 399,\n        columnNumber: 11\n      }\n    }) : '', this.state.isOpenDetail && /*#__PURE__*/React.createElement(DetailHomework, {\n      values: this.state,\n      handleCancel: this.handleCancel,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 409,\n        columnNumber: 11\n      }\n    }));\n  }\n\n}\n\nfunction mapStateToProps(state) {\n  return {\n    userProfile: state.auth.userProfile,\n    ClassSettings: state.ClassSettingsReducer.classSettings\n  };\n}\n\nexport default connect(mapStateToProps)(HomeworkList);","map":{"version":3,"sources":["/home/oem/Documents/projects/educap/classebook-front-web/src/app/routes/Learning/routes/Homeworks/HomeworkList.js"],"names":["React","Component","connect","getSectionFromLevel","getLevelListFromEstabType","axios","baseUrl","getClassesByEstablishmentId","roleIdAdmin","roleIdProfessor","roleIdParent","roleIdStudent","_","privateStatus","publicStatus","allStatus","moment","HomeworkItem","DeleteHomework","deleteHomework","editHomework","EditHomework","IntlMessages","classService","DetailHomework","object","HomeworkList","constructor","props","handleChangePostTime","time","setState","postTime","_d","handleChangeDate","name","date","handleChangeClassList","selectedOption","classesId","map","isEmptylistClass","classItem","handleChangeSubject","id","state","subjectId","subjectColor","color","subjectName","label","subjectItem","errorClass","userProfile","role_id","apiEndpoint","localStorage","token","value","get","then","response","classesSubjects","data","filter","element","status","newList","isEmpty","course","class","push","classes","handleChangeHomeworkType","homeworkType","handleChange","event","target","HomeworkTypes","subjects","deleteIsopen","itemIdDelete","editIsopen","itemEdit","nameFile","publicationDate","Date","renderingDate","correctionDate","description","courseUrl","nameFiles","homeworkFiles","messageAlerte","alerteStatus","homeworkId","homeworkFilesDelete","isOpenDetail","nameFilesDetails","handleDelete","bind","handleCancelDelete","handleSubmitDelete","handleEdit","cancelModal","attachFile","deleteFile","submitEditHomework","handleShowDetail","handleCancel","communActions","item","e","preventDefault","oldFiles","homework","includes","dataHomework","title","undefined","publicationTime","files_deleted","dispatch","filename","deletedFiles","files","Object","values","length","setTimeout","find","homework_type","fk_id_subject","className","courseId","obj","url","url_file","subject","publication_date","rendering_date","correction_date","publication_time","course_url","console","log","render","homeworks","homeworkItem","index","mapStateToProps","auth","ClassSettings","ClassSettingsReducer","classSettings"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\n\nimport { connect } from 'react-redux';\nimport { getSectionFromLevel } from '../../../../../actions/sectionAction';\nimport { getLevelListFromEstabType } from '../../../../../actions/classLevelAction';\nimport axios from 'axios';\nimport baseUrl from '../../../../../config/config';\nimport { getClassesByEstablishmentId } from '../../../../../actions/classeAction';\nimport { roleIdAdmin } from '../../../../../config/config';\nimport { roleIdProfessor } from '../../../../../config/config';\nimport { roleIdParent } from '../../../../../config/config';\nimport { roleIdStudent } from '../../../../../config/config';\nimport _ from 'lodash';\nimport { privateStatus, publicStatus, allStatus } from '../../../../../config/config';\nimport moment from 'moment';\nimport HomeworkItem from './HomeworkItem';\nimport DeleteHomework from './DeleteHomework';\nimport { deleteHomework, editHomework } from '../../../../../actions/HomeworkAction';\nimport EditHomework from './EditHomework';\nimport IntlMessages from '../../../../../util/IntlMessages';\nimport { classService } from '../../../../../_services/class.service';\nimport DetailHomework from './DetailHomework';\nimport { object } from 'prop-types';\n\nclass HomeworkList extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      HomeworkTypes: [\n        {\n          label: <IntlMessages id=\"toDo.book.exercise\" />,\n          value: 'book',\n          id: 1,\n        },\n        {\n          label: <IntlMessages id=\"toDo.series.exercise\" />,\n          value: 'serie',\n          id: 2,\n        },\n        {\n          label: <IntlMessages id=\"toDo.other.exercise\" />,\n          value: 'other',\n          id: 3,\n        },\n      ],\n      classes: [],\n      subjects: [],\n      deleteIsopen: false,\n      itemIdDelete: '',\n      editIsopen: false,\n      itemEdit: {},\n      nameFile: '',\n      subjectId: null,\n      subjectItem: {},\n      classItem: [{}],\n      publicationDate: new Date(),\n      postTime: new Date(),\n      renderingDate: new Date(),\n      correctionDate: new Date(),\n      description: '',\n      courseUrl: '',\n      nameFiles: [],\n      homeworkFiles: [],\n      messageAlerte: '',\n      alerteStatus: false,\n      errorClass: false,\n      isEmptylistClass: false,\n      homeworkId: '',\n      homeworkFilesDelete: [],\n      isOpenDetail: false,\n      nameFilesDetails: [],\n    };\n    this.handleDelete = this.handleDelete.bind(this);\n    this.handleCancelDelete = this.handleCancelDelete.bind(this);\n    this.handleSubmitDelete = this.handleSubmitDelete.bind(this);\n    this.handleEdit = this.handleEdit.bind(this);\n    this.handleChange = this.handleChange.bind(this);\n    this.handleChangeHomeworkType = this.handleChangeHomeworkType.bind(this);\n    this.handleChangeSubject = this.handleChangeSubject.bind(this);\n    this.handleChangeClassList = this.handleChangeClassList.bind(this);\n    this.cancelModal = this.cancelModal.bind(this);\n    this.handleChangeDate = this.handleChangeDate.bind(this);\n    this.attachFile = this.attachFile.bind(this);\n    this.handleChangePostTime = this.handleChangePostTime.bind(this);\n    this.deleteFile = this.deleteFile.bind(this);\n    this.submitEditHomework = this.submitEditHomework.bind(this);\n    this.handleShowDetail = this.handleShowDetail.bind(this);\n    this.handleCancel = this.handleCancel.bind(this);\n    this.communActions = this.communActions.bind(this);\n  }\n  handleCancel() {\n    this.setState({ isOpenDetail: false });\n  }\n\n  handleShowDetail(item) {\n    this.communActions(item);\n    this.setState({ isOpenDetail: true });\n  }\n\n  submitEditHomework(e) {\n    e.preventDefault();\n    if (this.state.subjectId === null) {\n      this.setState({ errorClass: true });\n    } else if (_.isEmpty(this.state.classesId)) {\n      this.setState({ isEmptylistClass: true });\n    } else {\n      let oldFiles = this.state.itemEdit.homework.homeworkFiles.filter(\n        (element) => !this.state.homeworkFilesDelete.includes(element.id)\n      );\n      let dataHomework = {};\n      dataHomework.title = this.state.nameFile;\n      dataHomework.homeworkType =\n        this.state.homeworkType.value == undefined ? '' : this.state.homeworkType.value;\n      dataHomework.subjectId = this.state.subjectId;\n      dataHomework.subjectColor = this.state.subjectColor;\n      dataHomework.classesId = this.state.classesId;\n      dataHomework.publicationDate = this.state.publicationDate;\n      dataHomework.publicationTime = this.state.postTime;\n      dataHomework.courseUrl = this.state.courseUrl;\n      dataHomework.description = this.state.description;\n      dataHomework.correctionDate = this.state.correctionDate;\n      dataHomework.renderingDate = this.state.renderingDate;\n      dataHomework.subjectName = this.state.subjectName;\n      dataHomework.homeworkId = this.state.homeworkId;\n      dataHomework.files_deleted = this.state.homeworkFilesDelete;\n\n      this.props.dispatch(\n        editHomework(dataHomework, this.state.homeworkFiles, this.state.classItem, oldFiles)\n      );\n      this.cancelModal();\n    }\n  }\n  deleteFile(filename) {\n    let nameFiles = this.state.nameFiles.filter((element) => element != filename);\n    let homeworkFiles = this.state.homeworkFiles.filter((element) => element.name != filename);\n    let deletedFiles = [];\n    if (this.state.itemEdit.homework.homeworkFiles != undefined) {\n      this.state.itemEdit.homework.homeworkFiles.map((element) => {\n        if (element.name == filename) {\n          deletedFiles.push(element.id);\n        }\n      });\n    }\n    this.state.homeworkFilesDelete.map((element) => {\n      deletedFiles.push(element);\n    });\n    this.setState({ nameFiles, homeworkFiles, homeworkFilesDelete: deletedFiles });\n  }\n\n  handleChangePostTime = (time) => {\n    this.setState({ postTime: time._d });\n  };\n  attachFile(e) {\n    var oldFiles = this.state.homeworkFiles;\n    var files = Object.values(e.target.files);\n    var nameFiles = this.state.nameFiles;\n    if (files !== undefined && this.state.nameFiles.length + files.length < 6) {\n      files.map((element) => {\n        nameFiles.push(element.name);\n        oldFiles.push(element);\n      });\n      this.setState({ homeworkFiles: oldFiles, nameFiles });\n    } else {\n      this.setState({\n        messageAlerte: 'vous avez dépasser 5 fichiers',\n        alerteStatus: true,\n      });\n      setTimeout(() => {\n        this.setState({ messageAlerte: '', alerteStatus: false });\n      }, 4000);\n    }\n  }\n  handleChangeDate = (name) => (date) => {\n    this.setState({ [name]: date });\n  };\n  handleChangeClassList = (selectedOption) => {\n    if (selectedOption != null) {\n      let classesId = _.map(selectedOption, 'id');\n      this.setState({\n        classesId,\n        isEmptylistClass: false,\n        classItem: selectedOption,\n      });\n    } else {\n      this.setState({ classesId: [], classItem: [] });\n    }\n  };\n  handleChangeSubject = (selectedOption) => {\n    if (selectedOption.id != this.state.subjectId) {\n      this.setState({\n        subjectColor: selectedOption.color,\n        subjectName: selectedOption.label,\n        subjectId: selectedOption.id,\n        subjectItem: selectedOption,\n        classItem: [],\n        classesId: [],\n        errorClass: false,\n      });\n      if (this.props.userProfile.role_id === roleIdAdmin) {\n        let apiEndpoint = `/assignment_class_subjects?access_token=${localStorage.token}&filter[where][fk_id_subject_v4]=${selectedOption.value}&filter[include]=class&filter[include]=course`;\n        classService.get(apiEndpoint).then((response) => {\n          if (response) {\n            let classesSubjects = response.data.filter((element) => element.status);\n            let newList = [];\n            classesSubjects.map((element) => {\n              let object = {};\n              if (!_.isEmpty(element.course)) {\n                object.label = element.class.name;\n                object.id = element.course[0].id;\n                object.value = element.course[0].id;\n\n                newList.push(object);\n              }\n            });\n\n            this.setState({ classes: newList });\n          }\n        });\n      } else {\n        let apiEndpoint = `/assignment_class_subjects/${selectedOption.value}?access_token=${localStorage.token}&filter[include]=class&filter[include]=course`;\n        classService.get(apiEndpoint).then((response) => {\n          if (response) {\n            let element = response.data;\n            if (element.status) {\n              let object = {};\n              object.label = element.class.name;\n              object.id = element.course[0].id;\n              object.value = element.course[0].id;\n              this.setState({ classes: [object] });\n            }\n          }\n        });\n      }\n    }\n  };\n  handleChangeHomeworkType = (selectedOption) => {\n    this.setState({ homeworkType: selectedOption });\n  };\n  handleChange = (name) => (event) => {\n    this.setState({ [name]: event.target.value });\n  };\n\n  communActions(item) {\n    let homeworkType = this.state.HomeworkTypes.find(\n      (element) => element.value == item.homework.homework_type\n    );\n    let subjectItem = this.props.subjects.find(\n      (element) => element.id == item.homework.fk_id_subject\n    );\n    let classItem = {\n      label: item.className,\n      id: item.courseId,\n      value: item.courseId,\n    };\n    var nameFiles = item.homework.homeworkFiles.map((element) => element.name);\n    var nameFilesDetails = item.homework.homeworkFiles.map((element) => {\n      let obj = {};\n      obj.name = element.name;\n      obj.url = element.url_file;\n      return obj;\n    });\n    this.setState({\n      homeworkId: item.homework.id,\n      itemEdit: item,\n      nameFile: item.homework.title,\n      homeworkType,\n      subjects: this.props.subjects,\n      subjectItem,\n      subjectId: item.homework.fk_id_subject,\n      subjectColor: item.homework.subject.color,\n      subjectName: item.homework.subject.name,\n      classItem: [classItem],\n      classesId: [item.courseId],\n      description: item.homework.description,\n      publicationDate: item.homework.publication_date,\n      renderingDate: item.homework.rendering_date,\n      correctionDate: item.homework.correction_date,\n      postTime: item.homework.publication_time,\n      courseUrl: item.homework.course_url,\n      nameFiles,\n    });\n  }\n\n  handleEdit(item) {\n    console.log(item, 'ediiiiit');\n    this.communActions(item);\n    if (this.props.userProfile.role_id === roleIdAdmin) {\n      let apiEndpoint = `/assignment_class_subjects?access_token=${localStorage.token}&filter[where][fk_id_subject_v4]=${item.homework.fk_id_subject}&filter[include]=class&filter[include]=course`;\n      classService.get(apiEndpoint).then((response) => {\n        if (response) {\n          let classesSubjects = response.data.filter((element) => element.status);\n          let newList = [];\n          classesSubjects.map((element) => {\n            let object = {};\n            if (!_.isEmpty(element.course)) {\n              object.label = element.class.name;\n              object.id = element.course[0].id;\n              object.value = element.course[0].id;\n\n              newList.push(object);\n            }\n          });\n\n          this.setState({ classes: newList });\n        }\n      });\n    } else {\n      let apiEndpoint = `/assignment_class_subjects/${item.homework.fk_id_subject}?access_token=${localStorage.token}&filter[include]=class&filter[include]=course`;\n      classService.get(apiEndpoint).then((response) => {\n        if (response) {\n          let element = response.data;\n          if (element.status) {\n            let object = {};\n            object.label = element.class.name;\n            object.id = element.course[0].id;\n            object.value = element.course[0].id;\n            this.setState({ classes: [object] });\n          }\n        }\n      });\n    }\n    this.setState({ editIsopen: true });\n  }\n  handleSubmitDelete() {\n    this.setState({ deleteIsopen: false });\n    this.props.dispatch(deleteHomework(this.state.itemIdDelete));\n  }\n  handleDelete(id) {\n    this.setState({ deleteIsopen: true, itemIdDelete: id });\n  }\n\n  handleCancelDelete() {\n    this.setState({ deleteIsopen: false, itemIdDelete: '' });\n  }\n  cancelModal() {\n    this.setState({\n      classes: [],\n      subjects: [],\n      editIsopen: false,\n      itemEdit: {},\n      nameFile: '',\n      subjectId: null,\n      subjectItem: {},\n      classItem: [{}],\n      publicationDate: new Date(),\n      postTime: new Date(),\n      renderingDate: new Date(),\n      correctionDate: new Date(),\n      description: '',\n      courseUrl: '',\n      nameFiles: [],\n      homeworkFiles: [],\n      messageAlerte: '',\n      alerteStatus: false,\n      errorClass: false,\n      isEmptylistClass: false,\n      homeworkId: '',\n      homeworkFilesDelete: [],\n    });\n  }\n  render() {\n    return (\n      <div className=\"col-xl-12 col-md-12 col-lg-12 col-sm-6 \">\n        <div className=\"   price-tables row pt-default d-flex flex-wrap justify-content-start \">\n          {this.props.homeworks.map((homeworkItem, index) => (\n            <div className=\"col-md-12 col-lg-6 col-sm-6 col-xl-3 \">\n              <HomeworkItem\n                key={index}\n                homeworkItem={homeworkItem}\n                handleDelete={this.handleDelete}\n                handleEdit={this.handleEdit}\n                archived={false}\n                handleShowDetail={this.handleShowDetail}\n              />\n            </div>\n          ))}\n        </div>\n\n        {this.state.editIsopen === true ? (\n          <EditHomework\n            editIsopen={this.state.editIsopen}\n            values={this.state}\n            handleChange={this.handleChange}\n            handleChangeHomeworkType={this.handleChangeHomeworkType}\n            handleChangeSubject={this.handleChangeSubject}\n            handleChangeClassList={this.handleChangeClassList}\n            cancelModal={this.cancelModal}\n            handleChangeDate={this.handleChangeDate}\n            attachFile={this.attachFile}\n            handleChangePostTime={this.handleChangePostTime}\n            deleteFile={this.deleteFile}\n            submitEditHomework={this.submitEditHomework}\n          />\n        ) : (\n          ''\n        )}\n\n        {this.state.deleteIsopen === true ? (\n          <DeleteHomework\n            modal={this.state.deleteIsopen}\n            handleCancelDelete={this.handleCancelDelete}\n            handleSubmitDelete={this.handleSubmitDelete}\n          ></DeleteHomework>\n        ) : (\n          ''\n        )}\n\n        {this.state.isOpenDetail && (\n          <DetailHomework values={this.state} handleCancel={this.handleCancel} />\n        )}\n      </div>\n    );\n  }\n}\n\nfunction mapStateToProps(state) {\n  return {\n    userProfile: state.auth.userProfile,\n    ClassSettings: state.ClassSettingsReducer.classSettings,\n  };\n}\n\nexport default connect(mapStateToProps)(HomeworkList);\n"]},"metadata":{},"sourceType":"module"}