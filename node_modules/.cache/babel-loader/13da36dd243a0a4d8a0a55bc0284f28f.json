{"ast":null,"code":"var _jsxFileName = \"/home/oem/Documents/projects/educap-pro/educap-pro-front/src/app/routes/Administration/routes/SchoolSettings/SubjectsSettings/SubjectsSettingsList.js\";\nimport React from 'react';\nimport Table from \"@material-ui/core/Table\";\nimport TableBody from \"@material-ui/core/TableBody\";\nimport TableCell from \"@material-ui/core/TableCell\";\nimport TableHead from \"@material-ui/core/TableHead\";\nimport TableRow from \"@material-ui/core/TableRow\";\nimport IntlMessages from \"../../../../../../util/IntlMessages\";\nimport SubjectItem from './SubjectItem';\nimport DeleteSubjectSetting from './DeleteSubjectSetting';\nimport { deleteSubjectSetting, editSubjectSetting, assignSubjectSetting } from \"../../../../../../actions/subjectAction\";\nimport { connect } from 'react-redux';\nimport EditSubjectSetting from './EditSubjectSetting';\nimport _ from 'lodash';\n\nclass SubjectsSettingsList extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.addNewAssignment = index => {\n      this.setState(prevState => ({\n        listOfAssignment: [...prevState.listOfAssignment, {\n          id: index,\n          levelId: null,\n          sectionId: null,\n          sectionDisabled: true,\n          isChecked: false,\n          isLevelDisabled: false\n        }]\n      }));\n    };\n\n    this.handleAssignment = (item, event) => {\n      event.preventDefault();\n      this.setState({\n        isOpenAssignment: true,\n        id: item.id\n      });\n    };\n\n    this.handleChange = name => event => {\n      this.setState({\n        [name]: event.target.value\n      });\n    };\n\n    this.handleSubmit = e => {\n      e.preventDefault();\n      const data = {\n        name: this.state.nameSubject,\n        wording: this.state.wording,\n        fk_id_subjects_module: this.state.moduleSubjectId,\n        color: this.state.codeColor\n      };\n      this.props.editSubjectSetting(data, this.state.id);\n      this.handleCancel();\n    };\n\n    this.handleEdit = (item, event) => {\n      event.preventDefault();\n      this.setState({\n        isOpenEdit: true,\n        item: item,\n        nameSubject: item.name,\n        wording: item.wording,\n        moduleSubjectId: item.fk_id_subjects_module_v4,\n        id: item.id,\n        codeColor: item.color\n      });\n    };\n\n    this.handleDeleteSubject = event => {\n      event.preventDefault();\n      this.props.deleteSubjectSetting(this.state.deleteItem);\n      this.setState({\n        deleteIsopen: false\n      });\n    };\n\n    this.handleDelete = (item, event) => {\n      event.preventDefault();\n      this.setState({\n        deleteIsopen: true,\n        deleteItem: item\n      });\n    };\n\n    this.handleColorChange = e => {\n      this.setState({\n        codeColor: e.target.value\n      });\n    };\n\n    this.state = {\n      isOpenEdit: false,\n      deleteIsopen: false,\n      deleteItem: {},\n      item: {},\n      nameSubject: \"\",\n      wording: \"\",\n      moduleSubjectId: null,\n      id: null,\n      isOpenAssignment: false,\n      sections: [],\n      listOfAssignment: [{\n        id: 0,\n        levelId: null,\n        sectionId: null,\n        sectionDisabled: true,\n        isChecked: false,\n        isLevelDisabled: false\n      }],\n      codeColor: \"#000\"\n    };\n    this.handleDelete = this.handleDelete.bind(this);\n    this.handleCancel = this.handleCancel.bind(this);\n    this.handleDeleteSubject = this.handleDeleteSubject.bind(this);\n    this.handleEdit = this.handleEdit.bind(this);\n    this.handleChange = this.handleChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.handleAssignment = this.handleAssignment.bind(this);\n    this.handleChangeAssignment = this.handleChangeAssignment.bind(this);\n    this.addNewAssignment = this.addNewAssignment.bind(this);\n    this.handleChangeListSubjects = this.handleChangeListSubjects.bind(this);\n    this.handleChangeListSubjectsSection = this.handleChangeListSubjectsSection.bind(this);\n    this.handleColorChange = this.handleColorChange.bind(this);\n  }\n\n  handleChangeAssignment(event, name, index) {\n    let levelsIds = _.map(this.props.levels, 'id');\n\n    let newListSubjects = [];\n    levelsIds.forEach(levelId => {\n      let sections = this.props.sections.filter(element => element.fk_id_level_v3 === levelId);\n      this.setState({\n        sections\n      });\n\n      if (!_.isEmpty(sections)) {\n        let sectionsIds = _.map(sections, 'id');\n\n        sectionsIds.forEach(sectionId => {\n          newListSubjects.push({\n            levelId: levelId,\n            sectionId: sectionId,\n            [name]: event.target.checked,\n            sectionDisabled: false,\n            isLevelDisabled: !event.target.checked\n          });\n        });\n      } else {\n        newListSubjects.push({\n          levelId: levelId,\n          sectionId: null,\n          [name]: event.target.checked,\n          sectionDisabled: true,\n          isLevelDisabled: !event.target.checked\n        });\n      }\n    });\n    this.setState({\n      listOfAssignment: newListSubjects\n    });\n  }\n\n  handleChangeListSubjects(event, name, index) {\n    let sections = [];\n\n    if (name === \"levelId\") {\n      sections = this.props.sections.filter(element => element.fk_id_level_v4 === event.target.value);\n      this.setState({\n        sections\n      });\n    }\n\n    let newListSubjects = this.state.listOfAssignment.map(objSubject => name === \"levelId\" && !_.isEmpty(sections) && objSubject.id === index ? { ...objSubject,\n      [name]: event.target.value,\n      sectionDisabled: false,\n      sectionId: null\n    } : objSubject.id === index ? { ...objSubject,\n      [name]: event.target.value,\n      sectionDisabled: true\n    } : objSubject);\n    this.setState({\n      listOfAssignment: newListSubjects\n    });\n  }\n\n  handleChangeListSubjectsSection(event, name, index) {\n    let newListSubjects = this.state.listOfAssignment.map(objSubject => objSubject.id === index ? { ...objSubject,\n      [name]: event.target.value,\n      sectionDisabled: false\n    } : objSubject);\n    this.setState({\n      listOfAssignment: newListSubjects\n    });\n  }\n\n  handleCancel() {\n    this.setState({\n      deleteIsopen: false,\n      isOpenEdit: false,\n      isOpenAssignment: false,\n      listOfAssignment: [{\n        id: 0,\n        levelId: null,\n        sectionId: null,\n        sectionDisabled: true,\n        isChecked: false,\n        isLevelDisabled: false\n      }]\n    });\n  }\n\n  render() {\n    let {\n      subjects,\n      subjectModules\n    } = this.props;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"table-responsive-material\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"b\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(IntlMessages, {\n      id: \"list.all.subject\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 15\n      }\n    })))), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(Table, {\n      className: \"default-table table-unbordered table table-sm table-hover\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(TableHead, {\n      className: \"th-border-b\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(TableRow, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(TableCell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 15\n      }\n    }, \" \", /*#__PURE__*/React.createElement(IntlMessages, {\n      id: \"subjects\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 27\n      }\n    })), /*#__PURE__*/React.createElement(TableCell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(IntlMessages, {\n      id: \"room.description\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220,\n        columnNumber: 26\n      }\n    })), /*#__PURE__*/React.createElement(TableCell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 15\n      }\n    }, \" \", /*#__PURE__*/React.createElement(IntlMessages, {\n      id: \"sidebar.components.subjectModule\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 27\n      }\n    })), /*#__PURE__*/React.createElement(TableCell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 15\n      }\n    }, \" \", /*#__PURE__*/React.createElement(IntlMessages, {\n      id: \"sidebar.components.couleur\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 27\n      }\n    })), /*#__PURE__*/React.createElement(TableCell, {\n      align: \"center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(IntlMessages, {\n      id: \"action.type.of.education\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 41\n      }\n    })))), /*#__PURE__*/React.createElement(TableBody, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 11\n      }\n    }, subjects.map((subject, index) => {\n      return /*#__PURE__*/React.createElement(SubjectItem, {\n        archived: false,\n        key: index,\n        subject: subject,\n        subjectModules: subjectModules,\n        handleDelete: this.handleDelete,\n        handleEdit: this.handleEdit,\n        handleAssignment: this.handleAssignment,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 231,\n          columnNumber: 17\n        }\n      });\n    }))), this.state.isOpenEdit === true ? /*#__PURE__*/React.createElement(EditSubjectSetting, {\n      item: this.state.item,\n      handleCancel: this.handleCancel,\n      subjectModules: subjectModules,\n      values: this.state,\n      handleEdit: this.handleEdit,\n      handleChange: this.handleChange,\n      handleSubmit: this.handleSubmit,\n      handleColorChange: this.handleColorChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 247,\n        columnNumber: 11\n      }\n    }) : \"\", this.state.deleteIsopen === true ? /*#__PURE__*/React.createElement(DeleteSubjectSetting, {\n      handleDeleteSubject: this.handleDeleteSubject,\n      deleteItem: this.state.deleteItem,\n      handleCancel: this.handleCancel,\n      deleteIsopen: this.state.deleteIsopen,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 261,\n        columnNumber: 11\n      }\n    }) : \"\");\n  }\n\n}\n\nfunction mapStateToProps(state) {\n  return {};\n}\n\nexport default connect(mapStateToProps, {\n  deleteSubjectSetting,\n  editSubjectSetting,\n  assignSubjectSetting\n})(SubjectsSettingsList);","map":{"version":3,"sources":["/home/oem/Documents/projects/educap-pro/educap-pro-front/src/app/routes/Administration/routes/SchoolSettings/SubjectsSettings/SubjectsSettingsList.js"],"names":["React","Table","TableBody","TableCell","TableHead","TableRow","IntlMessages","SubjectItem","DeleteSubjectSetting","deleteSubjectSetting","editSubjectSetting","assignSubjectSetting","connect","EditSubjectSetting","_","SubjectsSettingsList","Component","constructor","props","addNewAssignment","index","setState","prevState","listOfAssignment","id","levelId","sectionId","sectionDisabled","isChecked","isLevelDisabled","handleAssignment","item","event","preventDefault","isOpenAssignment","handleChange","name","target","value","handleSubmit","e","data","state","nameSubject","wording","fk_id_subjects_module","moduleSubjectId","color","codeColor","handleCancel","handleEdit","isOpenEdit","fk_id_subjects_module_v4","handleDeleteSubject","deleteItem","deleteIsopen","handleDelete","handleColorChange","sections","bind","handleChangeAssignment","handleChangeListSubjects","handleChangeListSubjectsSection","levelsIds","map","levels","newListSubjects","forEach","filter","element","fk_id_level_v3","isEmpty","sectionsIds","push","checked","fk_id_level_v4","objSubject","render","subjects","subjectModules","subject","mapStateToProps"],"mappings":"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","sourcesContent":["import React from 'react'\nimport Table from \"@material-ui/core/Table\";\nimport TableBody from \"@material-ui/core/TableBody\";\nimport TableCell from \"@material-ui/core/TableCell\";\nimport TableHead from \"@material-ui/core/TableHead\";\nimport TableRow from \"@material-ui/core/TableRow\";\nimport IntlMessages from \"../../../../../../util/IntlMessages\";\nimport SubjectItem from './SubjectItem'\nimport DeleteSubjectSetting from './DeleteSubjectSetting'\nimport { deleteSubjectSetting, editSubjectSetting, assignSubjectSetting } from \"../../../../../../actions/subjectAction\"\nimport { connect } from 'react-redux';\nimport EditSubjectSetting from './EditSubjectSetting';\nimport _ from 'lodash'\nclass SubjectsSettingsList extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOpenEdit: false,\n      deleteIsopen: false,\n      deleteItem: {},\n      item: {},\n      nameSubject: \"\",\n      wording: \"\",\n      moduleSubjectId: null,\n      id: null,\n      isOpenAssignment: false,\n      sections: [],\n      listOfAssignment: [\n        {\n          id: 0,\n          levelId: null,\n          sectionId: null,\n          sectionDisabled: true,\n          isChecked: false,\n          isLevelDisabled: false,\n\n        },\n      ],\n      codeColor:\"#000\"\n\n\n    };\n    this.handleDelete = this.handleDelete.bind(this)\n    this.handleCancel = this.handleCancel.bind(this);\n    this.handleDeleteSubject = this.handleDeleteSubject.bind(this)\n    this.handleEdit = this.handleEdit.bind(this);\n    this.handleChange = this.handleChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this)\n    this.handleAssignment = this.handleAssignment.bind(this)\n     this.handleChangeAssignment = this.handleChangeAssignment.bind(this);\n    this.addNewAssignment = this.addNewAssignment.bind(this);\n    this.handleChangeListSubjects = this.handleChangeListSubjects.bind(this);\n    this.handleChangeListSubjectsSection = this.handleChangeListSubjectsSection.bind(this);\n    this.handleColorChange = this.handleColorChange.bind(this);\n\n    \n  }\n\n  handleChangeAssignment(event, name, index) {\n    let levelsIds = _.map(this.props.levels, 'id')\n    let newListSubjects = []\n    levelsIds.forEach(levelId => {\n     let sections = this.props.sections.filter(element => element.fk_id_level_v3 === levelId)\n     this.setState({sections})\n     if(!_.isEmpty(sections)){\n       let sectionsIds = _.map(sections,'id')\n       sectionsIds.forEach(sectionId => {\n        newListSubjects.push({\n          levelId: levelId,\n          sectionId: sectionId,\n          [name]: event.target.checked,\n          sectionDisabled: false,\n          isLevelDisabled: !event.target.checked\n        })\n       });\n     }else{\n      newListSubjects.push({\n        levelId: levelId,\n        sectionId: null,\n        [name]: event.target.checked,\n        sectionDisabled: true,\n        isLevelDisabled: !event.target.checked\n      })\n\n     }\n    });\n    this.setState({ listOfAssignment: newListSubjects });\n  }\n\n\n  handleChangeListSubjects(event, name, index) {\n    let sections = []\n    if (name === \"levelId\") {\n      sections = this.props.sections.filter(element => element.fk_id_level_v4 === event.target.value)\n      this.setState({ sections });\n    }\n    let newListSubjects = this.state.listOfAssignment.map((objSubject) =>\n      name === \"levelId\" && !_.isEmpty(sections) && objSubject.id === index\n        ? {\n          ...objSubject,\n          [name]: event.target.value,\n          sectionDisabled: false,\n          sectionId: null,\n        }\n        : objSubject.id === index\n          ? { ...objSubject, [name]: event.target.value, sectionDisabled: true }\n          : objSubject\n    );\n\n    this.setState({ listOfAssignment: newListSubjects });\n  };\n\n  handleChangeListSubjectsSection(event, name, index) {\n    let newListSubjects = this.state.listOfAssignment.map((objSubject) =>\n      objSubject.id === index\n        ? { ...objSubject, [name]: event.target.value, sectionDisabled: false }\n        : objSubject\n    );\n    this.setState({ listOfAssignment: newListSubjects });\n  }\n\n\n  addNewAssignment = (index) => {\n    this.setState((prevState) => ({\n      listOfAssignment: [\n        ...prevState.listOfAssignment,\n        {\n          id: index,\n          levelId: null,\n          sectionId: null,\n          sectionDisabled: true,\n          isChecked: false,\n          isLevelDisabled: false\n        },\n      ],\n    }));\n  };\n  handleAssignment = (item, event) => {\n    event.preventDefault();\n    this.setState({ isOpenAssignment: true, id: item.id })\n  }\n\n  handleChange = (name) => (event) => {\n    this.setState({ [name]: event.target.value });\n  };\n\n  handleSubmit = (e) => {\n    e.preventDefault();\n    const data = {\n      name: this.state.nameSubject,\n      wording: this.state.wording,\n      fk_id_subjects_module: this.state.moduleSubjectId,\n      color:this.state.codeColor\n    };\n    this.props.editSubjectSetting(data, this.state.id);\n    this.handleCancel();\n  };\n\n  handleEdit = (item, event) => {\n    event.preventDefault();\n    this.setState({\n      isOpenEdit: true, item: item,\n      nameSubject: item.name,\n      wording: item.wording,\n      moduleSubjectId: item.fk_id_subjects_module_v4,\n      id: item.id,\n      codeColor:item.color\n    });\n  }\n\n  handleDeleteSubject = (event) => {\n    event.preventDefault()\n    this.props.deleteSubjectSetting(this.state.deleteItem);\n    this.setState({\n      deleteIsopen: false\n    })\n  }\n\n  handleDelete = (item, event) => {\n    event.preventDefault();\n    this.setState({ deleteIsopen: true, deleteItem: item });\n  }\n  handleCancel() {\n    this.setState({\n      deleteIsopen: false, isOpenEdit: false, isOpenAssignment: false,\n      listOfAssignment: [\n        {\n          id: 0,\n          levelId: null,\n          sectionId: null,\n          sectionDisabled: true,\n          isChecked: false,\n          isLevelDisabled: false\n\n        }\n      ]\n    });\n  }\n  handleColorChange = (e) => {\n    this.setState({\n      codeColor:e.target.value\n    })\n  };\n  render() {\n    let { subjects, subjectModules } = this.props\n    return (\n      <div className=\"table-responsive-material\">\n        <div >\n          <h1>\n            <b>\n              <IntlMessages id=\"list.all.subject\" />\n            </b>\n          </h1>\n        </div>\n        <br />\n        <Table className=\"default-table table-unbordered table table-sm table-hover\">\n          <TableHead className=\"th-border-b\">\n            <TableRow>\n              <TableCell> <IntlMessages id=\"subjects\" /></TableCell>\n              <TableCell><IntlMessages id=\"room.description\" /></TableCell>\n              <TableCell> <IntlMessages id=\"sidebar.components.subjectModule\" /></TableCell>\n              <TableCell> <IntlMessages id=\"sidebar.components.couleur\" /></TableCell>\n              <TableCell align=\"center\"><IntlMessages id=\"action.type.of.education\" /></TableCell>\n            </TableRow>\n          </TableHead>\n\n          <TableBody>\n            {subjects.map((subject, index) => {\n\n              return (\n                <SubjectItem\n                archived={false}\n                  key={index}\n                  subject={subject}\n                  subjectModules={subjectModules}\n                  handleDelete={this.handleDelete}\n                  handleEdit={this.handleEdit}\n                  handleAssignment={this.handleAssignment}\n                />\n              );\n            })}\n\n          </TableBody>\n        </Table>\n\n        {this.state.isOpenEdit === true ?\n          <EditSubjectSetting\n            item={this.state.item}\n            handleCancel={this.handleCancel}\n            subjectModules={subjectModules}\n            values={this.state}\n            handleEdit={this.handleEdit}\n            handleChange={this.handleChange}\n            handleSubmit={this.handleSubmit}\n            handleColorChange={this.handleColorChange}\n\n          /> : \"\"\n        }\n\n        {this.state.deleteIsopen === true ?\n          <DeleteSubjectSetting\n            handleDeleteSubject={this.handleDeleteSubject}\n            deleteItem={this.state.deleteItem}\n            handleCancel={this.handleCancel}\n            deleteIsopen={this.state.deleteIsopen}\n          /> : \"\"\n        }\n      </div>\n    )\n  }\n}\n\nfunction mapStateToProps(state) {\n  return {\n\n  };\n}\nexport default connect(\n  mapStateToProps,\n  {\n    deleteSubjectSetting,\n    editSubjectSetting,\n    assignSubjectSetting\n  }\n)(SubjectsSettingsList);"]},"metadata":{},"sourceType":"module"}