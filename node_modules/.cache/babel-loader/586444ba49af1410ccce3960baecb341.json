{"ast":null,"code":"var _jsxFileName = \"/home/oem/Documents/projects/educap-pro/educap-pro-front/src/app/routes/FinancialManagement/routes/Billing/ListInvoices.js\";\nimport React, { Component } from \"react\";\nimport BillItem from \"./BillItem\";\nimport CardBox from \"../../../../../components/CardBox/index\";\nimport PayBill from \"../Payment/PayBill\";\nimport moment from \"moment\";\nimport { connect } from \"react-redux\";\nimport { SendInvoice } from \"../../../../../actions/BillAction\";\nimport ConfirmInvoiceModal from \"./ConfirmInvoiceModal\";\nimport { unpaidInvoice, partiallyPaidInvoice, billPaid, lateInvoice } from \"../../../../../config/config\";\nlet invoices = [{\n  id: 1,\n  invoiceNumber: \"00001\",\n  schoolYear: \"2019 / 2020\",\n  gerationDate: \"01 / 11 / 2020\",\n  DataSender: {\n    Nom: \"Ecole les ulites\",\n    Adresse: \"tunis-sousse\",\n    Pays: \"tunis\",\n    telephoneNumber: \"+216 98 745 632\",\n    siteInternet: \"wwww.ulites.com\",\n    email: \"ulites@gmail.com\",\n    urlLogoEstablishement: \"aws\",\n    RIB: \"string\"\n  },\n  DataRecever: {\n    nomParent: \"M Marco\",\n    adresse: \"tunis-sousse\",\n    telephoneNumber: \"+216 98 745 632\",\n    email: \"marco@gmail.com\"\n  },\n  serviceList: [{\n    serviceName: \"Cantine\",\n    unitPrice: \"200 \",\n    quantity: \"1\",\n    tva: \"19%\",\n    total: \"200 \"\n  }, {\n    serviceName: \"Bus\",\n    unitPrice: \"20 \",\n    quantity: \"1\",\n    tva: \"19%\",\n    total: \"20 \"\n  }, {\n    serviceName: \"Club\",\n    unitPrice: \"50 \",\n    quantity: \"1\",\n    tva: \"19%\",\n    total: \"50 \"\n  }, {\n    serviceName: \"Technologie\",\n    unitPrice: \"30 \",\n    quantity: \"1\",\n    tva: \"19%\",\n    total: \"30 \"\n  }],\n  totalPriceHT: \"300 \",\n  totalTVA: \"57 \",\n  totalTTC: \"357\",\n  statusInvoice: 0,\n  timeline: [{\n    date: \"05/09/020\",\n    amount: \"120 \"\n  }, {\n    date: \"05/10/020\",\n    amount: \"120 \"\n  }, {\n    date: \"05/11/020\",\n    amount: \"120 \"\n  }],\n  amountToAccount: \"100 \",\n  totalPayed: \"257\",\n  paymeentconditions: \"Veuillez trouver votre échéancier prévisionnel ci-contre.Les prélèvements seront effectués sur le RIB suivant : TU76 1745 6985 0458796 13154546\"\n}, {\n  id: 2,\n  invoiceNumber: \"00002\",\n  schoolYear: \"2019 / 2020\",\n  gerationDate: \"01 / 12 / 2020\",\n  DataSender: {\n    Nom: \"Ecole les ailles\",\n    Adresse: \"tunis-sousse\",\n    Pays: \"tunis\",\n    telephoneNumber: \"+216 98 745 586\",\n    siteInternet: \"wwww.ulites.com\",\n    email: \"ulites@gmail.com\",\n    urlLogoEstablishement: \"aws\",\n    RIB: \"string\"\n  },\n  DataRecever: {\n    nomParent: \"Mme Nadia\",\n    adresse: \"tunis-sousse\",\n    telephoneNumber: \"+216 98 745 632\",\n    email: \"ulites@gmail.com\"\n  },\n  serviceList: [{\n    serviceName: \"Cantine\",\n    unitPrice: \"40\",\n    quantity: \"1\",\n    tva: \"19%\",\n    total: \"180\"\n  }, {\n    serviceName: \"Arts plastique\",\n    unitPrice: \"40\",\n    quantity: \"1\",\n    tva: \"19%\",\n    total: \"40\"\n  }],\n  totalPriceHT: \"220\",\n  totalTVA: \"41,80\",\n  totalTTC: \"261,80\",\n  statusInvoice: 1,\n  timeline: [{\n    date: \"05/09/020\",\n    amount: \"120\"\n  }, {\n    date: \"05/10/020\",\n    amount: \"120\"\n  }, {\n    date: \"05/11/020\",\n    amount: \"120\"\n  }],\n  amountToAccount: \"120\",\n  totalPayed: 141,\n  paymeentconditions: \"Veuillez trouver votre échéancier prévisionnel ci-contre.Les prélèvements seront effectués sur le RIB suivant : TU76 1745 6985 0458796 13154546\"\n}];\n\nclass ListInvoices extends Component {\n  constructor(props) {\n    super(props);\n\n    this.handleChange = name => event => {\n      this.setState({\n        [name]: event.target.value\n      });\n    };\n\n    this.handleOpenInvoiceModal = item => {\n      console.log('MMMMMMMMMMMMMMMMMMMMMMM');\n      this.setState({\n        invoiceModal: true,\n        InvoiceObject: item\n      }, () => console.log('RRRRRRRRRRRRRRR ', this.state.invoiceModal));\n    };\n\n    this.handleCloseInvoiceModal = () => {\n      this.setState({\n        invoiceModal: false,\n        InvoiceObject: {}\n      }, () => console.log('RRRRRRRRRRRRRRR ', this.state.invoiceModal));\n    };\n\n    this.handleSubmitInvoice = e => {\n      e.preventDefault();\n      console.log('KKKKKKKKKKKK ', this.state.InvoiceObject);\n      var mails = {};\n      mails.ReceiverMail = this.state.ReceiverMail;\n      mails.secondMail = this.state.secondMail;\n      var data = {};\n      data.mails = mails;\n      data.object = this.state.InvoiceObject;\n      this.props.SendInvoice(data);\n      this.handleCloseInvoiceModal();\n    };\n\n    this.handleChangePaymentType = key => (event, value) => {\n      this.setState({\n        paymentMethode: value,\n        paymentMethodeError: false\n      });\n    };\n\n    this.handleChangeInput = name => event => {\n      if (name == \"price\") {\n        let priceError = false;\n        priceError = this.state.billSelected.totalPayed < parseInt(event.target.value, 10);\n\n        if (priceError) {\n          this.setState({\n            [name]: event.target.value,\n            priceError\n          });\n        } else {\n          this.setState({\n            [name]: event.target.value,\n            priceError,\n            priceRestant: this.state.priceTotal - parseInt(event.target.value, 10)\n          });\n        }\n      } else {\n        this.setState({\n          [name]: event.target.value\n        });\n      }\n    };\n\n    this.handleSubmit = e => {\n      e.preventDefault();\n      console.log(\"rrrrrrrrr\");\n\n      if (this.state.paymentMethode === \"\") {\n        this.setState({\n          paymentMethodeError: true\n        });\n      } // else if (this.state.price > this.props.invoice.bill.total_incl_tax) {\n      //   this.setState({ priceError: true });\n      // }\n      else {\n          let data = {};\n\n          if (this.state.billSelected.statusInvoice === partiallyPaidInvoice) {\n            const newPrice = parseInt(this.state.price) + this.state.oldPrice;\n\n            if (newPrice > this.state.billSelected.totalPayed) {\n              this.setState({\n                priceError: true\n              });\n            } // else {\n            //   data = { price_paid: newPrice };\n            //   this.props.dispatch(\n            //     editBill(data, this.state.idPaymentV2, this.props.invoice)\n            //   );\n            //   this.props.cancelModal();\n            // }\n\n          } else {\n            data = {\n              payment_day: moment(this.state.paymentDay).format(\"YYYY-MM-DD\"),\n              payment_methode: this.state.paymentMethode,\n              fk_id_profile: this.props.userProfile.id,\n              fk_id_bill: this.state.billSelected.id,\n              price_invoice: this.state.billSelected.totalPayed,\n              price_paid: parseInt(this.state.price)\n            };\n            console.log(data, \"data envoyéééé\"); // this.props.dispatch(payBill(data, this.props.invoice));\n          }\n        }\n    };\n\n    this.state = {\n      openPay: false,\n      billSelected: {},\n      price: \"\",\n      paymentDay: new Date(),\n      paymentMethode: \"\",\n      oldPrice: 0,\n      priceError: false,\n      priceTotal: 0,\n      priceRestant: 0,\n      invoiceModal: false,\n      InvoiceObject: {},\n      ReceiverMail: \"\",\n      secondMail: \"\",\n      paymentMethodeError: false\n    };\n    this.openPay = this.openPay.bind(this);\n    this.cancelModal = this.cancelModal.bind(this);\n    this.handleChangeInput = this.handleChangeInput.bind(this);\n    this.handleChangePaymentType = this.handleChangePaymentType.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.handleOpenInvoiceModal = this.handleOpenInvoiceModal.bind(this);\n    this.handleCloseInvoiceModal = this.handleCloseInvoiceModal.bind(this);\n    this.handleSubmitInvoice = this.handleSubmitInvoice.bind(this);\n    this.handleChange = this.handleChange.bind(this);\n  }\n\n  openPay(item) {\n    this.setState({\n      openPay: true,\n      billSelected: item,\n      priceTotal: item.totalPayed,\n      priceRestant: 0\n    });\n  }\n\n  cancelModal() {\n    this.setState({\n      openPay: false,\n      billSelected: {},\n      priceError: false,\n      price: '',\n      priceTotal: 0,\n      priceRestant: 0,\n      paymentMethode: '',\n      paymentMethodeError: false\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row col-lg-12 col-md-12\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 307,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(CardBox, {\n      styleName: \"text-black col-lg-12\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 308,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row d-flex justify-content-center alignement-items-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 309,\n        columnNumber: 13\n      }\n    }, invoices.map(element => /*#__PURE__*/React.createElement(BillItem, {\n      month: this.props.month,\n      key: element.id,\n      item: element,\n      openPay: this.openPay,\n      handleOpenInvoiceModal: this.handleOpenInvoiceModal,\n      handleCloseInvoiceModal: this.handleCloseInvoiceModal,\n      values: this.state // languageId={this.props.settings.languageId}\n      // idEstablishment={this.props.userProfile.establishment_id}\n      // users={this.props.users}\n      ,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 311,\n        columnNumber: 17\n      }\n    }))))), this.state.openPay ? /*#__PURE__*/React.createElement(PayBill, {\n      cancelModal: this.cancelModal,\n      invoice: this.state.billSelected,\n      values: this.state,\n      handleChangeInput: this.handleChangeInput,\n      handleChangePaymentType: this.handleChangePaymentType,\n      handleSubmit: this.handleSubmit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 328,\n        columnNumber: 11\n      }\n    }) : \" \", this.state.invoiceModal === true ? /*#__PURE__*/React.createElement(ConfirmInvoiceModal, {\n      values: this.state,\n      handleCloseInvoiceModal: this.handleCloseInvoiceModal,\n      handleSubmitInvoice: this.handleSubmitInvoice,\n      handleChange: this.handleChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 342,\n        columnNumber: 11\n      }\n    }) : \"\");\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    userProfile: state.auth.userProfile\n  };\n};\n\nexport default connect(mapStateToProps, {\n  SendInvoice\n})(ListInvoices);","map":{"version":3,"sources":["/home/oem/Documents/projects/educap-pro/educap-pro-front/src/app/routes/FinancialManagement/routes/Billing/ListInvoices.js"],"names":["React","Component","BillItem","CardBox","PayBill","moment","connect","SendInvoice","ConfirmInvoiceModal","unpaidInvoice","partiallyPaidInvoice","billPaid","lateInvoice","invoices","id","invoiceNumber","schoolYear","gerationDate","DataSender","Nom","Adresse","Pays","telephoneNumber","siteInternet","email","urlLogoEstablishement","RIB","DataRecever","nomParent","adresse","serviceList","serviceName","unitPrice","quantity","tva","total","totalPriceHT","totalTVA","totalTTC","statusInvoice","timeline","date","amount","amountToAccount","totalPayed","paymeentconditions","ListInvoices","constructor","props","handleChange","name","event","setState","target","value","handleOpenInvoiceModal","item","console","log","invoiceModal","InvoiceObject","state","handleCloseInvoiceModal","handleSubmitInvoice","e","preventDefault","mails","ReceiverMail","secondMail","data","object","handleChangePaymentType","key","paymentMethode","paymentMethodeError","handleChangeInput","priceError","billSelected","parseInt","priceRestant","priceTotal","handleSubmit","newPrice","price","oldPrice","payment_day","paymentDay","format","payment_methode","fk_id_profile","userProfile","fk_id_bill","price_invoice","price_paid","openPay","Date","bind","cancelModal","render","map","element","month","mapStateToProps","auth"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,QAAP,MAAqB,YAArB;AACA,OAAOC,OAAP,MAAoB,yCAApB;AACA,OAAOC,OAAP,MAAoB,oBAApB;AACA,OAAOC,MAAP,MAAmB,QAAnB;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,SAAQC,WAAR,QAA0B,mCAA1B;AACA,OAAOC,mBAAP,MAAgC,uBAAhC;AACA,SACEC,aADF,EAEEC,oBAFF,EAGEC,QAHF,EAIEC,WAJF,QAKO,8BALP;AAMA,IAAIC,QAAQ,GAAG,CACb;AACEC,EAAAA,EAAE,EAAE,CADN;AAEEC,EAAAA,aAAa,EAAE,OAFjB;AAGEC,EAAAA,UAAU,EAAE,aAHd;AAIEC,EAAAA,YAAY,EAAE,gBAJhB;AAKEC,EAAAA,UAAU,EAAE;AACVC,IAAAA,GAAG,EAAE,kBADK;AAEVC,IAAAA,OAAO,EAAE,cAFC;AAGVC,IAAAA,IAAI,EAAE,OAHI;AAIVC,IAAAA,eAAe,EAAE,iBAJP;AAKVC,IAAAA,YAAY,EAAE,iBALJ;AAMVC,IAAAA,KAAK,EAAE,kBANG;AAOVC,IAAAA,qBAAqB,EAAE,KAPb;AAQVC,IAAAA,GAAG,EAAE;AARK,GALd;AAeEC,EAAAA,WAAW,EAAE;AACXC,IAAAA,SAAS,EAAE,SADA;AAEXC,IAAAA,OAAO,EAAE,cAFE;AAGXP,IAAAA,eAAe,EAAE,iBAHN;AAIXE,IAAAA,KAAK,EAAE;AAJI,GAff;AAqBEM,EAAAA,WAAW,EAAE,CACX;AACEC,IAAAA,WAAW,EAAE,SADf;AAEEC,IAAAA,SAAS,EAAE,MAFb;AAGEC,IAAAA,QAAQ,EAAE,GAHZ;AAIEC,IAAAA,GAAG,EAAE,KAJP;AAKEC,IAAAA,KAAK,EAAE;AALT,GADW,EAQX;AACEJ,IAAAA,WAAW,EAAE,KADf;AAEEC,IAAAA,SAAS,EAAE,KAFb;AAGEC,IAAAA,QAAQ,EAAE,GAHZ;AAIEC,IAAAA,GAAG,EAAE,KAJP;AAKEC,IAAAA,KAAK,EAAE;AALT,GARW,EAeX;AACEJ,IAAAA,WAAW,EAAE,MADf;AAEEC,IAAAA,SAAS,EAAE,KAFb;AAGEC,IAAAA,QAAQ,EAAE,GAHZ;AAIEC,IAAAA,GAAG,EAAE,KAJP;AAKEC,IAAAA,KAAK,EAAE;AALT,GAfW,EAsBX;AACEJ,IAAAA,WAAW,EAAE,aADf;AAEEC,IAAAA,SAAS,EAAE,KAFb;AAGEC,IAAAA,QAAQ,EAAE,GAHZ;AAIEC,IAAAA,GAAG,EAAE,KAJP;AAKEC,IAAAA,KAAK,EAAE;AALT,GAtBW,CArBf;AAmDEC,EAAAA,YAAY,EAAE,MAnDhB;AAoDEC,EAAAA,QAAQ,EAAE,KApDZ;AAqDEC,EAAAA,QAAQ,EAAE,KArDZ;AAsDEC,EAAAA,aAAa,EAAE,CAtDjB;AAuDEC,EAAAA,QAAQ,EAAE,CACR;AACEC,IAAAA,IAAI,EAAE,WADR;AAEEC,IAAAA,MAAM,EAAE;AAFV,GADQ,EAKR;AACED,IAAAA,IAAI,EAAE,WADR;AAEEC,IAAAA,MAAM,EAAE;AAFV,GALQ,EASR;AACED,IAAAA,IAAI,EAAE,WADR;AAEEC,IAAAA,MAAM,EAAE;AAFV,GATQ,CAvDZ;AAqEEC,EAAAA,eAAe,EAAE,MArEnB;AAsEEC,EAAAA,UAAU,EAAE,KAtEd;AAuEEC,EAAAA,kBAAkB,EAChB;AAxEJ,CADa,EA2Eb;AACE/B,EAAAA,EAAE,EAAE,CADN;AAEEC,EAAAA,aAAa,EAAE,OAFjB;AAGEC,EAAAA,UAAU,EAAE,aAHd;AAIEC,EAAAA,YAAY,EAAE,gBAJhB;AAKEC,EAAAA,UAAU,EAAE;AACVC,IAAAA,GAAG,EAAE,kBADK;AAEVC,IAAAA,OAAO,EAAE,cAFC;AAGVC,IAAAA,IAAI,EAAE,OAHI;AAIVC,IAAAA,eAAe,EAAE,iBAJP;AAKVC,IAAAA,YAAY,EAAE,iBALJ;AAMVC,IAAAA,KAAK,EAAE,kBANG;AAOVC,IAAAA,qBAAqB,EAAE,KAPb;AAQVC,IAAAA,GAAG,EAAE;AARK,GALd;AAeEC,EAAAA,WAAW,EAAE;AACXC,IAAAA,SAAS,EAAE,WADA;AAEXC,IAAAA,OAAO,EAAE,cAFE;AAGXP,IAAAA,eAAe,EAAE,iBAHN;AAIXE,IAAAA,KAAK,EAAE;AAJI,GAff;AAqBEM,EAAAA,WAAW,EAAE,CACX;AACEC,IAAAA,WAAW,EAAE,SADf;AAEEC,IAAAA,SAAS,EAAE,IAFb;AAGEC,IAAAA,QAAQ,EAAE,GAHZ;AAIEC,IAAAA,GAAG,EAAE,KAJP;AAKEC,IAAAA,KAAK,EAAE;AALT,GADW,EAQX;AACEJ,IAAAA,WAAW,EAAE,gBADf;AAEEC,IAAAA,SAAS,EAAE,IAFb;AAGEC,IAAAA,QAAQ,EAAE,GAHZ;AAIEC,IAAAA,GAAG,EAAE,KAJP;AAKEC,IAAAA,KAAK,EAAE;AALT,GARW,CArBf;AAqCEC,EAAAA,YAAY,EAAE,KArChB;AAsCEC,EAAAA,QAAQ,EAAE,OAtCZ;AAuCEC,EAAAA,QAAQ,EAAE,QAvCZ;AAwCEC,EAAAA,aAAa,EAAE,CAxCjB;AAyCEC,EAAAA,QAAQ,EAAE,CACR;AACEC,IAAAA,IAAI,EAAE,WADR;AAEEC,IAAAA,MAAM,EAAE;AAFV,GADQ,EAKR;AACED,IAAAA,IAAI,EAAE,WADR;AAEEC,IAAAA,MAAM,EAAE;AAFV,GALQ,EASR;AACED,IAAAA,IAAI,EAAE,WADR;AAEEC,IAAAA,MAAM,EAAE;AAFV,GATQ,CAzCZ;AAuDEC,EAAAA,eAAe,EAAE,KAvDnB;AAwDEC,EAAAA,UAAU,EAAE,GAxDd;AAyDEC,EAAAA,kBAAkB,EAChB;AA1DJ,CA3Ea,CAAf;;AAwIA,MAAMC,YAAN,SAA2B7C,SAA3B,CAAqC;AACnC8C,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;;AADiB,SAgCnBC,YAhCmB,GAgCHC,IAAD,IAAWC,KAAD,IAAW;AAClC,WAAKC,QAAL,CAAc;AAAE,SAACF,IAAD,GAAQC,KAAK,CAACE,MAAN,CAAaC;AAAvB,OAAd;AACD,KAlCkB;;AAAA,SAsCnBC,sBAtCmB,GAsCKC,IAAD,IAAS;AAC9BC,MAAAA,OAAO,CAACC,GAAR,CAAY,yBAAZ;AACA,WAAKN,QAAL,CAAc;AACZO,QAAAA,YAAY,EAAC,IADD;AAEZC,QAAAA,aAAa,EAACJ;AAFF,OAAd,EAGE,MAAIC,OAAO,CAACC,GAAR,CAAY,kBAAZ,EAA+B,KAAKG,KAAL,CAAWF,YAA1C,CAHN;AAID,KA5CkB;;AAAA,SA6CnBG,uBA7CmB,GA6CK,MAAK;AAC3B,WAAKV,QAAL,CAAc;AACZO,QAAAA,YAAY,EAAC,KADD;AAEZC,QAAAA,aAAa,EAAC;AAFF,OAAd,EAGE,MAAIH,OAAO,CAACC,GAAR,CAAY,kBAAZ,EAA+B,KAAKG,KAAL,CAAWF,YAA1C,CAHN;AAID,KAlDkB;;AAAA,SAmDnBI,mBAnDmB,GAmDEC,CAAD,IAAM;AACzBA,MAAAA,CAAC,CAACC,cAAF;AACAR,MAAAA,OAAO,CAACC,GAAR,CAAY,eAAZ,EAA4B,KAAKG,KAAL,CAAWD,aAAvC;AACA,UAAIM,KAAK,GAAC,EAAV;AACAA,MAAAA,KAAK,CAACC,YAAN,GAAmB,KAAKN,KAAL,CAAWM,YAA9B;AACAD,MAAAA,KAAK,CAACE,UAAN,GAAiB,KAAKP,KAAL,CAAWO,UAA5B;AAEH,UAAIC,IAAI,GAAC,EAAT;AACAA,MAAAA,IAAI,CAACH,KAAL,GAAWA,KAAX;AACAG,MAAAA,IAAI,CAACC,MAAL,GAAY,KAAKT,KAAL,CAAWD,aAAvB;AACG,WAAKZ,KAAL,CAAWzC,WAAX,CAAuB8D,IAAvB;AACA,WAAKP,uBAAL;AACA,KA/DkB;;AAAA,SAsFnBS,uBAtFmB,GAsFQC,GAAD,IAAS,CAACrB,KAAD,EAAQG,KAAR,KAAkB;AACnD,WAAKF,QAAL,CAAc;AACZqB,QAAAA,cAAc,EAAEnB,KADJ;AAEZoB,QAAAA,mBAAmB,EAAE;AAFT,OAAd;AAID,KA3FkB;;AAAA,SA6FnBC,iBA7FmB,GA6FEzB,IAAD,IAAWC,KAAD,IAAW;AACvC,UAAID,IAAI,IAAI,OAAZ,EAAqB;AACnB,YAAI0B,UAAU,GAAG,KAAjB;AACAA,QAAAA,UAAU,GACR,KAAKf,KAAL,CAAWgB,YAAX,CAAwBjC,UAAxB,GAAqCkC,QAAQ,CAAC3B,KAAK,CAACE,MAAN,CAAaC,KAAd,EAAqB,EAArB,CAD/C;;AAEA,YAAIsB,UAAJ,EAAgB;AACd,eAAKxB,QAAL,CAAc;AACZ,aAACF,IAAD,GAAQC,KAAK,CAACE,MAAN,CAAaC,KADT;AAEZsB,YAAAA;AAFY,WAAd;AAID,SALD,MAKO;AACL,eAAKxB,QAAL,CAAc;AACZ,aAACF,IAAD,GAAQC,KAAK,CAACE,MAAN,CAAaC,KADT;AAEZsB,YAAAA,UAFY;AAGZG,YAAAA,YAAY,EACV,KAAKlB,KAAL,CAAWmB,UAAX,GAAwBF,QAAQ,CAAC3B,KAAK,CAACE,MAAN,CAAaC,KAAd,EAAqB,EAArB;AAJtB,WAAd;AAMD;AACF,OAjBD,MAiBO;AACL,aAAKF,QAAL,CAAc;AAAE,WAACF,IAAD,GAAQC,KAAK,CAACE,MAAN,CAAaC;AAAvB,SAAd;AACD;AACF,KAlHkB;;AAAA,SAmHnB2B,YAnHmB,GAmHHjB,CAAD,IAAO;AACpBA,MAAAA,CAAC,CAACC,cAAF;AACAR,MAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ;;AACA,UAAI,KAAKG,KAAL,CAAWY,cAAX,KAA8B,EAAlC,EAAsC;AACpC,aAAKrB,QAAL,CAAc;AAAEsB,UAAAA,mBAAmB,EAAE;AAAvB,SAAd;AACD,OAFD,CAGA;AACA;AACA;AALA,WAMK;AACH,cAAIL,IAAI,GAAG,EAAX;;AACA,cAAI,KAAKR,KAAL,CAAWgB,YAAX,CAAwBtC,aAAxB,KAA0C7B,oBAA9C,EAAoE;AAClE,kBAAMwE,QAAQ,GAAGJ,QAAQ,CAAC,KAAKjB,KAAL,CAAWsB,KAAZ,CAAR,GAA6B,KAAKtB,KAAL,CAAWuB,QAAzD;;AACA,gBAAIF,QAAQ,GAAG,KAAKrB,KAAL,CAAWgB,YAAX,CAAwBjC,UAAvC,EAAmD;AACjD,mBAAKQ,QAAL,CAAc;AAAEwB,gBAAAA,UAAU,EAAE;AAAd,eAAd;AACD,aAJiE,CAKlE;AACA;AACA;AACA;AACA;AACA;AACA;;AACD,WAZD,MAYO;AACLP,YAAAA,IAAI,GAAG;AACLgB,cAAAA,WAAW,EAAEhF,MAAM,CAAC,KAAKwD,KAAL,CAAWyB,UAAZ,CAAN,CAA8BC,MAA9B,CAAqC,YAArC,CADR;AAELC,cAAAA,eAAe,EAAE,KAAK3B,KAAL,CAAWY,cAFvB;AAGLgB,cAAAA,aAAa,EAAE,KAAKzC,KAAL,CAAW0C,WAAX,CAAuB5E,EAHjC;AAIL6E,cAAAA,UAAU,EAAE,KAAK9B,KAAL,CAAWgB,YAAX,CAAwB/D,EAJ/B;AAKL8E,cAAAA,aAAa,EAAE,KAAK/B,KAAL,CAAWgB,YAAX,CAAwBjC,UALlC;AAMLiD,cAAAA,UAAU,EAAEf,QAAQ,CAAC,KAAKjB,KAAL,CAAWsB,KAAZ;AANf,aAAP;AAQA1B,YAAAA,OAAO,CAACC,GAAR,CAAYW,IAAZ,EAAkB,gBAAlB,EATK,CAUL;AACD;AACF;AACF,KAvJkB;;AAGjB,SAAKR,KAAL,GAAa;AACXiC,MAAAA,OAAO,EAAE,KADE;AAEXjB,MAAAA,YAAY,EAAE,EAFH;AAGXM,MAAAA,KAAK,EAAE,EAHI;AAIXG,MAAAA,UAAU,EAAE,IAAIS,IAAJ,EAJD;AAKXtB,MAAAA,cAAc,EAAE,EALL;AAMXW,MAAAA,QAAQ,EAAE,CANC;AAOXR,MAAAA,UAAU,EAAE,KAPD;AAQXI,MAAAA,UAAU,EAAE,CARD;AASXD,MAAAA,YAAY,EAAE,CATH;AAUXpB,MAAAA,YAAY,EAAC,KAVF;AAWXC,MAAAA,aAAa,EAAC,EAXH;AAYXO,MAAAA,YAAY,EAAC,EAZF;AAaXC,MAAAA,UAAU,EAAC,EAbA;AAcXM,MAAAA,mBAAmB,EAAE;AAdV,KAAb;AAiBA,SAAKoB,OAAL,GAAe,KAAKA,OAAL,CAAaE,IAAb,CAAkB,IAAlB,CAAf;AACA,SAAKC,WAAL,GAAmB,KAAKA,WAAL,CAAiBD,IAAjB,CAAsB,IAAtB,CAAnB;AACA,SAAKrB,iBAAL,GAAyB,KAAKA,iBAAL,CAAuBqB,IAAvB,CAA4B,IAA5B,CAAzB;AACA,SAAKzB,uBAAL,GAA+B,KAAKA,uBAAL,CAA6ByB,IAA7B,CAAkC,IAAlC,CAA/B;AACA,SAAKf,YAAL,GAAoB,KAAKA,YAAL,CAAkBe,IAAlB,CAAuB,IAAvB,CAApB;AACA,SAAKzC,sBAAL,GAA8B,KAAKA,sBAAL,CAA4ByC,IAA5B,CAAiC,IAAjC,CAA9B;AACA,SAAKlC,uBAAL,GAA+B,KAAKA,uBAAL,CAA6BkC,IAA7B,CAAkC,IAAlC,CAA/B;AACA,SAAKjC,mBAAL,GAA2B,KAAKA,mBAAL,CAAyBiC,IAAzB,CAA8B,IAA9B,CAA3B;AACA,SAAK/C,YAAL,GAAoB,KAAKA,YAAL,CAAkB+C,IAAlB,CAAuB,IAAvB,CAApB;AAGD;;AAmCDF,EAAAA,OAAO,CAACtC,IAAD,EAAO;AACZ,SAAKJ,QAAL,CAAc;AACZ0C,MAAAA,OAAO,EAAE,IADG;AAEZjB,MAAAA,YAAY,EAAErB,IAFF;AAGZwB,MAAAA,UAAU,EAAExB,IAAI,CAACZ,UAHL;AAIZmC,MAAAA,YAAY,EAAE;AAJF,KAAd;AAMD;;AACDkB,EAAAA,WAAW,GAAG;AACZ,SAAK7C,QAAL,CAAc;AACZ0C,MAAAA,OAAO,EAAE,KADG;AAEZjB,MAAAA,YAAY,EAAE,EAFF;AAGZD,MAAAA,UAAU,EAAE,KAHA;AAIZO,MAAAA,KAAK,EAAE,EAJK;AAKZH,MAAAA,UAAU,EAAE,CALA;AAMZD,MAAAA,YAAY,EAAE,CANF;AAOZN,MAAAA,cAAc,EAAC,EAPH;AAQZC,MAAAA,mBAAmB,EAAE;AART,KAAd;AAUD;;AAmEDwB,EAAAA,MAAM,GAAG;AACP,wBACE,uDACE;AAAK,MAAA,SAAS,EAAC,yBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,OAAD;AAAS,MAAA,SAAS,EAAC,sBAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAK,MAAA,SAAS,EAAC,2DAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACGrF,QAAQ,CAACsF,GAAT,CAAcC,OAAD,iBACZ,oBAAC,QAAD;AACE,MAAA,KAAK,EAAE,KAAKpD,KAAL,CAAWqD,KADpB;AAEE,MAAA,GAAG,EAAED,OAAO,CAACtF,EAFf;AAGE,MAAA,IAAI,EAAEsF,OAHR;AAIE,MAAA,OAAO,EAAE,KAAKN,OAJhB;AAKE,MAAA,sBAAsB,EAAI,KAAKvC,sBALjC;AAME,MAAA,uBAAuB,EAAI,KAAKO,uBANlC;AAOE,MAAA,MAAM,EAAE,KAAKD,KAPf,CAQE;AACA;AACA;AAVF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADD,CADH,CADF,CADF,CADF,EAqBG,KAAKA,KAAL,CAAWiC,OAAX,gBACC,oBAAC,OAAD;AACE,MAAA,WAAW,EAAE,KAAKG,WADpB;AAEE,MAAA,OAAO,EAAE,KAAKpC,KAAL,CAAWgB,YAFtB;AAGE,MAAA,MAAM,EAAE,KAAKhB,KAHf;AAIE,MAAA,iBAAiB,EAAE,KAAKc,iBAJ1B;AAKE,MAAA,uBAAuB,EAAE,KAAKJ,uBALhC;AAME,MAAA,YAAY,EAAE,KAAKU,YANrB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADD,GAUC,GA/BJ,EAmCI,KAAKpB,KAAL,CAAWF,YAAX,KAA0B,IAA1B,gBACA,oBAAC,mBAAD;AACA,MAAA,MAAM,EAAE,KAAKE,KADb;AAEA,MAAA,uBAAuB,EAAI,KAAKC,uBAFhC;AAGA,MAAA,mBAAmB,EAAI,KAAKC,mBAH5B;AAIA,MAAA,YAAY,EAAI,KAAKd,YAJrB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADA,GAWA,EA9CJ,CADF;AAmDD;;AA7MkC;;AA+MrC,MAAMqD,eAAe,GAAIzC,KAAD,IAAW;AACjC,SAAO;AACL6B,IAAAA,WAAW,EAAE7B,KAAK,CAAC0C,IAAN,CAAWb;AADnB,GAAP;AAGD,CAJD;;AAKA,eAAepF,OAAO,CAACgG,eAAD,EAAiB;AACrC/F,EAAAA;AADqC,CAAjB,CAAP,CAEZuC,YAFY,CAAf","sourcesContent":["import React, { Component } from \"react\";\nimport BillItem from \"./BillItem\";\nimport CardBox from \"../../../../../components/CardBox/index\";\nimport PayBill from \"../Payment/PayBill\";\nimport moment from \"moment\";\nimport { connect } from \"react-redux\";\nimport {SendInvoice} from \"../../../../../actions/BillAction\"\nimport ConfirmInvoiceModal from \"./ConfirmInvoiceModal\"\nimport {\n  unpaidInvoice,\n  partiallyPaidInvoice,\n  billPaid,\n  lateInvoice,\n} from \"../../../../../config/config\";\nlet invoices = [\n  {\n    id: 1,\n    invoiceNumber: \"00001\",\n    schoolYear: \"2019 / 2020\",\n    gerationDate: \"01 / 11 / 2020\",\n    DataSender: {\n      Nom: \"Ecole les ulites\",\n      Adresse: \"tunis-sousse\",\n      Pays: \"tunis\",\n      telephoneNumber: \"+216 98 745 632\",\n      siteInternet: \"wwww.ulites.com\",\n      email: \"ulites@gmail.com\",\n      urlLogoEstablishement: \"aws\",\n      RIB: \"string\",\n    },\n    DataRecever: {\n      nomParent: \"M Marco\",\n      adresse: \"tunis-sousse\",\n      telephoneNumber: \"+216 98 745 632\",\n      email: \"marco@gmail.com\",\n    },\n    serviceList: [\n      {\n        serviceName: \"Cantine\",\n        unitPrice: \"200 \",\n        quantity: \"1\",\n        tva: \"19%\",\n        total: \"200 \",\n      },\n      {\n        serviceName: \"Bus\",\n        unitPrice: \"20 \",\n        quantity: \"1\",\n        tva: \"19%\",\n        total: \"20 \",\n      },\n      {\n        serviceName: \"Club\",\n        unitPrice: \"50 \",\n        quantity: \"1\",\n        tva: \"19%\",\n        total: \"50 \",\n      },\n      {\n        serviceName: \"Technologie\",\n        unitPrice: \"30 \",\n        quantity: \"1\",\n        tva: \"19%\",\n        total: \"30 \",\n      },\n    ],\n    totalPriceHT: \"300 \",\n    totalTVA: \"57 \",\n    totalTTC: \"357\",\n    statusInvoice: 0,\n    timeline: [\n      {\n        date: \"05/09/020\",\n        amount: \"120 \",\n      },\n      {\n        date: \"05/10/020\",\n        amount: \"120 \",\n      },\n      {\n        date: \"05/11/020\",\n        amount: \"120 \",\n      },\n    ],\n    amountToAccount: \"100 \",\n    totalPayed: \"257\",\n    paymeentconditions:\n      \"Veuillez trouver votre échéancier prévisionnel ci-contre.Les prélèvements seront effectués sur le RIB suivant : TU76 1745 6985 0458796 13154546\",\n  },\n  {\n    id: 2,\n    invoiceNumber: \"00002\",\n    schoolYear: \"2019 / 2020\",\n    gerationDate: \"01 / 12 / 2020\",\n    DataSender: {\n      Nom: \"Ecole les ailles\",\n      Adresse: \"tunis-sousse\",\n      Pays: \"tunis\",\n      telephoneNumber: \"+216 98 745 586\",\n      siteInternet: \"wwww.ulites.com\",\n      email: \"ulites@gmail.com\",\n      urlLogoEstablishement: \"aws\",\n      RIB: \"string\",\n    },\n    DataRecever: {\n      nomParent: \"Mme Nadia\",\n      adresse: \"tunis-sousse\",\n      telephoneNumber: \"+216 98 745 632\",\n      email: \"ulites@gmail.com\",\n    },\n    serviceList: [\n      {\n        serviceName: \"Cantine\",\n        unitPrice: \"40\",\n        quantity: \"1\",\n        tva: \"19%\",\n        total: \"180\",\n      },\n      {\n        serviceName: \"Arts plastique\",\n        unitPrice: \"40\",\n        quantity: \"1\",\n        tva: \"19%\",\n        total: \"40\",\n      },\n    ],\n    totalPriceHT: \"220\",\n    totalTVA: \"41,80\",\n    totalTTC: \"261,80\",\n    statusInvoice: 1,\n    timeline: [\n      {\n        date: \"05/09/020\",\n        amount: \"120\",\n      },\n      {\n        date: \"05/10/020\",\n        amount: \"120\",\n      },\n      {\n        date: \"05/11/020\",\n        amount: \"120\",\n      },\n    ],\n    amountToAccount: \"120\",\n    totalPayed: 141,\n    paymeentconditions:\n      \"Veuillez trouver votre échéancier prévisionnel ci-contre.Les prélèvements seront effectués sur le RIB suivant : TU76 1745 6985 0458796 13154546\",\n  },\n];\nclass ListInvoices extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      openPay: false,\n      billSelected: {},\n      price: \"\",\n      paymentDay: new Date(),\n      paymentMethode: \"\",\n      oldPrice: 0,\n      priceError: false,\n      priceTotal: 0,\n      priceRestant: 0,\n      invoiceModal:false,\n      InvoiceObject:{},\n      ReceiverMail:\"\",\n      secondMail:\"\",\n      paymentMethodeError: false,\n\n    };\n    this.openPay = this.openPay.bind(this);\n    this.cancelModal = this.cancelModal.bind(this);\n    this.handleChangeInput = this.handleChangeInput.bind(this);\n    this.handleChangePaymentType = this.handleChangePaymentType.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.handleOpenInvoiceModal = this.handleOpenInvoiceModal.bind(this);\n    this.handleCloseInvoiceModal = this.handleCloseInvoiceModal.bind(this);\n    this.handleSubmitInvoice = this.handleSubmitInvoice.bind(this);\n    this.handleChange = this.handleChange.bind(this);\n\n    \n  }\n  handleChange = (name) => (event) => {\n    this.setState({ [name]: event.target.value });\n  };\n\n\n\n  handleOpenInvoiceModal=(item)=> {\n    console.log('MMMMMMMMMMMMMMMMMMMMMMM')\n    this.setState({\n      invoiceModal:true,\n      InvoiceObject:item\n    },()=>console.log('RRRRRRRRRRRRRRR ',this.state.invoiceModal));\n  }\n  handleCloseInvoiceModal=()=> {\n    this.setState({\n      invoiceModal:false,\n      InvoiceObject:{}\n    },()=>console.log('RRRRRRRRRRRRRRR ',this.state.invoiceModal));\n  }\n  handleSubmitInvoice=(e)=> {\n   e.preventDefault()\n   console.log('KKKKKKKKKKKK ',this.state.InvoiceObject)\n   var mails={}\n   mails.ReceiverMail=this.state.ReceiverMail\n   mails.secondMail=this.state.secondMail\n\nvar data={}\ndata.mails=mails\ndata.object=this.state.InvoiceObject\n   this.props.SendInvoice(data)\n   this.handleCloseInvoiceModal()\n  }\n\n\n  openPay(item) {\n    this.setState({\n      openPay: true,\n      billSelected: item,\n      priceTotal: item.totalPayed,\n      priceRestant: 0,\n    });\n  }\n  cancelModal() {\n    this.setState({\n      openPay: false,\n      billSelected: {},\n      priceError: false,\n      price: '',\n      priceTotal: 0,\n      priceRestant: 0,\n      paymentMethode:'',\n      paymentMethodeError: false,\n    });\n  }\n  handleChangePaymentType = (key) => (event, value) => {\n    this.setState({\n      paymentMethode: value,\n      paymentMethodeError: false,\n    });\n  };\n\n  handleChangeInput = (name) => (event) => {\n    if (name == \"price\") {\n      let priceError = false;\n      priceError =\n        this.state.billSelected.totalPayed < parseInt(event.target.value, 10);\n      if (priceError) {\n        this.setState({\n          [name]: event.target.value,\n          priceError,\n        });\n      } else {\n        this.setState({\n          [name]: event.target.value,\n          priceError,\n          priceRestant:\n            this.state.priceTotal - parseInt(event.target.value, 10),\n        });\n      }\n    } else {\n      this.setState({ [name]: event.target.value });\n    }\n  };\n  handleSubmit = (e) => {\n    e.preventDefault();\n    console.log(\"rrrrrrrrr\");\n    if (this.state.paymentMethode === \"\") {\n      this.setState({ paymentMethodeError: true });\n    }\n    // else if (this.state.price > this.props.invoice.bill.total_incl_tax) {\n    //   this.setState({ priceError: true });\n    // }\n    else {\n      let data = {};\n      if (this.state.billSelected.statusInvoice === partiallyPaidInvoice) {\n        const newPrice = parseInt(this.state.price) + this.state.oldPrice;\n        if (newPrice > this.state.billSelected.totalPayed) {\n          this.setState({ priceError: true });\n        }\n        // else {\n        //   data = { price_paid: newPrice };\n        //   this.props.dispatch(\n        //     editBill(data, this.state.idPaymentV2, this.props.invoice)\n        //   );\n        //   this.props.cancelModal();\n        // }\n      } else {\n        data = {\n          payment_day: moment(this.state.paymentDay).format(\"YYYY-MM-DD\"),\n          payment_methode: this.state.paymentMethode,\n          fk_id_profile: this.props.userProfile.id,\n          fk_id_bill: this.state.billSelected.id,\n          price_invoice: this.state.billSelected.totalPayed,\n          price_paid: parseInt(this.state.price),\n        };\n        console.log(data, \"data envoyéééé\");\n        // this.props.dispatch(payBill(data, this.props.invoice));\n      }\n    }\n  };\n  render() {\n    return (\n      <>\n        <div className=\"row col-lg-12 col-md-12\">\n          <CardBox styleName=\"text-black col-lg-12\">\n            <div className=\"row d-flex justify-content-center alignement-items-center\">\n              {invoices.map((element) => (\n                <BillItem\n                  month={this.props.month}\n                  key={element.id}\n                  item={element}\n                  openPay={this.openPay}\n                  handleOpenInvoiceModal = {this.handleOpenInvoiceModal}\n                  handleCloseInvoiceModal = {this.handleCloseInvoiceModal}\n                  values={this.state}\n                  // languageId={this.props.settings.languageId}\n                  // idEstablishment={this.props.userProfile.establishment_id}\n                  // users={this.props.users}\n                />\n              ))}\n            </div>\n          </CardBox>\n        </div>\n        {this.state.openPay ? (\n          <PayBill\n            cancelModal={this.cancelModal}\n            invoice={this.state.billSelected}\n            values={this.state}\n            handleChangeInput={this.handleChangeInput}\n            handleChangePaymentType={this.handleChangePaymentType}\n            handleSubmit={this.handleSubmit}\n          />\n        ) : (\n          \" \"\n        )}\n\n        {\n          this.state.invoiceModal===true ?\n          <ConfirmInvoiceModal\n          values={this.state}\n          handleCloseInvoiceModal = {this.handleCloseInvoiceModal}\n          handleSubmitInvoice = {this.handleSubmitInvoice}\n          handleChange = {this.handleChange}\n\n          \n          \n          />\n          :\n          \"\"\n        }\n      </>\n    );\n  }\n}\nconst mapStateToProps = (state) => {\n  return {\n    userProfile: state.auth.userProfile,\n  };\n};\nexport default connect(mapStateToProps,{\n  SendInvoice\n})(ListInvoices);\n"]},"metadata":{},"sourceType":"module"}